<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.gui.mainGuiLogic &mdash; DRAN v1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=e160b93e"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            DRAN
          </a>
              <div class="version">
                v1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/caveats.html">Caveats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/cli.html">The command line interface (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/gui.html">The graphical user interface (GUI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/gui.html#the-landing-page">The landing page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/gui.html#edit-driftscan">Edit driftscan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/gui.html#edit-time-series">Edit Time series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/gui.html#view-plots">View plots</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/tuts/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/commands.html">Commands</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/radio_sources.html">Radio sources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guidelines:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../extras/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">DRAN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">src.gui.mainGuiLogic</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.gui.mainGuiLogic</h1><div class="highlight"><pre>
<span></span><span class="c1"># ============================================================================#</span>
<span class="c1"># File: main_gui_logic.py                                                     #</span>
<span class="c1"># Author: Pfesesani V. van Zyl                                                #</span>
<span class="c1"># ============================================================================#</span>

<span class="c1"># Standard library imports</span>
<span class="c1"># --------------------------------------------------------------------------- #</span>
<span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">Pass</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span> <span class="c1"># from PyQt6 import QtWidgets</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qtagg</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span><span class="p">,</span> <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="c1"># Local imports</span>
<span class="c1"># --------------------------------------------------------------------------- #</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;src/&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">common.msgConfiguration</span> <span class="kn">import</span> <span class="n">msg_wrapper</span>
<span class="kn">from</span> <span class="nn">common.sqlite_db</span> <span class="kn">import</span> <span class="n">SQLiteDB</span>
<span class="c1"># from common.fits_file_reader import FitsFileReader</span>
<span class="kn">from</span> <span class="nn">common.observation</span> <span class="kn">import</span> <span class="n">Observation</span>
<span class="c1"># from common.driftScans import DriftScans</span>
<span class="kn">import</span> <span class="nn">common.fitting</span> <span class="k">as</span> <span class="nn">fit</span>
<span class="kn">from</span> <span class="nn">gui.main_window</span> <span class="kn">import</span> <span class="n">Ui_MainWindow</span>
<span class="kn">from</span> <span class="nn">gui.edit_driftscan_window1</span> <span class="kn">import</span> <span class="n">Ui_DriftscanWindow</span>
<span class="kn">from</span> <span class="nn">gui.edit_timeseries_window</span> <span class="kn">import</span> <span class="n">Ui_TimeSeriesWindow</span>
<span class="kn">from</span> <span class="nn">gui.view_plots_window</span> <span class="kn">import</span> <span class="n">Ui_PlotViewer</span>
<span class="kn">from</span> <span class="nn">common.file_handler</span> <span class="kn">import</span> <span class="n">FileHandler</span>
<span class="kn">import</span> <span class="nn">common.calibrate</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">from</span> <span class="nn">gui.canvasManager</span> <span class="kn">import</span> <span class="n">CanvasManager</span>
<span class="kn">from</span> <span class="nn">gui.secondaryCanvasManager</span> <span class="kn">import</span> <span class="n">SecondaryCanvasManager</span>
<span class="kn">from</span> <span class="nn">gui.timeseries_canvas</span> <span class="kn">import</span> <span class="n">TimeCanvas</span>
<span class="c1"># from common.fitting import f as fx</span>
<span class="kn">import</span> <span class="nn">common.fitting</span> <span class="k">as</span> <span class="nn">fit</span>
<span class="kn">import</span> <span class="nn">common.miscellaneousFunctions</span> <span class="k">as</span> <span class="nn">misc</span>
<span class="c1"># =========================================================================== #</span>

<div class="viewcode-block" id="Main">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main">[docs]</a>
<span class="k">class</span> <span class="nc">Main</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">,</span> <span class="n">Ui_MainWindow</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The main class that handles all gui operations.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Main</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">filePath</span><span class="o">=</span><span class="s2">&quot;&quot;</span> 

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;GUI initiated&quot;</span><span class="p">)</span>

        <span class="c1"># Setup the user interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusbar</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Ready.&quot;</span><span class="p">)</span>

        <span class="c1"># initiate file handling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">=</span><span class="n">FileHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>

        <span class="c1"># setup holder for deleted values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deleted</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filePath</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>

            <span class="c1"># set button properties</span>
            <span class="n">btnCol</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
            <span class="n">btnTextCol</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>

            <span class="c1"># Connect buttons to window</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btn_edit_driftscan</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_drift_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btn_edit_timeseries</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_timeseries_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btn_view_plots</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_plots_window</span><span class="p">)</span>
            <span class="c1"># self.btn_edit_driftscan.setStyleSheet(f&#39;QPushButton {{background-color: {btnCol}; color: {btnTextCol};}}&#39;)</span>
            <span class="c1"># self.btn_edit_timeseries.setStyleSheet(f&#39;QPushButton {{background-color: {btnCol}; color: {btnTextCol};}}&#39;)</span>
            <span class="c1"># self.btn_view_plots.setStyleSheet(f&#39;QPushButton {{background-color: {btnCol}; color: {btnTextCol};}}&#39;)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">open_drift_window</span><span class="p">()</span>
            <span class="c1"># self.open_file()</span>

    <span class="c1"># === Windows setup   ===</span>
<div class="viewcode-block" id="Main.open_drift_window">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.open_drift_window">[docs]</a>
    <span class="k">def</span> <span class="nf">open_drift_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Connect the edit drift scan window to the main window. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Initiating drift scan editing window&quot;</span><span class="p">)</span>

        <span class="c1"># Initiate Canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span> <span class="o">=</span> <span class="n">CanvasManager</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ntb</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_window</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span> <span class="o">=</span> <span class="n">Ui_DriftscanWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drift_window</span><span class="p">)</span>

        <span class="c1"># initiate Secondary canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secondaryCanvas</span> <span class="o">=</span> <span class="n">SecondaryCanvasManager</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>

        <span class="c1"># Layouts</span>
        <span class="n">plotLayout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">PlotLayout</span>
        <span class="n">otherPlotLayout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">otherPlotsLayout</span>

        <span class="c1"># Add Canvas/es to the gui</span>
        <span class="n">plotLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ntb</span><span class="p">)</span>
        <span class="n">plotLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="p">)</span>
        <span class="n">otherPlotLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">secondaryCanvas</span><span class="p">)</span>

        <span class="c1"># Connect buttons to actions performed by user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_buttons</span><span class="p">()</span>

        <span class="c1"># Print welcome message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;DRAN GUI loaded successfully.&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Open a file to get started.&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="c1"># Set status, indicates whether fit/plot has been modified/not</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Main.open_timeseries_window">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.open_timeseries_window">[docs]</a>
    <span class="k">def</span> <span class="nf">open_timeseries_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Connect the edit timeseries window. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Initiating timeseries editing window&quot;</span><span class="p">)</span>

        <span class="c1"># Initiate Canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span> <span class="o">=</span> <span class="n">TimeCanvas</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ntb</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span> <span class="c1"># add nav toolbar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_window</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span> <span class="o">=</span> <span class="n">Ui_TimeSeriesWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_window</span><span class="p">)</span>

        <span class="c1"># Layouts</span>
        <span class="n">plotLayout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">PlotLayout</span>

        <span class="c1"># Add canvas to the gui</span>
        <span class="n">plotLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ntb</span><span class="p">)</span>
        <span class="n">plotLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="p">)</span>
        
        <span class="c1"># connect buttons to actions performed by users</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnResetPoint</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnFit</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnQuit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Update db&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtSplKnots</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">LblSplKnots</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnUpdateDB</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnOpenDB</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsYerr</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">Lblxlim</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">Lblylim</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtxlimMin</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtxlimMax</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtylimMax</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtylimMin</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnFilter</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnRefreshDB</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnSaveDB</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtFilter</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtEndDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtStartDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">LblEndDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">LblStartDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Setup index change options for combo boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_table_name_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxFitTypes</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_fit_changed</span><span class="p">)</span>

        <span class="c1"># connect buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnRefreshDB</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_list</span><span class="p">)</span> <span class="c1">#TODO: make this operational</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Main.open_plots_window">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.open_plots_window">[docs]</a>
    <span class="k">def</span> <span class="nf">open_plots_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Connect the plots window to the main window. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Initiating plot viewer window&quot;</span><span class="p">)</span>

        <span class="c1"># Initiate viewer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_window</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span> <span class="o">=</span> <span class="n">Ui_PlotViewer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_window</span><span class="p">)</span>

        <span class="c1"># fix all else</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnDelete</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnRefreshPlotList</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnShow</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxOptions</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxEnd</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxStart</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Enable open db only</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnOpen</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_db_path</span><span class="p">)</span>

        <span class="c1"># Setup index change options for combo boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_combo_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_filter_changed</span><span class="p">)</span>
        
        <span class="c1"># # Connect buttons to actions performed by user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnRefreshPlotList</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_items_to_combobox</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnShow</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_plot_browser</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnDelete</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delete_obs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


    <span class="c1"># checked start --------</span>
    <span class="c1"># ---------------------------</span>
<div class="viewcode-block" id="Main.write">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.write">[docs]</a>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="p">,</span><span class="n">logType</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write to screen and gui &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">logType</span><span class="o">==</span><span class="s2">&quot;info&quot;</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.open_file_name_dialog">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.open_file_name_dialog">[docs]</a>
    <span class="k">def</span> <span class="nf">open_file_name_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ext</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Open file. Had to use this </span>
<span class="sd">        to avoid segmentation fault: 11 error</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Open file name dialog&quot;</span><span class="p">)</span>

        <span class="n">fileName</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Open File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Fits Files (&quot;</span><span class="o">+</span><span class="n">ext</span><span class="o">+</span><span class="s2">&quot;);;Fits Files (&quot;</span><span class="o">+</span><span class="n">ext</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fileName</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fileName</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span></div>

        
<div class="viewcode-block" id="Main.set_fit_parmeters">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.set_fit_parmeters">[docs]</a>
    <span class="k">def</span> <span class="nf">set_fit_parmeters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">pf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize fit status parameters. These are parameters that tell us</span>
<span class="sd">        wether a certain part of the scan has been fit or not. The status of </span>
<span class="sd">        the fit can be either 0 (data not fit yet) or 1 (data fitting has </span>
<span class="sd">        been done) for the current scan. A smoothing parameter is also included</span>
<span class="sd">        to let us know if smoothing has been done on the original data.</span>

<span class="sd">        By default, all the parameters are set to zero.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Setting fit status&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">=</span> <span class="n">bf</span>        <span class="c1"># Baseline has not been corrected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">=</span> <span class="n">pf</span>        <span class="c1"># Peak fit has not been done</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_is_smoothed</span> <span class="o">=</span> <span class="n">ps</span>   <span class="c1"># rmscut/smoothing has not been done</span></div>


<div class="viewcode-block" id="Main.reset_plot">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_plot">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Reset figure to default settings. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Reset figure to default settings&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
        
        <span class="c1"># Get the plot index, set fitting done to zero and rest any previous fits</span>
        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_done</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_previous_fits</span><span class="p">()</span>

        <span class="c1"># Reset x and y to factory settings of current plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_xy</span><span class="p">(</span><span class="n">plotIndex</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;here&#39;</span><span class="p">)</span>
        <span class="c1"># Reset the plot</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="s2">&quot;Raw data&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_residual</span><span class="p">()</span>

        <span class="c1"># Reset fit and flag parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_fit_parmeters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_peak</span><span class="p">(</span><span class="n">plotIndex</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.get_plot_index">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.get_plot_index">[docs]</a>
    <span class="k">def</span> <span class="nf">get_plot_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the current plot index. Deliberately set to ind+1 to account for offset.&quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s1">&#39;Getting plot index </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxPlotType</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxPlotType</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span></div>

    
<div class="viewcode-block" id="Main.reset_previous_fits">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_previous_fits">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_previous_fits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Reset previous fits. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Reset previous fits&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_dual_plot_fit_a</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_dual_plot_fit_b</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_plot_fit</span><span class="p">()</span></div>


<div class="viewcode-block" id="Main.reset_dual_plot_fit_a">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_dual_plot_fit_a">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_dual_plot_fit_a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Reset all previously fit parameters of the A beam to zreo. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">peakFitA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2nA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsbA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsaA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_slopeA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_rmsA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakLocA</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span></div>

        
<div class="viewcode-block" id="Main.reset_dual_plot_fit_b">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_dual_plot_fit_b">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_dual_plot_fit_b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Reset all previously fit parameters of the B beam to zero. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">peakFitB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2nB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsbB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmsaB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_slopeB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_rmsB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakLocB</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span></div>


<div class="viewcode-block" id="Main.reset_plot_fit">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_plot_fit">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_plot_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Reset all previously fit parameters to zero. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">peakFit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakRms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseSlope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakLoc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span></div>


<div class="viewcode-block" id="Main.reset_xy">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_xy">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set X and Y values to current plot. &quot;&quot;&quot;</span>
        <span class="c1"># TODO: check this does what it says it does</span>
        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Setting X and Y&quot;</span><span class="p">)</span>

        <span class="c1"># for single beam</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span></div>


        <span class="c1"># for dual beam - check this again</span>
        <span class="c1"># try:</span>
        <span class="c1">#     ind=ind+2</span>
        <span class="c1">#     for i in range(2, len(self.lenScans)):</span>
        <span class="c1">#         if ind == i:</span>
        <span class="c1">#             self.y = self.scans[self.scanKeys[ind]]</span>
        <span class="c1"># except Exception:</span>
        <span class="c1">#     self.y = np.zeros_like(1000)</span>

<div class="viewcode-block" id="Main.set_title">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.set_title">[docs]</a>
    <span class="k">def</span> <span class="nf">set_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the plot title. &quot;&quot;&quot;</span>

        <span class="n">plotTitle</span> <span class="o">=</span> <span class="s2">&quot;Plot of &quot;</span> <span class="o">+</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;OBJECT&#39;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; @ &quot;</span> <span class="o">+</span> \
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;CENTFREQ&#39;</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; MHz&quot;</span>
        <span class="k">return</span> <span class="n">plotTitle</span></div>

    
<div class="viewcode-block" id="Main.set_flags">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.set_flags">[docs]</a>
    <span class="k">def</span> <span class="nf">set_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set base flags.</span>
<span class="sd">            FLAGS = 100  # Source was manually edited/reduced by user</span>
<span class="sd">            This becomes the default for all flags if you save to DB</span>
<span class="sd">            while using the GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;set flags&quot;</span><span class="p">)</span>

        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>
        <span class="n">beam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FRONTEND&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">beam</span> <span class="o">==</span> <span class="s2">&quot;13.0S&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;OLTA&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;OLFLAG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>

            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;ORTA&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ORFLAG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;SLTA&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SLFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;NLTA&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;NLFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;OLTA&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OLFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;SRTA&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SRFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;NRTA&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;NRFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;ORTA&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ORFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span></div>


<div class="viewcode-block" id="Main.reset_peak">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_peak">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">plotIndex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Reset previous peak fits. &quot;&quot;&quot;</span> 

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s1">&#39;reset peak fit&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FRONTEND&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;13.0S&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Data for LCP&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;OLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Data for RCP&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;ORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;02.5S&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;01.3S&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;04.5S&quot;</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Fit stats for &quot;</span> <span class="o">+</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;SLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;NLTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;NLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;OLTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;OLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;SRTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;SRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;NRTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;NRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;ORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Fit stats for &quot;</span> <span class="o">+</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ANLTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;AOLTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ASRTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ANRTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;AORTA&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_dict</span><span class="p">(</span><span class="s2">&quot;AORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.reset_dict">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_dict">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_key1</span><span class="p">,</span> <span class="n">filter_key2</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Reset the data dictionary containing the </span>
<span class="sd">            driftscan keys</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ld</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ld</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">filter_key1</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="c1"># values = list((self.data).values())</span>
        <span class="n">idx_of_key1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">filter_key1</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">idx_of_key2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">filter_key2</span><span class="p">))</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="n">idx_of_key2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ld</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;02.5S&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;01.3S&quot;</span> <span class="ow">or</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">filter_key1</span> <span class="o">==</span> <span class="s2">&quot;SLTA&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ld</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">idx_of_key1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">idx_of_key2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">100</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="k">elif</span> <span class="n">filter_key1</span> <span class="o">==</span> <span class="s2">&quot;NLTA&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ld</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">idx_of_key1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">idx_of_key2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">100</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="k">elif</span> <span class="n">filter_key1</span> <span class="o">==</span> <span class="s2">&quot;OLTA&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ld</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">idx_of_key1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">idx_of_key2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">100</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="k">elif</span> <span class="n">filter_key1</span> <span class="o">==</span> <span class="s2">&quot;SRTA&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ld</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">idx_of_key1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">idx_of_key2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">100</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="k">elif</span> <span class="n">filter_key1</span> <span class="o">==</span> <span class="s2">&quot;NRTA&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ld</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">idx_of_key1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">idx_of_key2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">100</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="k">elif</span> <span class="n">filter_key1</span> <span class="o">==</span> <span class="s2">&quot;ORTA&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ld</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">idx_of_key1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">100</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ld</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">idx_of_key1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">100</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span></div>


    <span class="c1"># ===  Combobox change setup ===</span>
<div class="viewcode-block" id="Main.on_fit_combobox_changed">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.on_fit_combobox_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">on_fit_combobox_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Handle events related to the combobox option change. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Fitting ComboBox option changed&quot;</span><span class="p">)</span>

        <span class="c1"># Check the selected fit type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Now fitting: &quot;</span> <span class="o">+</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitLoc</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="c1"># Set the fit type</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitLoc</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Base&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitLoc</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Peak&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.on_filter_type_combobox_changed">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.on_filter_type_combobox_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">on_filter_type_combobox_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle events related to the filter type combobox option change.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Combo Box Filter Type Changed&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFilterType</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Please select:&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Smoothing the data &quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

            <span class="c1"># Enable filtering window</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtFilteringWindow</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnFilterData</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFilterType</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;rms cuts&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Performing Rms cuts&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

            <span class="c1"># Enable filtering window</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtFilteringWindow</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnFilterData</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtFilteringWindow</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnFilterData</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.on_fit_type_combobox_changed">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.on_fit_type_combobox_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">on_fit_type_combobox_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Handle events related to the combobox option change. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
                    <span class="s2">&quot;Fitting ComboBox option changed &quot;</span><span class="p">)</span>

        <span class="n">fit_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fit_type</span><span class="p">()</span>

        <span class="c1"># Check the selected fit type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; Now fitting: &quot;</span> <span class="o">+</span> <span class="n">fit_type</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="c1"># Set the fit type</span>
        <span class="k">if</span> <span class="n">fit_type</span> <span class="o">==</span> <span class="s2">&quot;Polynomial&quot;</span><span class="p">:</span>

            <span class="c1"># Enable peak fitting buttons</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitLoc</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.on_checkbox_changed">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.on_checkbox_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">on_checkbox_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Update the cursor depending on checkbox status (on/off)&quot;&quot;&quot;</span>

        <span class="c1"># Check state of checkbox</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Checked&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">cursorState</span> <span class="o">=</span> <span class="s2">&quot;on&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Not checked&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">cursorState</span> <span class="o">=</span> <span class="s2">&quot;off&quot;</span></div>


    <span class="c1"># === Enabling, disabling and populating widgets ===</span>

<div class="viewcode-block" id="Main.enable_widgets">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.enable_widgets">[docs]</a>
    <span class="k">def</span> <span class="nf">enable_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Enable the widgets. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;Enabling widgets&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxPlotType</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitLoc</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitType</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFilterType</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtFilteringWindow</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Enable buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnChoosePlot</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnViewFit</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnFitData</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnClearSelection</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnResetPlot</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnSave</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#self.drift_ui.BtnResetFit.setEnabled(True)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnSaveToDb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnFilterData</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnCalc</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># enable target buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnPopulatePSS</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnSavePSS</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnResetPSS</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Enable checkboxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor_state</span> <span class="o">=</span> <span class="s2">&quot;off&quot;</span></div>


<div class="viewcode-block" id="Main.populate_widgets">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.populate_widgets">[docs]</a>
    <span class="k">def</span> <span class="nf">populate_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Populate the gui widgets. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;Populate widgets&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtFilename</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtCurDate</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;CURDATETIME&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtObsDate</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtObsTime</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBSTIME&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtObjectType</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBSERVER&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtObjectName</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBJECT&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtMjd</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;MJD&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtFreq</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;CENTFREQ&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtTsysL</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TSYS1&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtTsysR</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TSYS2&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtTemp</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TAMBIENT&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtPres</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;PRESSURE&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtHum</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;HUMIDITY&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtFnbw</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FNBW&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtHa</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;HA&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtZa</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ZA&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtHpbw</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;HPBW&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="Main.setup_flags">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.setup_flags">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Setup flag parameters, default =100. These</span>
<span class="sd">        flags tell us whether a scan has been fit manually</span>
<span class="sd">        or not. see set_flags()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;Setting flags&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;13.0S&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OLFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ORFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SLFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;NLFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OLFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SRFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;NRFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ORFLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span></div>

    
<div class="viewcode-block" id="Main.open_file">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.open_file">[docs]</a>
    <span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Open file for processing. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Opening file&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="c1"># hide pss&#39;s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">pss_values_groupbox</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Initialize fit parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_fit_parmeters</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">filePath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_file_name_dialog</span><span class="p">(</span><span class="s2">&quot;*.fits&quot;</span><span class="p">)</span>
        <span class="c1"># self.filePath= &#39;/Users/pfesesanivanzyl/data/Calibrators/HydraA/2280/2021d365_00h28m13s_Cont_mike_HYDRA_A.fits&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filePath</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;You need to select a file to open&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Please select a file&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_plot</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_peak</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">pss_values_groupbox</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Get data from file</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">=</span><span class="n">Observation</span><span class="p">(</span><span class="n">FILEPATH</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filePath</span><span class="p">,</span> <span class="n">theoFit</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">autoFit</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="n">dbCols</span><span class="o">=</span><span class="p">{})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">get_data_only</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span> <span class="o">=</span> <span class="p">{},{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataKeys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># print(k,v)</span>
                <span class="k">if</span> <span class="s1">&#39;theo&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;auto&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;INFOHEADER&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;log&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;HDULIST&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;CARDS&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;plotDir&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;RAW&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;J2000&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">elif</span> <span class="s1">&#39;TA_&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;OFFSET&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="c1"># if &#39;OFFSET&#39; in k:</span>
                    <span class="c1">#     self.scans[&#39;OFFSET&#39;]=v</span>
                    <span class="c1"># else:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- &#39;</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="s1">&#39;ON_TA_LCP&#39;</span> <span class="ow">or</span> <span class="n">k</span><span class="o">==</span><span class="s1">&#39;ON_TA_RCP&#39;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s1">&#39;L&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                <span class="n">key</span><span class="o">=</span><span class="s1">&#39;OLTA&#39;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">key</span><span class="o">=</span><span class="s1">&#39;ORTA&#39;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">k</span><span class="o">==</span><span class="s1">&#39;HPN_TA_LCP&#39;</span> <span class="ow">or</span> <span class="n">k</span><span class="o">==</span><span class="s1">&#39;HPN_TA_RCP&#39;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s1">&#39;L&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                <span class="n">key</span><span class="o">=</span><span class="s1">&#39;NLTA&#39;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">key</span><span class="o">=</span><span class="s1">&#39;NRTA&#39;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">k</span><span class="o">==</span><span class="s1">&#39;HPS_TA_LCP&#39;</span> <span class="ow">or</span> <span class="n">k</span><span class="o">==</span><span class="s1">&#39;HPS_TA_RCP&#39;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s1">&#39;L&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                <span class="n">key</span><span class="o">=</span><span class="s1">&#39;SLTA&#39;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">key</span><span class="o">=</span><span class="s1">&#39;SRTA&#39;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                            <span class="c1"># self.data[k]=v[&#39;value&#39;]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># print(k,v)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dataKeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
   
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data keys: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scan keys: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># sys.exit()</span>
            <span class="c1"># print(self.data[&#39;FILEPATH&#39;],&#39;\n&#39;)</span>
            <span class="c1"># self.lenData= len(self.data)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lenScans</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">)</span>

            <span class="c1"># sys.exit()</span>
            <span class="c1"># # self.data = fileReader.data</span>
            <span class="c1"># # self.scans = fileReader.scans</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">delete_canvas</span><span class="p">()</span>

            <span class="c1"># set the figure layout</span>
            <span class="k">if</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">init_dual_fig_canvas</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_dual_canvas</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">secondaryCanvas</span><span class="o">.</span><span class="n">init_canvas</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">secondaryCanvas</span><span class="o">.</span><span class="n">clear_canvas</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">init_fig_canvas</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_canvas</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">secondaryCanvas</span><span class="o">.</span><span class="n">init_canvas</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">secondaryCanvas</span><span class="o">.</span><span class="n">clear_canvas</span><span class="p">()</span>

            <span class="c1"># # Setup pss and flux calculation buttons</span>
            <span class="c1"># if (self.data[&quot;OBJECTTYPE&quot;] == &quot;CAL&quot;):</span>
            <span class="c1">#     self.drift_ui.BtnCalc.setText(&quot;Calc PSS&quot;)</span>
            <span class="c1">#     self.drift_ui.BtnCalc.clicked.connect(self.calc_pss_)</span>
                
            <span class="c1">#     # remove pss estimation buttons and boxes</span>
            <span class="c1">#     self.drift_ui.pss_values_groupbox.setVisible(False)</span>
            <span class="c1">#     #self.disable_target_widgdets()</span>

            <span class="c1"># elif self.data[&quot;OBJECTTYPE&quot;] == &quot;TAR&quot;:</span>
            <span class="c1">#     #self.drift_ui.BtnCalc.</span>
            <span class="c1">#     self.drift_ui.BtnCalc.setText(&quot;Calc Flux&quot;)</span>
            <span class="c1">#     self.drift_ui.BtnCalc.clicked.connect(self.calc)</span>
            <span class="c1">#     self.drift_ui.pss_values_groupbox.setVisible(False)</span>
            <span class="c1">#     #self.enable_target_buttons()</span>
 
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Opened file: &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filePath</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># sys.exit()</span>
            <span class="c1"># Setup environment variables</span>
            <span class="c1"># self.set_beam_names()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">populate_widgets</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enable_widgets</span><span class="p">()</span>

            <span class="c1"># sys.exit()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenScans</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="c1"># for single beam scans</span>
                <span class="n">ind</span><span class="o">=</span><span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">2</span><span class="p">]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">secondaryCanvas</span><span class="o">.</span><span class="n">plot_figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">label2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
    
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># for dual beam scans</span>
                <span class="n">ind</span><span class="o">=</span><span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">2</span><span class="p">]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">secondaryCanvas</span><span class="o">.</span><span class="n">plot_figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">label2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
            
            <span class="c1"># Add items to combo boxes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxPlotType</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxPlotType</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxPlotType</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

            <span class="c1"># sys.exit()</span>
            <span class="c1"># allProperties = list(self.data.keys())#[3:]</span>
            <span class="c1">#self.drift_ui.ComboBoxScanProperty.setEnabled(True)</span>
            <span class="c1">#self.drift_ui.ComboBoxScanProperty.clear()</span>
            <span class="c1">#self.drift_ui.ComboBoxScanProperty.addItems(allProperties)</span>
            <span class="c1">#self.drift_ui.newPropertyValue.setEnabled(True)</span>
            <span class="c1">#self.drift_ui.BtnModify.setEnabled(True)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">fit_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Polynomial&quot;</span><span class="p">]</span><span class="c1">#, &quot;Gaussian&quot;]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitType</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitType</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitType</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_types</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">smoothing_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;please select:&quot;</span><span class="p">,</span> <span class="s2">&quot;rms cuts&quot;</span><span class="p">,</span> <span class="s2">&quot;flat&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;hanning&quot;</span><span class="p">,</span> <span class="s2">&quot;bartlett&quot;</span><span class="p">,</span> <span class="s2">&quot;blackman&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFilterType</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFilterType</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFilterType</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smoothing_types</span><span class="p">)</span>

            <span class="c1"># Setup index change options for combo boxes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitLoc</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_fit_combobox_changed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFilterType</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_filter_type_combobox_changed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitType</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_fit_type_combobox_changed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_checkbox_changed</span><span class="p">)</span>

            <span class="c1"># SET FLAGS</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_flags</span><span class="p">()</span>

            <span class="c1"># set x,y, plot first image</span>
            <span class="c1"># print(ind,self.scanKeys[ind+1])</span>
            <span class="c1"># print(len(self.x),len(self.y))</span>
            <span class="c1"># sys.exit()</span>
            <span class="c1"># self.reset_xy(0)</span>
            <span class="c1"># print(len(self.x),len(self.y))</span>
            <span class="c1"># sys.exit()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">label_dual_res</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">label_res</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Starting data reduction&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.update_smoothing_params">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.update_smoothing_params">[docs]</a>
    <span class="k">def</span> <span class="nf">update_smoothing_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Update that plot has been smoothed&quot;&quot;&quot;</span>
        <span class="c1">#TODO: check this function points to the correct index</span>
        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;13.0S&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OLRMSB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OLRMSA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ORRMSB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ORRMSA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>

        <span class="k">elif</span> <span class="s2">&quot;01.3S&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;02.5S&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;04.5S&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SLRMSB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SLRMSA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;NLRMSB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;NLRMSA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OLRMSB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OLRMSA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SRRMSB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SRRMSA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;NRRMSB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;NRRMSA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ORRMSB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ORRMSA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div>

    
<div class="viewcode-block" id="Main.filter_data">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.filter_data">[docs]</a>
    <span class="k">def</span> <span class="nf">filter_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Filter/smooth the data &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFilterType</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;rms cuts&quot;</span><span class="p">:</span>

            <span class="c1"># perform rms cuts on the data, remove points with calues &gt; 3*rms</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Performing rms cuts&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="c1"># ================================================</span>
            <span class="c1"># Clean the data using rms cuts</span>
            <span class="c1"># ================================================</span>

            <span class="n">scanLen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;CENTFREQ&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">3000</span><span class="p">:</span>
                <span class="n">noTotScans</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">noTotScans</span> <span class="o">=</span> <span class="mi">6</span>

            <span class="c1"># spline the data</span>
            <span class="n">spl</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

            <span class="n">scanRes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="p">,</span> <span class="n">finMaxSpl</span><span class="p">,</span> <span class="n">finspl</span><span class="p">,</span> <span class="n">pointsDeleted</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">clean_data</span><span class="p">(</span>
                <span class="n">spl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">scanLen</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMS before: after -&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_canvas</span><span class="p">()</span>  <span class="c1"># Update figures</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;After rms cuts&quot;</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;smoothed data&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed residual&quot;</span><span class="p">)</span>    <span class="c1"># Update plot</span>

            <span class="c1">#update rms before and after</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_smoothing_params</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_is_smoothed</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Smoothing window&quot;</span><span class="p">)</span>

            <span class="n">smooth_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFilterType</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">smooth_type</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Please select a filter.&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_is_smoothed</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># TODO: Select a better smoothing algorithm</span>

                <span class="c1"># Get value from smoothing window</span>
                <span class="n">window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">EdtFilteringWindow</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">window</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;You need to enter a window width&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span><span class="p">:</span>

                    <span class="n">smoothed</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">filter_scans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">smooth_type</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">smoothed</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">smoothed</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_canvas</span><span class="p">()</span>            
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;After &quot;</span> <span class="o">+</span>
                                    <span class="n">smooth_type</span><span class="o">+</span><span class="s2">&quot; smoothing&quot;</span><span class="p">,</span> <span class="p">[])</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_is_smoothed</span> <span class="o">=</span> <span class="mi">1</span></div>


    <span class="c1"># def sbKeys(self):</span>
    <span class="c1">#     sbKeys = [&#39;FILENAME&#39;,&#39;FILEPATH&#39;,&#39;HDULENGTH&#39;,&#39;CURDATETIME&#39;,&#39;OBSDATE&#39;,</span>
    <span class="c1">#               &#39;OBSTIME&#39;,&#39;OBSDATETIME&#39;,&#39;OBJECT&#39;,&#39;LONGITUD&#39;,&#39;LAATITUDE&#39;,</span>
    <span class="c1">#               &#39;COORDSYS&#39;,&#39;EQUINOX&#39;,&#39;RADECSYS&#39;,&#39;OBSERVER&#39;,&#39;OBSLOCAL&#39;,</span>
    <span class="c1">#               &#39;PROJNAME&#39;,&#39;PROPOSAL&#39;,&#39;TELESCOP&#39;,&#39;UPGRADE&#39;,&#39;FOCUS&#39;,&#39;TILT&#39;,</span>
    <span class="c1">#               &#39;TAMBIENT&#39;,&#39;PRESSURE&#39;,&#39;HUMIDITY&#39;,&#39;WINDSPD&#39;,&#39;SCANDIR&#39;,</span>
    <span class="c1">#               &#39;POINTING&#39;,&#39;FEEDTYPE&#39;,&#39;BMOFFHA&#39;]</span>
        
<div class="viewcode-block" id="Main.view_fit">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.view_fit">[docs]</a>
    <span class="k">def</span> <span class="nf">view_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; View current fit info&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Viewing fit information...&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** &#39;</span><span class="p">,</span><span class="n">plotIndex</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FRONTEND&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;13.0S&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Data for LCP&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;OLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORTA&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Data for RCP&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;ORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;02.5S&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;01.3S&quot;</span><span class="p">:</span>
            <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;SLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;NLTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;NLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;OLTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;OLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;SRTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;SRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;NRTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;NRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;ORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>
            <span class="c1">#TODO: what about &quot;B&quot; scans?</span>

            <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ANLTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;AOLTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ASRTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ANRTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;AORTA&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit stats for &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iter_dict</span><span class="p">(</span><span class="s2">&quot;AORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

            
    <span class="c1"># def iter_dict(self, filter_key1, filter_key2=&quot;&quot;):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Dictionary iterator to extract current fit information</span>
    <span class="c1">#     &quot;&quot;&quot;</span>

    <span class="c1">#     ld = list((self.data).items())</span>
    <span class="c1">#     keys = list((self.data).keys())</span>
    <span class="c1">#     values = list((self.data).values())</span>

    <span class="c1">#     idx_of_key1 = int(keys.index(filter_key1))</span>
    <span class="c1">#     try:</span>
    <span class="c1">#         idx_of_key2 = int(keys.index(filter_key2))</span>
    <span class="c1">#     except:</span>
    <span class="c1">#         idx_of_key2 = len(ld)</span>

    <span class="c1">#     self.write(&quot;Fit stats: \n&quot;+&quot;-&quot;*30,&#39;info&#39;)</span>

    <span class="c1">#     if self.data[&quot;FRONTEND&quot;] == &quot;02.5S&quot; or self.data[&quot;FRONTEND&quot;] == &quot;01.3S&quot; or self.data[&quot;FRONTEND&quot;] == &quot;04.5S&quot;:</span>

    <span class="c1">#         if filter_key1 == &quot;SLTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;NLTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;OLTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;SRTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;NRTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;ORTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>

    <span class="c1">#     elif self.data[&quot;FRONTEND&quot;] == &quot;13.0S&quot;:</span>
    <span class="c1">#         if filter_key1 == &quot;OLTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2 and idx_of_key2 != &quot;&quot;:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
            

    <span class="c1">#     elif &quot;D&quot; in self.data[&quot;FRONTEND&quot;]:</span>

    <span class="c1">#         if filter_key1 == &quot;ASLTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;ANLTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;AOLTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;ASRTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;ANRTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1 and i &lt; idx_of_key2:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>
    <span class="c1">#         elif filter_key1 == &quot;AORTA&quot;:</span>
    <span class="c1">#             for i in range(len(ld)):</span>
    <span class="c1">#                 if i &gt;= idx_of_key1:</span>
    <span class="c1">#                     self.write(str(keys[i]) + &quot;: &quot; + str(values[i]),&#39;info&#39;)</span>
    <span class="c1">#                 else:</span>
    <span class="c1">#                     pass</span>


    <span class="c1"># OPERATIONS FOR TIMESERIES</span>
<div class="viewcode-block" id="Main.open_db">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.open_db">[docs]</a>
    <span class="k">def</span> <span class="nf">open_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Open the database. &quot;&quot;&quot;</span>

        <span class="c1"># get db file</span>
        <span class="c1"># self.dbFile = &#39;/Users/pfesesanivanzyl/dran/HART26DATA.db&#39; </span>
        <span class="c1"># self.dbFile = &#39;/Users/pfesesanivanzyl/software/working/HartSoftware/dran/CALDB.db&#39; </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_file_name_dialog</span><span class="p">(</span><span class="s2">&quot;*.db&quot;</span><span class="p">)</span>
        <span class="c1"># get db file</span>
        <span class="c1"># self.dbFile = self.open_file_name_dialog(&quot;*.db&quot;)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No file selected&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtDB</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtDB</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            
            <span class="c1"># open the database and get tables</span>
            <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Opening database: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="n">dbPath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
            
            <span class="c1"># populate columns</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dbName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbName</span><span class="p">))</span>
            <span class="c1"># self.time_ui.comboBoxTables.</span>
            <span class="c1"># print(self.tables)</span>
            <span class="c1"># sys.exit()</span>
            <span class="c1"># self.db.close_db()</span>
            <span class="c1"># self.populate_cols()</span>

            <span class="c1">#self.time_ui.comboBoxColsX.setEnabled(True)</span>
            <span class="c1">#self.time_ui.comboBoxColsY.setEnabled(True)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enable_time_buttons</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect_time_buttons</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate_cols</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span></div>

            <span class="c1"># print(&#39;Closing database: &#39;,self.dbFile)    </span>

<div class="viewcode-block" id="Main.on_table_name_changed">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.on_table_name_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">on_table_name_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; update combobox when table name changes. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate_cols</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="Main.populate_cols">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.populate_cols">[docs]</a>
    <span class="k">def</span> <span class="nf">populate_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Populate x and y columns with data from tables. &quot;&quot;&quot;</span>
        <span class="c1"># TODO: Double check this makes sense</span>
        <span class="c1"># open the database and get tables</span>
        <span class="c1"># print(self.dbFile)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="n">dbPath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>

        <span class="c1"># get column names from currently selected table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="c1"># print(&#39;Reading table: &#39;, self.table)</span>
        <span class="c1"># sys.exit()</span>
        <span class="c1"># self.db.close_db()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;table before issue: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
        <span class="c1"># print(self.tables)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Issue: &quot;</span><span class="p">)</span>
            <span class="c1"># force the combobox to accept items</span>
            <span class="c1">#self.time_ui.comboBoxTables.addItems(self.tables)</span>
            <span class="c1">#self.time_ui.comboBoxTables.addItems(self.tables)</span>
            <span class="c1"># self.time_ui.comboBoxTables.clear()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
            <span class="c1"># print(self.tables)</span>
            <span class="c1"># sys.exit()</span>

            <span class="c1"># lt = len(self.tables)</span>
            <span class="c1"># lc = self.time_ui.comboBoxTables.count()</span>
            <span class="c1"># x = [self.time_ui.comboBoxTables.itemText(i) for i in range(self.time_ui.comboBoxTables.count())]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            
            <span class="c1"># print(&#39;lt, lc, x: &#39;,lt,lc,x)</span>
            <span class="c1"># print(&#39;curtxt now: &#39;,self.time_ui.comboBoxTables.currentText())</span>
            <span class="c1"># print(self.table)</span>
            <span class="c1"># print(self.tables)</span>
            <span class="c1"># sys.exit()</span>
        <span class="c1"># print(&#39;Outs&#39;)</span>
        <span class="c1"># sys.exit()</span>
            
        <span class="c1"># print(self.table)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="n">dbPath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colInd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">colName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">colType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_all_table_coloumns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
        <span class="c1"># self.db.close_db()</span>
        <span class="c1"># print(&#39;table: &#39;, self.table)</span>
        <span class="c1"># print(&#39;cols: &#39;,self.colName,&#39;\n&#39;)</span>
        
        <span class="c1"># self.db = SQLiteDB(databaseName=self.dbFile, log=self.log)</span>
        <span class="c1"># self.db.create_db()</span>
        <span class="c1"># select only numerical cols with a few exceptions</span>
        <span class="n">colDict</span><span class="o">=</span><span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colInd</span><span class="p">)):</span>
            <span class="n">colDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">colInd</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colName</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="c1"># get rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_rows_of_cols</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="p">)</span>
        <span class="c1"># self.db.close_db()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;creating dataframe from table rows&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orig_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="c1"># copy of df</span>
        <span class="c1"># try:</span>
            
        
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">],</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># print(self.df[&#39;OBSDATE&#39;])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span> 
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OBSDATE&#39;</span><span class="p">])</span>
            <span class="c1"># sys.exit()</span>

        <span class="c1"># except:</span>
        <span class="c1">#     pass</span>
        <span class="c1"># self.df.fillna(value=np.nan, inplace=True)</span>

        <span class="c1"># self.time_ui.comboBoxColsX.clear()</span>
        <span class="c1"># self.time_ui.comboBoxColsY.clear()</span>
        <span class="c1"># self.time_ui.comboBoxColsYerr.clear()</span>

        <span class="c1"># print(self.colNames)</span>
        <span class="c1"># sys.exit()</span>

        <span class="n">plotCols</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="p">:</span>
            <span class="c1">#&#39;id&#39;, &#39;FILENAME&#39;, &#39;FILEPATH&#39;, &#39;HDULENGTH&#39;, &#39;CURDATETIME&#39;, &#39;OBSDATE&#39;, &#39;OBSTIME&#39;, </span>
            <span class="c1"># &#39;OBSDATETIME&#39;, &#39;OBJECT&#39;, &#39;LONGITUD&#39;, &#39;LATITUDE&#39;, &#39;COORDSYS&#39;, &#39;EQUINOX&#39;, &#39;RADECSYS&#39;, </span>
            <span class="c1"># &#39;OBSERVER&#39;, &#39;OBSLOCAL&#39;, &#39;PROJNAME&#39;, &#39;PROPOSAL&#39;, &#39;TELESCOP&#39;, &#39;UPGRADE&#39;, &#39;FOCUS&#39;, &#39;TILT&#39;, </span>
            <span class="c1"># &#39;TAMBIENT&#39;, &#39;PRESSURE&#39;, &#39;HUMIDITY&#39;, &#39;WINDSPD&#39;, &#39;SCANDIR&#39;, &#39;POINTING&#39;, &#39;FEEDTYPE&#39;, </span>
            <span class="c1"># &#39;BMOFFHA&#39;, &#39;BMOFFDEC&#39;, &#39;HPBW&#39;, &#39;FNBW&#39;, &#39;SNBW&#39;, &#39;DICHROIC&#39;, &#39;PHASECAL&#39;, &#39;NOMTSYS&#39;, &#39;FRONTEND&#39;, </span>
            <span class="c1"># &#39;CENTFREQ&#39;, &#39;BANDWDTH&#39;, &#39;INSTRUME&#39;, &#39;INSTFLAG&#39;, &#39;SCANDIST&#39;, &#39;SCANTIME&#39;, &#39;TCAL1&#39;, &#39;TCAL2&#39;, </span>
            <span class="c1"># &#39;HZPERK1&#39;, &#39;HZKERR1&#39;, &#39;HZPERK2&#39;, &#39;HZKERR2&#39;, &#39;TSYS1&#39;, &#39;TSYSERR1&#39;, &#39;TSYS2&#39;, &#39;TSYSERR2&#39;, </span>
            <span class="c1"># &#39;BEAMTYPE&#39;, &#39;LOGFREQ&#39;, &#39;ELEVATION&#39;, &#39;ZA&#39;, &#39;MJD&#39;, &#39;HA&#39;, &#39;PWV&#39;, &#39;SVP&#39;, &#39;AVP&#39;, &#39;DPT&#39;, &#39;WVD&#39;, </span>
            <span class="c1"># &#39;ATMOSABS&#39;, &#39;OBSNAME&#39;, &#39;OLTA&#39;, &#39;OLTAERR&#39;, &#39;OLBRMS&#39;, &#39;OLSLOPE&#39;, &#39;OLMIDOFFSET&#39;, &#39;OLFLAG&#39;, </span>
            <span class="c1"># &#39;OLPEAKLOC&#39;, &#39;OLBASELEFT&#39;, &#39;OLBASERIGHT&#39;, &#39;OLS2N&#39;, &#39;ORTA&#39;, &#39;ORTAERR&#39;, &#39;ORBRMS&#39;, &#39;ORSLOPE&#39;, </span>
            <span class="c1"># &#39;ORMIDOFFSET&#39;, &#39;ORFLAG&#39;, &#39;ORPEAKLOC&#39;, &#39;ORBASELEFT&#39;, &#39;ORBASERIGHT&#39;, &#39;ORS2N&#39;, &#39;SRC&#39;</span>

            <span class="k">if</span> <span class="s1">&#39;id&#39;</span> <span class="ow">in</span> <span class="n">name</span>  <span class="ow">or</span> <span class="s1">&#39;LOGFREQ&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;CURDATETIME&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> \
                <span class="s1">&#39;FILE&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;OBSD&#39;</span> <span class="ow">in</span> <span class="n">name</span> \
                    <span class="ow">or</span> <span class="s1">&#39;MJD&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;OBS&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;OBJ&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;id&#39;</span> <span class="o">==</span> <span class="n">name</span> \
                        <span class="ow">or</span> <span class="s1">&#39;RAD&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;TYPE&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;PRO&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;TELE&#39;</span> <span class="ow">in</span>\
                              <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;UPGR&#39;</span> <span class="ow">in</span> <span class="n">name</span>  <span class="ow">or</span> <span class="s1">&#39;INST&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> \
                                <span class="s1">&#39;SCANDIR&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;SRC&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;COORDSYS&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;LONGITUD&#39;</span> <span class="ow">in</span> <span class="n">name</span> \
                                    <span class="ow">or</span> <span class="s1">&#39;LATITUDE&#39;</span> <span class="ow">in</span> <span class="n">name</span>  <span class="ow">or</span> <span class="s1">&#39;POINTING&#39;</span> <span class="ow">in</span> <span class="n">name</span> \
                                       <span class="ow">or</span> <span class="s1">&#39;DICHROIC&#39;</span> <span class="ow">in</span> <span class="n">name</span> \
                                            <span class="ow">or</span> <span class="s1">&#39;PHASECAL&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;HPBW&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;FNBW&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;SNBW&#39;</span> <span class="ow">in</span> <span class="n">name</span>\
                                                <span class="ow">or</span> <span class="s1">&#39;FRONTEND&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;BASE&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span> 
                                                    <span class="c1"># &#39;HZK&#39; in name or &#39;HZP&#39; in name:</span>
                <span class="c1">#or &#39;ERR&#39; in name or &#39;LD&#39; in name or &#39;RD&#39; in name or &#39;HDU&#39; in name or &#39;EQUINOX&#39; in name or &#39;SOURCE&#39; in name or </span>
                <span class="c1">#or &#39;HA&#39; in name  or &#39;BMOFFHA&#39; in name or &#39;BMOFFDEC&#39; in name or &#39;NOMTSYS&#39; in name or &#39;BANDWDTH&#39; in name </span>
                <span class="c1"># or &#39;ELEVATION&#39; in name</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plotCols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">errcols</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="p">:</span>
            <span class="k">if</span>   <span class="s1">&#39;ERR&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;LD&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;RD&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;DS&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;DN&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;DO&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;DF&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;DC&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;WINDSPD&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;ADOPTED&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;DATE&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">errcols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="n">yerr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsX</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsX</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsX</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s1">&#39;OBSDATE&#39;</span><span class="p">,</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span><span class="s1">&#39;HA&#39;</span><span class="p">,</span><span class="s1">&#39;ELEVATION&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsY</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsY</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsY</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">plotCols</span><span class="p">)</span>
       
        <span class="bp">self</span><span class="o">.</span><span class="n">yErr</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">yerr</span><span class="p">)</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">errcols</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsYerr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsYerr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsYerr</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yErr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span></div>


<div class="viewcode-block" id="Main.on_fit_changed">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.on_fit_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">on_fit_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;  Toggle labels and edit boxes on or off when fit type is changed.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxFitTypes</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Spline&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">LblSplKnots</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtSplKnots</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtEndDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtStartDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">LblEndDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">LblStartDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">LblSplKnots</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtSplKnots</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtEndDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtEndDate</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtStartDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtStartDate</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">LblEndDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">LblStartDate</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.refresh_list">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.refresh_list">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh list if database updated&quot;&quot;&quot;</span>
        <span class="c1">#TODO: enable this function</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="Main.enable_time_buttons">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.enable_time_buttons">[docs]</a>
    <span class="k">def</span> <span class="nf">enable_time_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Enable time buttons. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsX</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsY</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsYerr</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtSplKnots</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnPlot</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxFilters</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtFilter</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnFilter</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxFitTypes</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxOrder</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnFit</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># self.time_ui.BtnSavePlot.setEnabled(True)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnDelPoint</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnDelBoth</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnResetPoint</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnReset</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnRefreshDB</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnUpdateDB</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnSaveDB</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnQuit</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.connect_time_buttons">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.connect_time_buttons">[docs]</a>
    <span class="k">def</span> <span class="nf">connect_time_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; connect button key press to widgets. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;Connecting buttons to main canvas&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnPlot</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_cols</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnFilter</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_timeseries_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnFit</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_timeseries</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnDelPoint</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_point</span><span class="p">)</span><span class="c1">#point)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnDelBoth</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_db_all</span><span class="p">)</span><span class="c1">#point)</span>
        <span class="c1"># self.time_ui.BtnResetPoints.clicked.connect()</span>
        <span class="c1"># self.time_ui.BtnSavePlot.clicked.connect()</span>
        <span class="c1"># self.time_ui.BtnQuit.clicked.connect()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnQuit</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnReset</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_timeseries</span><span class="p">)</span>
        <span class="c1">#self.time_ui.BtnOpenDB.clicked.connect(self.open_db)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnRefreshDB</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_db</span><span class="p">)</span>
        <span class="c1"># self.time_ui.BtnUpdateDB.clicked.connect()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">BtnSaveDB</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_time_db</span><span class="p">)</span></div>

        <span class="c1">#self.time_ui.BtnFit.clicked.connect(self.fit_timeseries)</span>

<div class="viewcode-block" id="Main.plot_cols">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.plot_cols">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">xcol</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">ycol</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Plot database columns. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="n">dbPath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>

        <span class="c1"># get column names from currently selected table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="c1"># print(&#39;Table: &#39;, self.table)</span>
        <span class="c1"># sys.exit()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Issue: &quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tables 1: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>

            <span class="n">lt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
            <span class="n">lc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">itemText</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">count</span><span class="p">())]</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">colInd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">colName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">colType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_all_table_coloumns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>

        <span class="c1"># select only numerical cols with a few exceptions</span>
        <span class="n">colDict</span><span class="o">=</span><span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colInd</span><span class="p">)):</span>
            <span class="n">colDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">colInd</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colName</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="c1"># get rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_rows_of_cols</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="p">)</span>

        <span class="c1"># sys.exit()</span>
        <span class="c1"># print([d for d in self.colNames if &#39;DTA&#39; in d].replace(&#39;DTA&#39;,&#39;ERRTA&#39;))</span>
        <span class="c1"># sys.exit()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colNames</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">],</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># get col names</span>
        <span class="k">if</span> <span class="n">xcol</span><span class="o">!=</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">ycol</span><span class="o">!=</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">yerr</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">xCol</span><span class="o">=</span><span class="n">xcol</span>
            <span class="n">yCol</span><span class="o">=</span><span class="n">ycol</span>
            <span class="n">yErr</span><span class="o">=</span><span class="n">yerr</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsX</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">yCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsY</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">yErr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsYerr</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="c1"># print(&#39;yCol: &#39;, yErr)</span>

        <span class="k">if</span> <span class="n">xCol</span> <span class="o">==</span> <span class="n">yCol</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">You cannot plot the same column on X and Y</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># yErr = self.time_ui.comboBoxColsYerr.currentText()</span>

            <span class="c1"># get col data</span>
            <span class="c1"># self.db.set_table_name(self.table)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting </span><span class="si">{</span><span class="n">xCol</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">yCol</span><span class="si">}</span><span class="s2"> in table </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">yErr</span><span class="o">==</span><span class="s2">&quot;None&quot;</span><span class="p">:</span>
                <span class="n">yerr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yErr</span><span class="p">]</span>

                <span class="c1"># print(self.df[yErr])</span>
                <span class="c1"># self.df[yErr][self.df[yErr] &lt; 0] = np.nan</span>
                <span class="c1"># print(self.df[yErr])</span>
                <span class="c1"># sys.exit()</span>
                <span class="c1"># yerr=self.df[yErr].astype(float)</span>
                <span class="c1"># # condition : When True, yield x, otherwise yield y.</span>
                <span class="c1"># yerr=np.where(yerr&lt;0, np.nan, yerr)</span>
                <span class="c1"># self.df[yErr][self.df[yErr] &lt; 0] = np.nan</span>

            <span class="c1"># print(self.df[&#39;OBSDATE&#39;])</span>
            <span class="n">t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
            <span class="c1"># print(t)</span>
            <span class="c1"># print(t[[&#39;id&#39;,&#39;FILENAME&#39;,&#39;OBSDATE&#39;]])</span>

            <span class="c1"># Fix the issue with OBSDATE NOT working properly</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
                <span class="n">fn</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="c1"># print(i,fn)</span>
                <span class="n">date</span><span class="o">=</span><span class="n">fn</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
                <span class="n">year</span><span class="o">=</span><span class="n">date</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">day</span><span class="o">=</span><span class="n">date</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="c1"># print(date)</span>

                <span class="c1"># converting to date</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">year</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">day</span><span class="p">,</span> <span class="s2">&quot;%Y-%j&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

                <span class="c1"># id=int(t[&#39;id&#39;].iloc[i])</span>
                <span class="c1"># print(id)</span>
                <span class="n">t</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;OBSDATE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;OBSDATE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
            <span class="c1"># print(t[[&#39;id&#39;,&#39;FILENAME&#39;,&#39;OBSDATE&#39;]])</span>

            <span class="c1">#TODO: clean this up</span>
            <span class="c1"># self.df[xCol].fillna(value=0, inplace=True)</span>
            <span class="c1"># self.df[xCol].fillna(value=pd.NaT, inplace=True)</span>

            <span class="c1"># self.df[yCol].fillna(value=np.nan, inplace=True)</span>
           
            <span class="c1"># print(self.df)</span>
            <span class="c1"># sys.exit() </span>

            <span class="k">if</span> <span class="n">xCol</span> <span class="o">==</span> <span class="s1">&#39;OBSDATE&#39;</span><span class="p">:</span>
                <span class="c1"># convert to datetime</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">])</span><span class="c1">#, errors=&#39;coerce&#39;)</span>
                <span class="c1"># print(self.df[xCol])</span>
                <span class="c1"># sys.exit()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_fig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">],</span><span class="n">xCol</span><span class="p">,</span><span class="n">yCol</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">)</span> <span class="c1">#,data=self.)</span>
            <span class="c1"># sys.exit()</span>
            
            <span class="c1">#  &lt;class &#39;pandas._libs.tslibs.nattype.NaTType&#39;&gt;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span></div>


<div class="viewcode-block" id="Main.filter_timeseries_data">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.filter_timeseries_data">[docs]</a>
    <span class="k">def</span> <span class="nf">filter_timeseries_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Filter the data&quot;&quot;&quot;</span>

        <span class="c1">#TODO: fix this - implement rms and binning cuts</span>
        <span class="c1"># get current text  from combobox and bins</span>
        <span class="n">filterText</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxFilters</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">filterCut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtFilter</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">filterText</span><span class="o">==</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;please select a filter type</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span> <span class="ow">or</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;&gt;=&quot;</span> <span class="ow">or</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;&lt;&quot;</span> <span class="ow">or</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span>
            
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">cut</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">filterCut</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filterCut</span><span class="si">}</span><span class="s1"> is an invalid entry for filter </span><span class="si">{</span><span class="n">filterText</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">cut</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                
                <span class="k">if</span> <span class="n">cut</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;filter everything </span><span class="si">{</span><span class="n">filterText</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">filterCut</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="c1"># get x and y</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">You need to plot the data first</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
                        <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                        <span class="n">xCol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">xlab</span>
                        <span class="n">yCol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">ylab</span>

                        <span class="c1"># print(self.df[[&#39;id&#39;,&#39;FILENAME&#39;,&#39;MJD&#39;]])</span>

                        <span class="c1"># print(f&#39;cut: {cut}&#39;)</span>
                        <span class="k">if</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
                            <span class="n">cuts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;</span><span class="nb">float</span><span class="p">(</span><span class="n">cut</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span>
                            <span class="n">cuts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;=</span><span class="nb">float</span><span class="p">(</span><span class="n">cut</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span>
                            <span class="n">cuts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span><span class="o">&lt;</span><span class="nb">float</span><span class="p">(</span><span class="n">cut</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span>
                            <span class="n">cuts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span><span class="o">&lt;=</span><span class="nb">float</span><span class="p">(</span><span class="n">cut</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Invalid cut detected&#39;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cuts</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dropping rows at index </span><span class="si">{</span><span class="n">cuts</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="c1">#df_cuts=self.df[self.df[xCol]&gt;]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">cuts</span><span class="p">])</span>
                            <span class="c1">#print(self.df)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">deleted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cuts</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;deleted: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deleted</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                            <span class="c1"># re-plot</span>
                            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRC&#39;</span><span class="p">])</span>
                            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">][:</span><span class="mi">8</span><span class="p">])</span>
                            <span class="c1"># sys.exit()</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_fig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">],</span> <span class="n">xCol</span><span class="p">,</span> <span class="n">yCol</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Plot of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">xCol</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">yCol</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1">#{self.df[&#39;FILENAME&#39;][:8]}&quot;)</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No values found for condition </span><span class="si">{</span><span class="n">filterText</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">filterCut</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;rms cuts&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMS cuts not implemented yet.&#39;</span><span class="p">)</span>

            <span class="c1">#     print(&quot;Performing rms cuts&quot;)</span>
            <span class="c1">#     # ================================================</span>
            <span class="c1">#     # Clean the data using rms cuts</span>
            <span class="c1">#     # ================================================</span>

            <span class="c1">#     # get df</span>
            <span class="c1">#     xCol=self.Canvas.xlab</span>
            <span class="c1">#     yCol=self.Canvas.ylab</span>

            <span class="c1">#     # need to run this once else it destroys data</span>
            <span class="c1">#     self.df[yCol]=self.df[yCol].replace(&#39;nan&#39;,0)</span>
            <span class="c1">#     self.df[yCol].fillna(0,inplace=True)</span>

            <span class="c1">#     x=list(self.df[xCol])#np.array(self.Canvas.x)</span>
            <span class="c1">#     y=list(self.df[yCol])#np.array(self.Canvas.y).astype(float)</span>
                
            <span class="c1">#     scanLen = len(x)</span>
            <span class="c1">#     if self.df[&quot;CENTFREQ&quot;][int(len(self.df)/2)] &lt;= 3000:</span>
            <span class="c1">#         noTotScans = 2</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         noTotScans = 6</span>

            <span class="c1">#     # spline the data</span>
            <span class="c1">#     spl = fit.spline(x, y)</span>

            <span class="c1">#     pl.plot(x,y)</span>
            <span class="c1">#     pl.plot(x,spl)</span>
            <span class="c1">#     pl.show()</span>
            <span class="c1">#     sys.exit()</span>

            <span class="c1">#     if len(spl)==0:</span>
            <span class="c1">#         pass</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         # print(&#39;spl: &#39;,spl)</span>
            <span class="c1">#         # print(&#39;y: &#39;,y)</span>
            <span class="c1">#         #sys.exit()</span>
            <span class="c1">#         print(self.df[&#39;FILENAME&#39;])</span>

            <span class="c1">#         scanResBefore, scanRmsBefore = fit.calc_residual(spl, y)</span>
            <span class="c1">#         finX, finY, scanRmsAfter, scanResAfter, finMaxSpl, finspl, pt, names = fit.clean_data_iterative_fitting(x, y, scanLen, scanResBefore, scanRmsBefore, self.log, x2=list(self.df[&quot;FILENAME&quot;]))</span>

            <span class="c1">#         self.write(f&#39;RMS before: after -&gt; {scanRmsBefore:.3f}: {scanRmsAfter:.3f}&#39;,&#39;info&#39;)</span>

            <span class="c1">#         self.Canvas.clear_figure()  # Update figures</span>

            <span class="c1">#         #self.df[xCol]=&quot;&quot;</span>
            <span class="c1">#         self.df[yCol]=np.nan</span>

            <span class="c1">#         #for j in range(len(list(self.df[&quot;FILENAME&quot;]))):</span>
            <span class="c1">#         err=self.time_ui.comboBoxColsYerr.currentText()</span>
            <span class="c1">#         for i in range(len(names)):</span>
            <span class="c1">#             self.df.loc[self.df[&#39;FILENAME&#39;]==names[i] ,yCol]=finY[i]</span>
            <span class="c1">#             #self.df.loc[self.df[&#39;FILENAME&#39;]==names[i] ,err]=finY[i]</span>
                    
            <span class="c1">#         # #self.update_plot(self.x, self.y, &quot;After rms cuts&quot;,</span>
            <span class="c1">#         # #                self.res, &quot;smoothed data&quot;, &quot;smoothed residual&quot;)    # Update plot</span>
            <span class="c1">#         # if self.time_ui.errorCheckBox.isChecked() == True:</span>
    
            <span class="c1">#         #     self.Canvas.plot_fig_errs(self.df[xCol], self.df[yCol], xCol, yCol, data=self.df,errs=self.df[err])</span>
            <span class="c1">#         # else:</span>
            <span class="c1">#         #     self.Canvas.plot_fig(self.df[xCol], self.df[yCol], xCol, yCol, data=self.df)</span>
                                        

            <span class="c1">#         # smallestRmsFound=True</span>
            <span class="c1">#         # self.df.fillna(0,inplace=True)</span>
            <span class="c1">#         # self.df=self.df.replace(&#39;nan&#39;,0)</span>
            <span class="c1">#         # for col in list(self.df.columns):</span>
            <span class="c1">#         #     if &quot;FILENAME&quot; in col or &quot;OBSDATE&quot;:# in col or &quot;&quot;</span>
            <span class="c1">#         #         pass</span>
            <span class="c1">#         #     else:</span>
            <span class="c1">#         #         self.df[col] = pd.to_numeric(self.df[col],downcast=float)</span>

                    
            <span class="c1">#         # out_df=self.remove_rfi(self.df,xCol,yCol)</span>

            <span class="c1">#         # #print(out_df.columns)</span>
                    
            <span class="c1">#         # #if (len(out_df) == len(self.df)):</span>
            <span class="c1">#         # #    print(&quot;Failed to remove RFI, probably data length too short&quot;)</span>
            <span class="c1">#         # #else:</span>
            <span class="c1">#         #     # merge to original</span>
            <span class="c1">#         # self.df= pd.merge(self.df, out_df, how=&#39;left&#39;, on=[&#39;MJD&#39;])</span>
            <span class="c1">#         #     #self.rename_col(self.df,&quot;_x&quot;)</span>
            <span class="c1">#         # self.rename_col(self.df,&quot;_y&quot;)</span>

            <span class="c1">#         # # re-plot</span>
            <span class="c1">#         # self.Canvas.clear_figure()</span>
            <span class="c1">#         # self.Canvas.plot_fig(self.df[xCol], self.df[yCol], xCol, yCol, data=self.df)</span>
                                    

            <span class="c1">#             # rms3_ = </span>
            <span class="c1">#             # scanLen = len(self.Canvas.x)</span>
            <span class="c1">#             # if self.data[&quot;CENTFREQ&quot;] &lt;= 3000:</span>
            <span class="c1">#             #     noTotScans = 2</span>
            <span class="c1">#             # else:</span>
            <span class="c1">#             #     noTotScans = 6</span>

            <span class="c1">#             # # spline the data</span>
            <span class="c1">#             # spl = fit.spline(self.Canvas.x, self.Canvas.y)</span>

            <span class="c1">#             # scanRes, self.Canvas.x, self.Canvas.y, res, finspl, rmsb, rmsa = fit.cleanRmsCuts2(</span>
            <span class="c1">#             #     spl, self.Canvas.x, self.Canvas.y, scanLen, self.log)</span>

            <span class="c1">#             # self.write(f&#39;RMS before: after -&gt; {rmsb}: {rmsa,}&#39;,&#39;info&#39;)</span>

            <span class="c1">#             # self.Canvas.clear_figure()  # Update figures</span>

            <span class="c1">#             # # re-plot</span>
            <span class="c1">#             # xCol=self.Canvas.xlab</span>
            <span class="c1">#             # yCol=self.Canvas.ylab</span>
            <span class="c1">#             #self.Canvas.plot_fig(self.df[xCol] ,self.df[yCol], xCol, yCol, data=self.df)</span>
    
            <span class="k">elif</span> <span class="n">filterText</span> <span class="o">==</span> <span class="s2">&quot;binning&quot;</span><span class="p">:</span>
               
               <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Binning not implemented yet</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.fit_timeseries">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.fit_timeseries">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_timeseries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># get fit type and fit order</span>
        <span class="n">fitType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxFitTypes</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">fitOrder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxOrder</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitting: </span><span class="si">{</span><span class="n">fitType</span><span class="si">}</span><span class="s2">, order: </span><span class="si">{</span><span class="n">fitOrder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fitOrder</span> <span class="o">!=</span> <span class="s2">&quot;Order&quot;</span> <span class="ow">and</span> <span class="n">fitType</span><span class="o">!=</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span>

            <span class="n">xCol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">xlab</span>
            <span class="n">yCol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">ylab</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;col: &quot;</span><span class="p">,</span><span class="n">xCol</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xCol</span> <span class="o">!=</span><span class="s2">&quot;MJD&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Require x-axis as MJD&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">fitType</span> <span class="o">==</span> <span class="s2">&quot;Polynomial&quot;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">tstart</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtStartDate</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">tstart</span><span class="o">=</span><span class="s2">&quot;nodate&quot;</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">tend</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtEndDate</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">tend</span><span class="o">=</span><span class="s2">&quot;nodate&quot;</span>

                    <span class="k">if</span> <span class="n">tstart</span> <span class="o">==</span> <span class="s2">&quot;nodate&quot;</span> <span class="ow">and</span> <span class="n">tend</span><span class="o">==</span><span class="s2">&quot;nodate&quot;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">start; </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">,  end: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">rma</span><span class="p">,</span><span class="n">coeffs</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">calc_residual_and_rms_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">fitOrder</span><span class="p">))</span>
                        <span class="n">ind</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">model</span><span class="o">==</span><span class="nb">max</span><span class="p">(</span><span class="n">model</span><span class="p">))[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="c1"># print(ind)</span>
                        <span class="c1"># sys.exit()</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tstart: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">, tend: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ymin:</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, ymax: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; model&#39;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ymin:</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, ymax: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, x @ ymax: </span><span class="si">{</span><span class="n">xm</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;rms of fit: </span><span class="si">{</span><span class="n">rma</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;coeffs: &#39;</span><span class="p">,</span><span class="n">coeffs</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_dual_fig</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;model&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of data vs polynomial model&#39;</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="n">tstart</span> <span class="o">==</span> <span class="s2">&quot;nodate&quot;</span> <span class="ow">and</span> <span class="n">tend</span><span class="o">!=</span><span class="s2">&quot;nodate&quot;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;start; </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">,  end: </span><span class="si">{</span><span class="n">tend</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        
                        <span class="k">if</span> <span class="n">tend</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;End date (</span><span class="si">{</span><span class="n">tend</span><span class="si">}</span><span class="s2">) needs to be bigger than start date (</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">tend</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">x1</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                            <span class="n">y1</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                            <span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">rma</span><span class="p">,</span><span class="n">coeffs</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">calc_residual_and_rms_fit</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">fitOrder</span><span class="p">))</span>
                            <span class="n">ind</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">model</span><span class="o">==</span><span class="nb">max</span><span class="p">(</span><span class="n">model</span><span class="p">))[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tstart: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">, tend: </span><span class="si">{</span><span class="n">tend</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ymin:</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, ymax: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; model&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ymin:</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, ymax: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, x @ ymax: </span><span class="si">{</span><span class="n">xm</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;rms of fit: </span><span class="si">{</span><span class="n">rma</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;coeffs: &#39;</span><span class="p">,</span><span class="n">coeffs</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_dual_fig</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;model&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of data vs polynomial model&#39;</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="n">tstart</span> <span class="o">!=</span> <span class="s2">&quot;nodate&quot;</span> <span class="ow">and</span> <span class="n">tend</span><span class="o">==</span><span class="s2">&quot;nodate&quot;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;start; </span><span class="si">{</span><span class="n">tstart</span><span class="si">}</span><span class="s1">,  end: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">tstart</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Start date (</span><span class="si">{</span><span class="n">tstart</span><span class="si">}</span><span class="s2">) needs to be smaller than end date (</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">tstart</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">x1</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                            <span class="n">y1</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                            <span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">rma</span><span class="p">,</span><span class="n">coeffs</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">calc_residual_and_rms_fit</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">fitOrder</span><span class="p">))</span>
                            <span class="n">ind</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">model</span><span class="o">==</span><span class="nb">max</span><span class="p">(</span><span class="n">model</span><span class="p">))[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tstart: </span><span class="si">{</span><span class="n">tstart</span><span class="si">}</span><span class="s1">, tend: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ymin:</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, ymax: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; model&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ymin:</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, ymax: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, x @ ymax: </span><span class="si">{</span><span class="n">xm</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;rms of fit: </span><span class="si">{</span><span class="n">rma</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;coeffs: &#39;</span><span class="p">,</span><span class="n">coeffs</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            
                            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_dual_fig</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;model&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of data vs polynomial model&#39;</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="n">tstart</span> <span class="o">!=</span> <span class="s2">&quot;nodate&quot;</span> <span class="ow">and</span> <span class="n">tend</span><span class="o">!=</span><span class="s2">&quot;nodate&quot;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;start; </span><span class="si">{</span><span class="n">tstart</span><span class="si">}</span><span class="s1">,  end: </span><span class="si">{</span><span class="n">tend</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">tstart</span> <span class="o">&gt;</span> <span class="n">tend</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Start date (</span><span class="si">{</span><span class="n">tstart</span><span class="si">}</span><span class="s2">) needs to be smaller than end date (</span><span class="si">{</span><span class="n">tend</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">tstart</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">tend</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">x1</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                            <span class="n">y1</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                            <span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">rma</span><span class="p">,</span><span class="n">coeffs</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">calc_residual_and_rms_fit</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">fitOrder</span><span class="p">))</span>
                            <span class="n">ind</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">model</span><span class="o">==</span><span class="nb">max</span><span class="p">(</span><span class="n">model</span><span class="p">))[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tstart: </span><span class="si">{</span><span class="n">tstart</span><span class="si">}</span><span class="s1">, tend: </span><span class="si">{</span><span class="n">tend</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ymin:</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, ymax: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; model&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ymin:</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, ymax: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, x @ ymax: </span><span class="si">{</span><span class="n">xm</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;rms of fit: </span><span class="si">{</span><span class="n">rma</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;coeffs: &#39;</span><span class="p">,</span><span class="n">coeffs</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                            <span class="c1">#print(&#39;coeffs: &#39;,coeffs)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_dual_fig</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;model&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of data vs polynomial model&#39;</span><span class="p">)</span>
                
                <span class="k">elif</span> <span class="n">fitType</span> <span class="o">==</span> <span class="s2">&quot;Spline&quot;</span><span class="p">:</span>
                    <span class="n">knots</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">EdtSplKnots</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

                    <span class="k">if</span> <span class="n">knots</span><span class="o">&lt;</span><span class="mi">9</span><span class="p">:</span>
                        <span class="n">knots</span><span class="o">=</span><span class="mi">9</span>
                    <span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">fit</span><span class="o">.</span><span class="n">spline_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">knots</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">fitOrder</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_dual_fig</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;model&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of data vs spline model&#39;</span><span class="p">)</span>
                    
        <span class="k">elif</span> <span class="n">fitOrder</span> <span class="o">==</span> <span class="s2">&quot;Order&quot;</span> <span class="ow">and</span> <span class="n">fitType</span><span class="o">!=</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No fit order selected</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">fitOrder</span> <span class="o">!=</span> <span class="s2">&quot;Order&quot;</span> <span class="ow">and</span> <span class="n">fitType</span><span class="o">==</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No fit type selected</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No fit parameters selected</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.update_point">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.update_point">[docs]</a>
    <span class="k">def</span> <span class="nf">update_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#TODO: fix the format</span>
        <span class="c1"># update db on change</span>

                    
                    <span class="c1"># check last selected points</span>
                    <span class="n">fit_points</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">fit_points</span>
                    <span class="n">click_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Deleting </span><span class="se">\n</span><span class="s2">-point: </span><span class="si">{</span><span class="n">fit_points</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">-at index </span><span class="si">{</span><span class="n">click_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="c1">#self.deleted[click_index].append([click_index, fit_points])</span>

                    <span class="c1"># print(&#39;\ndf length Before deleting: &#39;,len(self.df))</span>
                    
                    <span class="n">xCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">xlab</span>
                    <span class="n">yCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">ylab</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>

                    <span class="n">t</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">fit_points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="c1">#date=t</span>
                    <span class="n">doy</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%j&#39;</span><span class="p">)</span>
                    <span class="c1">#mjd=t.mjd</span>

                    <span class="n">xp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">]</span>
                    <span class="n">yp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span>

                    <span class="n">date_str</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">fit_points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])[:</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">d</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
                    
                    <span class="n">i</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">click_index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># point index to delete</span>
                    <span class="c1"># print(&#39;Deleting: &#39;)</span>

                    <span class="c1"># find what i is in the db</span>
                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">mjd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">FN</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-mjd: &#39;</span><span class="p">,</span><span class="n">mjd</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-file: &#39;</span><span class="p">,</span><span class="n">FN</span><span class="p">)</span> <span class="c1">#date_str</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="se">\n</span><span class="s2">-index: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Setting </span><span class="si">{</span><span class="n">yCol</span><span class="si">}</span><span class="s1">:  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">yCol</span><span class="p">]</span><span class="si">}</span><span class="s1">, to np.nan&#39;</span><span class="p">)</span>
                    
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">yCol</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">yCol</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>

                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">+ New </span><span class="si">{</span><span class="n">yCol</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">yCol</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="c1"># change plot</span>
                    <span class="n">tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                  
                    <span class="n">xcol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsX</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                    <span class="n">ycol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsY</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

                    <span class="c1">#self.dbFile</span>
                    <span class="c1"># self.db = SQLiteDB(self.dbFile, log=self.log)</span>
                    <span class="c1"># self.db.create_db()</span>

                    <span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># srcType=self.df[&#39;OBJECTTYPE&#39;].iloc[i]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2"> table: </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span> <span class="c1"># , type: {srcType}</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-BEAMTYPE: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="c1">#,&#39;\n-srcType: &#39;,srcType)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

                    <span class="c1"># update the database</span>
                    <span class="n">cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                    <span class="n">stmt</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;UPDATE &#39;</span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2">&#39; SET &quot;</span>

                    <span class="n">dct</span><span class="o">=</span><span class="p">{}</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>

                    <span class="n">dct</span><span class="p">[</span><span class="s1">&#39;OBJECT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OBJECT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">dct</span><span class="p">[</span><span class="s1">&#39;FRONTEND&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FRONTEND&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">dct</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">dct</span><span class="p">[</span><span class="s1">&#39;FRONTEND&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">dct</span><span class="p">[</span><span class="s1">&#39;ATMOS_ABSORPTION_CORR&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ATMOS_ABSORPTION_CORR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">dct</span><span class="p">[</span><span class="s1">&#39;SIZE_CORRECTION_FACTOR&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SIZE_CORRECTION_FACTOR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
                    
                    <span class="n">bms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;YCOL: &quot;</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;SLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ASLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BSLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;SLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ASLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BSLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;SRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ASRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BSRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;SRTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ASRTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BSRTAERR&quot;</span><span class="p">:</span>
                        
                        <span class="k">if</span> <span class="n">ycol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">:</span>
                            <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
                        <span class="k">elif</span> <span class="n">ycol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;B&quot;</span><span class="p">:</span>
                            <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">k</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                        <span class="k">if</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;SLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ASLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BSLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;SLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ASLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BSLTAERR&quot;</span><span class="p">:</span>
                            <span class="n">pol</span><span class="o">=</span><span class="s2">&quot;L&quot;</span>
                        <span class="k">elif</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;SRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ASRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BSRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;SRTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ASRTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BSRTAERR&quot;</span><span class="p">:</span>
                            <span class="n">pol</span><span class="o">=</span><span class="s2">&quot;R&quot;</span>

                        <span class="nb">print</span><span class="p">()</span>

                        <span class="c1"># try:</span>
                        <span class="n">hps</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                        <span class="n">err_hps</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>

                        <span class="n">b</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">hpn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">b</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">hpn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">b</span><span class="o">=</span><span class="s1">&#39;d&#39;</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">err_hpn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">b</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">err_hpn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">b</span><span class="o">=</span><span class="s1">&#39;d&#39;</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">b</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">b</span><span class="o">=</span><span class="s1">&#39;d&#39;</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">err_on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">b</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">err_on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">b</span><span class="o">=</span><span class="s1">&#39;d&#39;</span>

                        <span class="k">if</span> <span class="n">b</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;something failed&#39;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                        <span class="k">elif</span> <span class="n">b</span><span class="o">==</span><span class="s1">&#39;s&#39;</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dct: &#39;</span><span class="p">,</span><span class="n">dct</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using - &#39;N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA&#39;: </span><span class="si">{</span><span class="n">hpn</span><span class="si">}</span><span class="s2">, &#39;N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR&#39;: </span><span class="si">{</span><span class="n">err_hpn</span><span class="si">}</span><span class="s2">, &#39;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA&#39;: </span><span class="si">{</span><span class="n">on</span><span class="si">}</span><span class="s2">, &#39;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR&#39;: </span><span class="si">{</span><span class="n">err_on</span><span class="si">}</span><span class="s2"> to recalculate &quot;</span><span class="p">)</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">corrTa</span><span class="p">,</span> <span class="n">errCorrTa</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calibrate</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hpn</span><span class="p">,</span> <span class="n">err_hpn</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">err_on</span><span class="p">,</span> <span class="n">dct</span><span class="p">)</span>
                            <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">hps</span><span class="si">}</span><span class="s2">&#39;, S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">err_hps</span><span class="si">}</span><span class="s2">&#39;, S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">S2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">PC=&#39;</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">&#39;, CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">corrTa</span><span class="si">}</span><span class="s2">&#39;, CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">errCorrTa</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>   

                            <span class="k">if</span> <span class="n">pc</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">PC=np.nan&#39;</span><span class="p">)</span>
                                <span class="n">pc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                            <span class="k">if</span> <span class="n">corrTa</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                <span class="n">corrTa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA=np.nan&#39;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">errCorrTa</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                <span class="n">errCorrTa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR=np.nan&#39;</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">b</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                                <span class="c1"># dual-beam</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using - &#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA&#39;: </span><span class="si">{</span><span class="n">hpn</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR&#39;: </span><span class="si">{</span><span class="n">err_hpn</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA&#39;: </span><span class="si">{</span><span class="n">on</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR&#39;: </span><span class="si">{</span><span class="n">err_on</span><span class="si">}</span><span class="s2"> to recalculate &quot;</span><span class="p">)</span>
                                <span class="n">pc</span><span class="p">,</span> <span class="n">corrTa</span><span class="p">,</span> <span class="n">errCorrTa</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calibrate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hpn</span><span class="p">,</span> <span class="n">err_hpn</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">err_on</span><span class="p">,</span> <span class="n">dct</span><span class="p">)</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">S2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">PC=&#39;</span><span class="si">{</span><span class="n">pc</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">corrTa</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">errCorrTa</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                                
                                <span class="k">if</span> <span class="n">pc</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                    <span class="n">pc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">PC=np.nan&#39;</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">corrTa</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                    <span class="n">corrTa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA=np.nan&#39;</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">errCorrTa</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                    <span class="n">errCorrTa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR=np.nan&#39;</span><span class="p">)</span>
                        
                    <span class="k">elif</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;NLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ANLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BNLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;NLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ANLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BNLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;NRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ANRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BNRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;NRTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ANRTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BNRTAERR&quot;</span><span class="p">:</span>
                 
                            <span class="k">if</span> <span class="n">ycol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">:</span>
                                <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
                            <span class="k">elif</span> <span class="n">ycol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;B&quot;</span><span class="p">:</span>
                                <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">k</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                            <span class="k">if</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;NLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ANLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BNLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;NLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ANLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BNLTAERR&quot;</span><span class="p">:</span>
                                <span class="n">pol</span><span class="o">=</span><span class="s2">&quot;L&quot;</span>
                            <span class="k">elif</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;NRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ANRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BNRTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;NRTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ANRTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BNRTAERR&quot;</span><span class="p">:</span>
                                <span class="n">pol</span><span class="o">=</span><span class="s2">&quot;R&quot;</span>

                            <span class="nb">print</span><span class="p">()</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">hps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                <span class="n">err_hps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                <span class="n">hpn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                <span class="n">err_hpn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                <span class="n">on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                <span class="n">err_on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                <span class="c1"># single-beam</span>
                                <span class="c1"># if &quot;TAR&quot; in self.df[&#39;OBJECTTYPE&#39;].iloc[i]:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using - &#39;S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA&#39;: </span><span class="si">{</span><span class="n">hps</span><span class="si">}</span><span class="s2">, &#39;S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR&#39;: </span><span class="si">{</span><span class="n">err_hps</span><span class="si">}</span><span class="s2">, &#39;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA&#39;: </span><span class="si">{</span><span class="n">on</span><span class="si">}</span><span class="s2">, &#39;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR&#39;: </span><span class="si">{</span><span class="n">err_on</span><span class="si">}</span><span class="s2"> to recalculate &quot;</span><span class="p">)</span>
                                <span class="n">pc</span><span class="p">,</span> <span class="n">corrTa</span><span class="p">,</span> <span class="n">errCorrTa</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calibrate</span><span class="p">(</span><span class="n">hps</span><span class="p">,</span> <span class="n">err_hps</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">err_on</span><span class="p">,</span> <span class="n">dct</span><span class="p">)</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">hpn</span><span class="si">}</span><span class="s2">&#39;, N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">err_hpn</span><span class="si">}</span><span class="s2">&#39;, O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">PC=&#39;</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">&#39;, CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">corrTa</span><span class="si">}</span><span class="s2">&#39;, CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">errCorrTa</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>   

                                <span class="k">if</span> <span class="n">pc</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                    <span class="n">pc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">PC=np.nan&#39;</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">corrTa</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                    <span class="n">corrTa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA=np.nan&#39;</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">errCorrTa</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                    <span class="n">errCorrTa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR=np.nan&#39;</span><span class="p">)</span>
                            
                            <span class="k">except</span><span class="p">:</span>
                                
                                <span class="n">hps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                <span class="n">err_hps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                <span class="n">hpn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                <span class="n">err_hpn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                <span class="n">on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                <span class="n">err_on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                <span class="c1"># dual-beam</span>
                                <span class="c1"># if &quot;TAR&quot; in self.df[&#39;OBJECTTYPE&#39;].iloc[i]:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using - &#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA&#39;: </span><span class="si">{</span><span class="n">hps</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR&#39;: </span><span class="si">{</span><span class="n">err_hps</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA&#39;: </span><span class="si">{</span><span class="n">on</span><span class="si">}</span><span class="s2">, &#39;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR&#39;: </span><span class="si">{</span><span class="n">err_on</span><span class="si">}</span><span class="s2"> to recalculate &quot;</span><span class="p">)</span>
                                <span class="n">pc</span><span class="p">,</span> <span class="n">corrTa</span><span class="p">,</span> <span class="n">errCorrTa</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calibrate</span><span class="p">(</span><span class="n">hps</span><span class="p">,</span> <span class="n">err_hps</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">on</span><span class="p">,</span> <span class="n">err_on</span><span class="p">,</span> <span class="n">dct</span><span class="p">)</span>  
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">S2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">PC=&#39;</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">corrTa</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">errCorrTa</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">corrTa</span><span class="p">,</span> <span class="n">errCorrTa</span><span class="p">)</span>

                                <span class="k">if</span> <span class="n">pc</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                    <span class="n">pc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">PC=np.nan&#39;</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">corrTa</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                    <span class="n">corrTa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA=np.nan&#39;</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">errCorrTa</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
                                    <span class="n">errCorrTa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- setting </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s1">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TAERR=np.nan&#39;</span><span class="p">)</span>    
                        
                    <span class="k">elif</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;OLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;COLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;COLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ACOLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ACOLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BCOLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BCOLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;OLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;AOLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BOLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ORTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;OLPSS&quot;</span>  <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AOLPSS&quot;</span>  <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BOLPSS&quot;</span>  <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ORPSS&quot;</span>  <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AORPSS&quot;</span>  <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BORPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;OLDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AOLDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BOLDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ORDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AORDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BORDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;CORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;CORTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ACORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ACORTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BCORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BCORTAERR&quot;</span> <span class="p">:</span> 
                        
                        <span class="k">if</span> <span class="n">ycol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">:</span>
                            <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
                        <span class="k">elif</span> <span class="n">ycol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;B&quot;</span><span class="p">:</span>
                            <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">k</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                        <span class="k">if</span>   <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;OLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;OLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AOLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BOLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;OLPSS&quot;</span>  <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AOLPSS&quot;</span>  <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BOLPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;OLDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AOLDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BOLDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;COLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;COLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ACOLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ACOLTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BCOLTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BCOLTAERR&quot;</span> <span class="p">:</span>
                            <span class="n">pol</span><span class="o">=</span><span class="s2">&quot;L&quot;</span>
                        <span class="k">elif</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;ORTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;BORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ORPSS&quot;</span>  <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AORPSS&quot;</span>  <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BORPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ORDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span><span class="o">==</span><span class="s2">&quot;AORDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BORDPSS&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;CORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;CORTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ACORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;ACORTAERR&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BCORTA&quot;</span> <span class="ow">or</span> <span class="n">ycol</span> <span class="o">==</span> <span class="s2">&quot;BCORTAERR&quot;</span> <span class="p">:</span>
                            <span class="n">pol</span><span class="o">=</span><span class="s2">&quot;R&quot;</span>

                        <span class="nb">print</span><span class="p">()</span>

                        <span class="c1"># try:</span>

                        <span class="c1"># single-beam</span>
                        <span class="c1"># if &quot;TAR&quot; in self.df[&#39;OBJECTTYPE&#39;].iloc[i]:</span>
                        <span class="n">frq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CENTFREQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">frq</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">3000</span><span class="p">:</span>
                                    <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">FLAG=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span> 
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">FLAG=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">PC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  &quot;</span>
                        <span class="k">else</span><span class="p">:</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">FLAG=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">N</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">CO</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">TAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2"> &#39;,</span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">S</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">S2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">O</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">PC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                        <span class="c1"># except:</span>
                        <span class="c1"># elif &quot;CAL&quot; in self.df[&#39;OBJECTTYPE&#39;].iloc[i]:</span>
                        <span class="c1">#     frq=self.df[&#39;CENTFREQ&#39;].iloc[i]</span>
                        <span class="c1">#     if k==&quot;&quot;:</span>
                        <span class="c1">#         if int(frq)&lt;=3000:</span>
                        <span class="c1">#             # pss, errPSS, appEff = cp.calc_pss(flux, Ta, errTa)</span>
                        <span class="c1">#             stmt=stmt+f&quot;O{pol}TA=&#39;{np.nan}&#39;, O{pol}TAERR=&#39;{np.nan}&#39;, O{pol}PSS=&#39;{np.nan}&#39;, O{pol}DPSS=&#39;{np.nan}&#39;, O{pol}S2N=&#39;{np.nan}&#39;, &quot; </span>
                        <span class="c1">#         else:</span>
                        <span class="c1">#             stmt=stmt+f&quot;N{pol}TA=&#39;{np.nan}&#39;, N{pol}TAERR=&#39;{np.nan}&#39;, S{pol}TA=&#39;{np.nan}&#39;, S{pol}TAERR=&#39;{np.nan}&#39;, O{pol}TA=&#39;{np.nan}&#39;, O{pol}TAERR=&#39;{np.nan}&#39;, O{pol}PC=&#39;{np.nan}&#39;, CO{pol}TA=&#39;{np.nan}&#39;, CO{pol}TAERR=&#39;{np.nan}&#39;, O{pol}PSS=&#39;{np.nan}&#39;, O{pol}DPSS=&#39;{np.nan}&#39;, O{pol}APPEFF=&#39;{np.nan}&#39;, &quot;</span>
                        <span class="c1">#     else:</span>
                        <span class="c1">#         stmt=stmt+f&quot;{bms[k]}N{pol}TA=&#39;{np.nan}&#39;, {bms[k]}N{pol}TAERR=&#39;{np.nan}&#39;, {bms[k]}S{pol}TA=&#39;{np.nan}&#39;, {bms[k]}S{pol}TAERR=&#39;{np.nan}&#39;, {bms[k]}O{pol}TA=&#39;{np.nan}&#39;, {bms[k]}O{pol}TAERR=&#39;{np.nan}&#39;, {bms[k]}CO{pol}TA=&#39;{np.nan}&#39;, {bms[k]}CO{pol}TAERR=&#39;{np.nan} &#39;,{bms[k]}S{pol}S2N=&#39;{np.nan}&#39;, {bms[k]}O{pol}PC=&#39;{np.nan}&#39;, {bms[k]}O{pol}PSS=&#39;{np.nan}&#39;, {bms[k]}O{pol}DPSS=&#39;{np.nan}&#39;, {bms[k]}O{pol}APPEFF=&#39;{np.nan}&#39;, &quot;</span>
                    
                    <span class="k">else</span><span class="p">:</span>
                    
                        <span class="c1"># only delete that entry</span>
                        <span class="c1"># if O</span>
                        <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                    <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  
                    <span class="c1"># stmt=stmt[:-3]+f&quot;&#39;  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>
                    <span class="c1"># print(stmt) </span>
                    <span class="c1"># sys.exit()</span>
                    <span class="c1"># self.db.c.execute(stmt)</span>
                    <span class="c1"># self.db.commit_changes()</span>
                    <span class="c1"># self.db.close_db()</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_cols_df</span><span class="p">()</span>
            
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+-&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.update_db_all">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.update_db_all">[docs]</a>
    <span class="k">def</span> <span class="nf">update_db_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="c1">#TODO: Fix the format</span>
                    <span class="c1"># update db on change</span>

                    <span class="c1"># check last selected points</span>
                    <span class="n">fit_points</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">fit_points</span>
                    <span class="n">click_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s2">&quot;+&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Deleting </span><span class="se">\n</span><span class="s2">-point: </span><span class="si">{</span><span class="n">fit_points</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">-at index </span><span class="si">{</span><span class="n">click_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="c1">#self.deleted[click_index].append([click_index, fit_points])</span>

                    <span class="c1"># print(&#39;\ndf length Before deleting: &#39;,len(self.df))</span>

                    <span class="n">xCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">xlab</span>
                    <span class="n">yCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">ylab</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>

                    <span class="n">i</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">click_index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># point index to delete</span>
                    <span class="c1"># find what i is in the db</span>
                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="c1">#print(f&#39;i: {ii}, id: {id}&#39;)</span>
                    <span class="c1"># i=ii#d</span>
                    <span class="n">FN</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                    <span class="c1"># if &#39;TAR&#39; in self.df[&#39;OBJECTTYPE&#39;].iloc[i]:</span>

                    <span class="n">t</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">fit_points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                        <span class="c1"># sys.exit()</span>
                        <span class="c1">#date=t</span>
                    <span class="n">doy</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%j&#39;</span><span class="p">)</span>
                        <span class="c1">#mjd=t.mjd</span>

                    <span class="n">xp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">]</span>
                    <span class="n">yp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span>

                    <span class="n">date_str</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">fit_points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])[:</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">d</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
                        

                        <span class="c1"># for i in range(len(self.df)):</span>
                            <span class="c1"># if date_str in self.df[&#39;FILENAME&#39;].iloc[i]:</span>
                                <span class="c1">#print(date_str, self.df[&#39;FILENAME&#39;].iloc[i])</span>

                        <span class="c1">#if self.df[yCol].iloc[i]==float(fit_points[0][1]):</span>
                        

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Deleting: &#39;</span><span class="p">)</span>

                        

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-date: &#39;</span><span class="p">,</span><span class="n">date_str</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-file: &#39;</span><span class="p">,</span><span class="n">FN</span><span class="p">)</span>

                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="se">\n</span><span class="s2">-index: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="c1"># print(&#39;match: &#39;, self.df[&#39;id&#39;].iloc[i])#, self.df.iloc[i])</span>
                        
                        <span class="c1">#self.df.drop(id,inplace=True)</span>
                        
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Setting </span><span class="si">{</span><span class="n">yCol</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">yCol</span><span class="p">]</span><span class="si">}</span><span class="s1">, to np.nan&#39;</span><span class="p">)</span>
                        <span class="c1">#print(self.df.iloc[i][yCol])</span>
                    <span class="k">try</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">yCol</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">yCol</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
                            
                        <span class="c1">#self.df=self.df[~(self.df[&#39;id&#39;]==id)]</span>
                        <span class="c1">#print(self.df.iloc[i][yCol])</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">+ New </span><span class="si">{</span><span class="n">yCol</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">yCol</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="c1"># change plot</span>
                    <span class="n">tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                    
                    <span class="n">xcol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsX</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                    <span class="n">ycol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsY</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

                        <span class="c1">#self.dbFile</span>
                    <span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>

                    <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># srcType=self.df[&#39;OBJECTTYPE&#39;].iloc[i]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2"> table: </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span> <span class="c1"># , type: {srcType}</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-BEAMTYPE: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="c1">#,&#39;\n-srcType: &#39;,srcType)</span>
                    <span class="k">except</span><span class="p">:</span>
                            <span class="k">pass</span>

                        <span class="c1"># update the database</span>
                    <span class="n">cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                    <span class="n">stmt</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;UPDATE &#39;</span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2">&#39; SET &quot;</span>

                        
                    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s1">&#39;id&#39;</span> <span class="ow">in</span> <span class="n">col</span>  <span class="ow">or</span> <span class="s1">&#39;LOGFREQ&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;CURDATETIME&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> \
                            <span class="s1">&#39;FILE&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;OBSD&#39;</span> <span class="ow">in</span> <span class="n">col</span> \
                                <span class="ow">or</span> <span class="s1">&#39;MJD&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;OBS&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;OBJ&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;id&#39;</span> <span class="o">==</span> <span class="n">col</span> \
                                    <span class="ow">or</span> <span class="s1">&#39;RAD&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;TYPE&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;PRO&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;TELE&#39;</span> <span class="ow">in</span>\
                                        <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;UPGR&#39;</span> <span class="ow">in</span> <span class="n">col</span>  <span class="ow">or</span> <span class="s1">&#39;INST&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> \
                                            <span class="s1">&#39;SCANDIR&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;SRC&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;COORDSYS&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;LONGITUD&#39;</span> <span class="ow">in</span> <span class="n">col</span> \
                                                <span class="ow">or</span> <span class="s1">&#39;LATITUDE&#39;</span> <span class="ow">in</span> <span class="n">col</span>  <span class="ow">or</span> <span class="s1">&#39;POINTING&#39;</span> <span class="ow">in</span> <span class="n">col</span> \
                                                <span class="ow">or</span> <span class="s1">&#39;DICHROIC&#39;</span> <span class="ow">in</span> <span class="n">col</span> \
                                                        <span class="ow">or</span> <span class="s1">&#39;PHASECAL&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;HPBW&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;FNBW&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;SNBW&#39;</span> <span class="ow">in</span> <span class="n">col</span>\
                                                            <span class="ow">or</span> <span class="s1">&#39;FRONTEND&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;BASE&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span> 
                                <span class="k">pass</span>
                        <span class="k">else</span><span class="p">:</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                    <span class="c1"># </span>

                    <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>        
                 
                  

                    <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                    <span class="c1"># print(&quot;updated CALDB&quot;)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After deleting: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">yCol</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_cols_df</span><span class="p">()</span></div>

                 
<div class="viewcode-block" id="Main.update_db">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.update_db">[docs]</a>
    <span class="k">def</span> <span class="nf">update_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="c1">#TODO: check that this works</span>
                    <span class="c1"># update db on change</span>

                    <span class="c1"># check last selected points</span>
                    <span class="n">fit_points</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">fit_points</span>
                    <span class="n">click_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s2">&quot;+&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Deleting </span><span class="se">\n</span><span class="s2">-point: </span><span class="si">{</span><span class="n">fit_points</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">-at index </span><span class="si">{</span><span class="n">click_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># print(&#39;\ndf length Before deleting: &#39;,len(self.df))</span>

                    <span class="n">xCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">xlab</span>
                    <span class="n">yCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">ylab</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">t</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">fit_points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;An error occurred, please ensure you click on a point&#39;</span><span class="p">)</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

                    <span class="n">doy</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%j&#39;</span><span class="p">)</span>

                    <span class="n">xp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">]</span>
                    <span class="n">yp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span>

                    <span class="n">date_str</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">fit_points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])[:</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">d</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
                    
                    <span class="n">ii</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">click_index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># point index to delete</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Deleting: &#39;</span><span class="p">)</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

                    <span class="c1"># find what i is in the db</span>
                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>

                    <span class="n">i</span><span class="o">=</span><span class="n">ii</span><span class="c1">#d</span>
                    <span class="n">FN</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-date: &#39;</span><span class="p">,</span><span class="n">date_str</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-file: &#39;</span><span class="p">,</span><span class="n">FN</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="se">\n</span><span class="s2">-index: </span><span class="si">{</span><span class="n">ii</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; Setting </span><span class="si">{</span><span class="n">yCol</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">yCol</span><span class="p">]</span><span class="si">}</span><span class="s1">, to np.nan&#39;</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">yCol</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">+ New </span><span class="si">{</span><span class="n">yCol</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">yCol</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="n">tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxTables</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                  
                    <span class="n">xcol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsX</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                    <span class="n">ycol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsY</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

                    <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="c1">#SQLiteDB(databaseName=&quot;CALDB.db&quot;, log=self.log)</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>

                    <span class="n">srcType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OBJECTTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">srcType</span> <span class="o">==</span> <span class="s2">&quot;CAL&quot;</span><span class="p">:</span>
                        
                        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2"> table: </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2">, type: </span><span class="si">{</span><span class="n">srcType</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                        
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-BEAMTYPE: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-srcType: &#39;</span><span class="p">,</span><span class="n">srcType</span><span class="p">)</span>

                        <span class="c1"># update the database</span>
                        <span class="k">if</span> <span class="s1">&#39;S&#39;</span> <span class="ow">in</span>  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>

                            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                            
                            <span class="k">if</span> <span class="s2">&quot;13.0S&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                                <span class="k">if</span> <span class="s2">&quot;TSYS1&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;TSYS2&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="s1">&#39;TSYS1&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, OLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">,  OLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">, WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="k">if</span> <span class="s1">&#39;TSYS2&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, ORPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, ORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, ORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">, WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                <span class="k">elif</span> <span class="s2">&quot;OLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="p">:</span>
                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=201, OLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">&#39;, OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                <span class="k">elif</span> <span class="s2">&quot;ORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="p">:</span>
                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=202, ORPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, ORDPSS=&#39;</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">&#39;, ORAPPEFF=&#39;</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                <span class="k">elif</span> <span class="s2">&quot;OLPSS&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">print updating OLPSS&#39;</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=201, OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                <span class="k">elif</span> <span class="s2">&quot;ORPSS&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">print updating ORPSS&#39;</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=202, ORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                       
                                <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DONE&#39;</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                            <span class="k">else</span><span class="p">:</span>
                    
                                <span class="k">if</span> <span class="s2">&quot;TSYS1&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;TSYS2&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s1">&#39;LS2N&#39;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s1">&#39;RS2N&#39;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s1">&#39;PC&#39;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="p">:</span><span class="c1"># or &quot;SLTA&quot; in ycol:</span>
                                    <span class="k">if</span> <span class="s1">&#39;TSYS1&#39;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                            NLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                                OLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                                    OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="s1">&#39;OLPC&#39;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                            NLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                                OLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                                    OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, TSYS1=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="s1">&#39;ORPC&#39;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                            NLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                                OLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                                    OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="s1">&#39;TSYS2&#39;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                            ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, ORS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                                ORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTAERR=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="s1">&#39;SLS2N&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,NLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, TSYS1=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="s1">&#39;NLS2N&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,SLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, TSYS1=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="s1">&#39;OLS2N&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,NLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, TSYS1=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="s1">&#39;SRS2N&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,NRS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTAERR=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                       
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="s1">&#39;NRS2N&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,SRS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTAERR=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                       
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="s1">&#39;ORS2N&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,NRS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTAERR=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                       
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                <span class="k">elif</span> <span class="s2">&quot;OLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;NLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;SLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        
                                        <span class="k">if</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                            <span class="k">if</span> <span class="s2">&quot;13.0S&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">sta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">staerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                                <span class="k">if</span> <span class="s2">&quot;01.3S&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                              
                                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">updating 22ghz olpss - nlta&#39;</span><span class="p">)</span>
                                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sta</span><span class="p">,</span><span class="n">staerr</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TOTAL_PLANET_FLUX_D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                                <span class="k">elif</span> <span class="s2">&quot;02.5S&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">updating 12ghz olpss - nlta&#39;</span><span class="p">)</span>
                                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sta</span><span class="p">,</span><span class="n">staerr</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                                    
                                                
                                                <span class="c1">#print(str(self.df[&#39;BEAMTYPE&#39;].iloc[i]),&quot;0.25S&quot;,&quot;0.25S&quot;==str(self.df[&#39;BEAMTYPE&#39;].iloc[i]))</span>
                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, OLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, OLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, OLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">, COLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">, COLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>

                                        <span class="k">elif</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                            <span class="k">if</span> <span class="s2">&quot;13.0S&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">nta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">ntaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                                <span class="k">if</span> <span class="s2">&quot;01.3S&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">updating 22ghz olpss - slta&#39;</span><span class="p">)</span>
                                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">nta</span><span class="p">,</span><span class="n">ntaerr</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TOTAL_PLANET_FLUX_D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                                <span class="k">elif</span> <span class="s2">&quot;02.5S&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">updating 12ghz olpss - slta&#39;</span><span class="p">)</span>
                                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">nta</span><span class="p">,</span><span class="n">ntaerr</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                                
                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, OLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, OLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, OLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,COLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,COLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                                        <span class="k">else</span><span class="p">:</span>
                                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;print updating OLTA&#39;</span><span class="p">)</span>
                                            <span class="k">try</span><span class="p">:</span>
                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, OLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                            <span class="k">except</span><span class="p">:</span>
                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLFLAG=200, OLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                            <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DONE&#39;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                                <span class="k">elif</span> <span class="s2">&quot;ORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;NRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;SRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                            <span class="k">if</span> <span class="s2">&quot;13.0S&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ORTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ORTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">sta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">staerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                                <span class="k">if</span> <span class="s2">&quot;01.3S&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating 22ghz orpss - nrta&#39;</span><span class="p">)</span>
                                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sta</span><span class="p">,</span><span class="n">staerr</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TOTAL_PLANET_FLUX_D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                                <span class="k">elif</span> <span class="s2">&quot;02.5S&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating 12ghz orpss - nrta&#39;</span><span class="p">)</span>
                                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sta</span><span class="p">,</span><span class="n">staerr</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                                
                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORFLAG=200, ORPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, ORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, ORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, ORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,CORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,CORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                                <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                                <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                                <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;updated CALDB&quot;</span><span class="p">)</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DONE&#39;</span><span class="p">)</span>

                                    <span class="k">elif</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                            <span class="k">if</span> <span class="s2">&quot;13.0S&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ORTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ORTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">nta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NRTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">ntaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NRTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                                <span class="k">if</span> <span class="s2">&quot;01.3S&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating 22ghz orpss - srta&#39;</span><span class="p">)</span>
                                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">nta</span><span class="p">,</span><span class="n">ntaerr</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TOTAL_PLANET_FLUX_D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                                <span class="k">elif</span> <span class="s2">&quot;02.5S&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating 12ghz orpss - srta&#39;</span><span class="p">)</span>
                                                    <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">nta</span><span class="p">,</span><span class="n">ntaerr</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                                
                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, ORPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, ORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, ORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, ORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,CORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,CORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                                <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                                <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                                <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;updated CALDB&quot;</span><span class="p">)</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DONE&#39;</span><span class="p">)</span>

                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">print updating ORTA&#39;</span><span class="p">)</span>
                                        <span class="k">try</span><span class="p">:</span>
                                            <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, ORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2"> WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="k">except</span><span class="p">:</span>
                                            <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, ORPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;updated CALDB&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                <span class="k">elif</span> <span class="s2">&quot;OLPSS&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">print updating OLPSS&#39;</span><span class="p">)</span>
                                        <span class="c1"># try:</span>
                                        <span class="c1">#     stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, OLFLAG=200, COLTA=&#39;{np.nan}&#39;, COLTAERR=&#39;{np.nan}&#39;, OLAPPEFF=&#39;{np.nan}&#39; WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>
                                        <span class="c1"># except:</span>
                                        <span class="c1">#     stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, OLFLAG=200, OLTA=&#39;{np.nan}&#39; WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>
                                        
                                        <span class="c1"># try:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=201, OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="c1"># except:</span>
                                        <span class="c1">#     stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;,OLTAERR=&#39;{np.nan}&#39;,OLFLAG=200, OLPSS=&#39;{np.nan}&#39;,OLDPSS=&#39;{np.nan}&#39;,OLAPPEFF=&#39;{np.nan}&#39; WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                <span class="k">elif</span> <span class="s2">&quot;ORPSS&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">print updating ORPSS&#39;</span><span class="p">)</span>
                                        <span class="c1"># try:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, ORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        <span class="c1"># except:</span>
                                        <span class="c1">#     stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, ORFLAG=200, ORTA=&#39;{np.nan}&#39;  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                <span class="k">else</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No update&#39;</span><span class="p">)</span><span class="c1">#MISSED: &#39;,ycol)</span>
                                    <span class="c1">#sys.exit()</span>

                        <span class="k">elif</span> <span class="s1">&#39;D&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;D in beamtype&quot;</span><span class="p">)</span>

                            <span class="k">if</span> <span class="s2">&quot;TSYS1&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;TSYS2&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span><span class="c1"># or &quot;SLTA&quot; in ycol:</span>
                                <span class="k">if</span> <span class="s1">&#39;TSYS1&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AOLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ANLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ANLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AOLFLAG=200, AOLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, AOLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, AOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, AOLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">, ACOLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">, ACOLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                                         BOLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BNLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BNLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BOLFLAG=200, BOLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, BOLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, BOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, BOLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">, BCOLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">, BCOLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>
                                <span class="k">if</span> <span class="s1">&#39;TSYS2&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ANRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ANRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AORFLAG=200, AORPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, AORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, AORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, AORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">, ACORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">, ACORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  </span><span class="se">\</span>
<span class="s2">                                         BORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BNRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BNRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BORFLAG=200, BORPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, BORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, BORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, BORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">, BCORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">, BCORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;AOLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, AOLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,AOLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;AORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORFLAG=200, AORPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; ,AORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;BOLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, BOLPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; ,BOLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;BORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORFLAG=200, BORPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; ,BORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;AOLPSS&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AOLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;AORPSS&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, AORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;BOLPSS&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, BOLDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;BORPSS&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, BORDPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;ASLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;BSLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    
                                    <span class="k">if</span> <span class="s2">&quot;ASLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AOLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AOLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">nta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ANLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ntaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ANLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aolpss - aSlta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">nta</span><span class="p">,</span><span class="n">ntaerr</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, AOLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, AOLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, AOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, AOLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,ACOLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,ACOLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="k">elif</span> <span class="s2">&quot;BSLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BOLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BOLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">nta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BNLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ntaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BNLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aolpss - bSlta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">nta</span><span class="p">,</span><span class="n">ntaerr</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, BOLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, BOLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, BOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, BOLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,BCOLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,BCOLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;ANLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;BNLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    
                                    <span class="k">if</span> <span class="s2">&quot;ANLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AOLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AOLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">sta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">staerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aolpss - aSlta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sta</span><span class="p">,</span><span class="n">staerr</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, AOLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, AOLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, AOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, AOLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,ACOLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,ACOLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="k">elif</span> <span class="s2">&quot;BNLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BOLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BOLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">sta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BSLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">staerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BSLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aolpss - bSlta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sta</span><span class="p">,</span><span class="n">staerr</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, BOLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, BOLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, BOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, BOLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,BCOLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,BCOLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;AOLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;BOLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    
                                    <span class="k">if</span> <span class="s2">&quot;AOLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aolpss - aSlta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, AOLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, AOLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, AOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, AOLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,ACOLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,ACOLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="k">elif</span> <span class="s2">&quot;BOLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aolpss - bSlta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, BOLPSS=&#39;</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">&#39;, BOLDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, BOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, BOLAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,BCOLTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,BCOLTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;ASRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;BSRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    
                                    <span class="k">if</span> <span class="s2">&quot;ASRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AORTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AORTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">nta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ANRTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ntaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ANRTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aoRpss - aSRta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">nta</span><span class="p">,</span><span class="n">ntaerr</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, AORPSS=</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">, AORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, AORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, AORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,ACORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,ACORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="k">elif</span> <span class="s2">&quot;BSRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BORTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BORTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">nta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BNRTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ntaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BNRTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aoRpss - bSRta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">nta</span><span class="p">,</span><span class="n">ntaerr</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, BORPSS=</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">, BORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, BORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, BORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,BCORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,BCORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;ANRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;BNRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    
                                    <span class="k">if</span> <span class="s2">&quot;ANRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AORTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AORTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">sta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASRTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">staerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASRTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aoRpss - aSRta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sta</span><span class="p">,</span><span class="n">staerr</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, AORPSS=</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">, AORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, AORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, AORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,ACORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,ACORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="k">elif</span> <span class="s2">&quot;BNRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">onta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BORTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">ontaerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BORTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">sta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BSRTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">staerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BSRTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aoRpss - bSlta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">calc_pc_pss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sta</span><span class="p">,</span><span class="n">staerr</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">onta</span><span class="p">,</span><span class="n">ontaerr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, BORPSS=</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">, BORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, BORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, BORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,BCORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,BCORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="s2">&quot;AORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;BORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    
                                    <span class="k">if</span> <span class="s2">&quot;AORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aoRpss - aSRta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, AORPSS=</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">, AORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, AORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, AORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,ACORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,ACORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="k">elif</span> <span class="s2">&quot;BORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual aoRPss - bSRta&#39;</span><span class="p">)</span>
                                        <span class="n">pss</span><span class="p">,</span><span class="n">errpss</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">ota</span><span class="p">,</span><span class="n">otaerr</span><span class="p">,</span><span class="n">appeff</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, BORPSS=</span><span class="si">{</span><span class="n">pss</span><span class="si">}</span><span class="s2">, BORDPSS=</span><span class="si">{</span><span class="n">errpss</span><span class="si">}</span><span class="s2">, BORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, BORAPPEFF=</span><span class="si">{</span><span class="n">appeff</span><span class="si">}</span><span class="s2">,BCORTA=</span><span class="si">{</span><span class="n">ota</span><span class="si">}</span><span class="s2">,BCORTAERR=</span><span class="si">{</span><span class="n">otaerr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>

                            <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                            <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                            <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;updated CALDB&quot;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>
                    
                            <span class="c1"># complete the code here</span>
                            <span class="c1"># for the rest of them.</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2"> table: </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2">, type: </span><span class="si">{</span><span class="n">srcType</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                        
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-BEAMTYPE: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-srcType: &#39;</span><span class="p">,</span><span class="n">srcType</span><span class="p">)</span>

                        <span class="c1"># update the database</span>
                        <span class="k">if</span> <span class="s1">&#39;S&#39;</span> <span class="ow">in</span>  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>

                            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                            
                            <span class="k">if</span> <span class="s2">&quot;13.0S&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                                
                                <span class="k">if</span> <span class="s2">&quot;TSYS1&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;TSYS2&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                    <span class="k">if</span> <span class="s1">&#39;TSYS1&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">stoterr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, SLCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  STOT=&#39;</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">&#39;, STOTERR=&#39;</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="k">if</span> <span class="s1">&#39;TSYS2&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">stoterr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, SRCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  STOT=&#39;</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">&#39;, STOTERR=&#39;</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                <span class="k">elif</span> <span class="s2">&quot;OLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;SLCP&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="p">:</span>
                                    <span class="n">stot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                    <span class="n">stoterr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=201, TSYS1=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, STOT=&#39;</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">&#39;, STOTERR=&#39;</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                <span class="k">elif</span> <span class="s2">&quot;ORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;SRCP&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                    <span class="n">stoterr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=201, TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  STOT=&#39;</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">&#39;, STOTERR=&#39;</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">&#39; WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                <span class="c1"># elif &quot;SLCP&quot; in ycol:</span>
                                <span class="c1">#     print(&#39;\nprint updating SLCP&#39;)</span>
                                <span class="c1">#     stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, SLCPERR=&#39;{np.nan}&#39;, OLFLAG=202, OLAPPEFF=&#39;{np.nan}&#39; WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                                <span class="c1"># elif &quot;SRCP&quot; in ycol:</span>
                                <span class="c1">#     print(&#39;\nprint updating SRCP&#39;)</span>
                                <span class="c1">#     stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, ORFLAG=202, ORDPSS=&#39;{np.nan}&#39;, ORAPPEFF=&#39;{np.nan}&#39; WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>
                                       
                                <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DONE&#39;</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                            <span class="k">else</span><span class="p">:</span>

                                <span class="k">if</span> <span class="s2">&quot;TSYS1&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;TSYS2&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                    <span class="k">if</span> <span class="s1">&#39;TSYS1&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLS2N=200,  </span><span class="se">\</span>
<span class="s2">                                            SLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            NLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            SLCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            SLCPPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLCPPSSERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            STOT=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, STOTERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; </span><span class="se">\</span>
<span class="s2">                                            WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                        
                                    <span class="k">if</span> <span class="s1">&#39;TSYS2&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  ORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORS2N=200,  </span><span class="se">\</span>
<span class="s2">                                            SRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            NRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            SRCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            SRCPPSS=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRCPPSSERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            STOT=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, STOTERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; </span><span class="se">\</span>
<span class="s2">                                            WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                <span class="k">elif</span> <span class="s2">&quot;OLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;NLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;SLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                        <span class="n">srcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">srcperr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        
                                        <span class="k">if</span> <span class="s1">&#39;NLTA&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                                <span class="n">hpsTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errHpsTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">onTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errOnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">pss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCPPSS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errpss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCPPSSERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                                <span class="n">pc</span><span class="p">,</span><span class="n">corrta</span><span class="p">,</span><span class="n">errta</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="n">hpsTa</span><span class="p">,</span> <span class="n">errHpsTa</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">onTa</span><span class="p">,</span> <span class="n">errOnTa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                                <span class="n">slcp</span><span class="o">=</span><span class="n">corrta</span><span class="o">*</span><span class="n">pss</span>
                                                <span class="n">slcperr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">corrta</span><span class="o">/</span><span class="n">errta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">pss</span><span class="o">/</span><span class="n">errpss</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">slcp</span>

                                                <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="n">slcp</span><span class="o">+</span><span class="n">srcp</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
                                                <span class="n">stoterr</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">slcperr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">srcperr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, OLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, COLTA=</span><span class="si">{</span><span class="n">corrta</span><span class="si">}</span><span class="s2">, COLTAERR=</span><span class="si">{</span><span class="n">errta</span><span class="si">}</span><span class="s2">, SLCP=</span><span class="si">{</span><span class="n">slcp</span><span class="si">}</span><span class="s2">, SLCPERR=</span><span class="si">{</span><span class="n">slcperr</span><span class="si">}</span><span class="s2">,STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">, STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                               
                                        <span class="k">elif</span> <span class="s1">&#39;SLTA&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                                <span class="n">hpnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errHpnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">onTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errOnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">pss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCPPSS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errpss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCPPSSERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                                <span class="n">pc</span><span class="p">,</span><span class="n">corrta</span><span class="p">,</span><span class="n">errta</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hpnTa</span><span class="p">,</span> <span class="n">errHpnTa</span><span class="p">,</span> <span class="n">onTa</span><span class="p">,</span> <span class="n">errOnTa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                                <span class="n">slcp</span><span class="o">=</span><span class="n">corrta</span><span class="o">*</span><span class="n">pss</span>
                                                <span class="n">slcperr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">corrta</span><span class="o">/</span><span class="n">errta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">pss</span><span class="o">/</span><span class="n">errpss</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">slcp</span>

                                                <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="n">slcp</span><span class="o">+</span><span class="n">srcp</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
                                                <span class="n">stoterr</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">slcperr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">srcperr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, OLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, COLTA=</span><span class="si">{</span><span class="n">corrta</span><span class="si">}</span><span class="s2">, COLTAERR=</span><span class="si">{</span><span class="n">errta</span><span class="si">}</span><span class="s2">, SLCP=</span><span class="si">{</span><span class="n">slcp</span><span class="si">}</span><span class="s2">, SLCPERR=</span><span class="si">{</span><span class="n">slcperr</span><span class="si">}</span><span class="s2">,STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">, STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                              
                                        <span class="k">else</span><span class="p">:</span>
                                            <span class="c1"># print(&#39;print updating OLTA&#39;)</span>
                                            <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,NLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                                NLTAERR&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,OLAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,SLCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                                SLCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,STOT=</span><span class="si">{</span><span class="n">srcp</span><span class="si">}</span><span class="s2">,STOTERR=</span><span class="si">{</span><span class="n">srcperr</span><span class="si">}</span><span class="s2"> WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                         
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DONE&#39;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                                <span class="k">elif</span> <span class="s2">&quot;ORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;NRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;SRTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                        <span class="n">slcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">slcperr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SLCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="k">if</span> <span class="s1">&#39;NRTA&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                                <span class="n">hpsTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errHpsTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">onTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ORTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errOnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ORTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">pss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCPPSS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errpss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCPPSSERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                                <span class="n">pc</span><span class="p">,</span><span class="n">corrta</span><span class="p">,</span><span class="n">errta</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="n">hpsTa</span><span class="p">,</span> <span class="n">errHpsTa</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">onTa</span><span class="p">,</span> <span class="n">errOnTa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                                <span class="n">srcp</span><span class="o">=</span><span class="n">corrta</span><span class="o">*</span><span class="n">pss</span>
                                                <span class="n">srcperr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">corrta</span><span class="o">/</span><span class="n">errta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">pss</span><span class="o">/</span><span class="n">errpss</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">slcp</span>

                                                <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="n">slcp</span><span class="o">+</span><span class="n">srcp</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
                                                <span class="n">stoterr</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">slcperr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">srcperr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, ORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, CORTA=</span><span class="si">{</span><span class="n">corrta</span><span class="si">}</span><span class="s2">, CORTAERR=</span><span class="si">{</span><span class="n">errta</span><span class="si">}</span><span class="s2">, SRCP=</span><span class="si">{</span><span class="n">slcp</span><span class="si">}</span><span class="s2">, SRCPERR=</span><span class="si">{</span><span class="n">slcperr</span><span class="si">}</span><span class="s2">,STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">, STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                               
                                        <span class="k">elif</span> <span class="s1">&#39;SRTA&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                                <span class="n">hpnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errHpnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">onTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errOnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">pss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCPPSS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                <span class="n">errpss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SRCPPSSERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                                <span class="n">pc</span><span class="p">,</span><span class="n">corrta</span><span class="p">,</span><span class="n">errta</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hpnTa</span><span class="p">,</span> <span class="n">errHpnTa</span><span class="p">,</span> <span class="n">onTa</span><span class="p">,</span> <span class="n">errOnTa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                                <span class="n">srcp</span><span class="o">=</span><span class="n">corrta</span><span class="o">*</span><span class="n">pss</span>
                                                <span class="n">srcperr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">corrta</span><span class="o">/</span><span class="n">errta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">pss</span><span class="o">/</span><span class="n">errpss</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">slcp</span>

                                                <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="n">slcp</span><span class="o">+</span><span class="n">srcp</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
                                                <span class="n">stoterr</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">slcperr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">srcperr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, ORPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, CORTA=</span><span class="si">{</span><span class="n">corrta</span><span class="si">}</span><span class="s2">, CORTAERR=</span><span class="si">{</span><span class="n">errta</span><span class="si">}</span><span class="s2">, SRCP=</span><span class="si">{</span><span class="n">slcp</span><span class="si">}</span><span class="s2">, SRCPERR=</span><span class="si">{</span><span class="n">slcperr</span><span class="si">}</span><span class="s2">,STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">, STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                              
                                        <span class="k">else</span><span class="p">:</span>
                                            <span class="c1"># print(&#39;print updating OLTA&#39;)</span>
                                            <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,SRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,NRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,NRTAERR&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                                ORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, CORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,ORAPPEFF=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,SRCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                                STOT=</span><span class="si">{</span><span class="n">slcp</span><span class="si">}</span><span class="s2">,STOTERR=</span><span class="si">{</span><span class="n">slcperr</span><span class="si">}</span><span class="s2"> WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                         
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DONE&#39;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                                <span class="k">elif</span> <span class="s2">&quot;SLCP&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                        <span class="c1"># print(&#39;\nprint updating OLPSS&#39;)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=201, </span><span class="se">\</span>
<span class="s2">                                            SLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            NLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            OLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, COLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLS2N=202,  </span><span class="se">\</span>
<span class="s2">                                            STOT=</span><span class="si">{</span><span class="n">srcp</span><span class="si">}</span><span class="s2">, STOTERR=</span><span class="si">{</span><span class="n">srcperr</span><span class="si">}</span><span class="se">\</span>
<span class="s2">                                        WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                <span class="k">elif</span> <span class="s2">&quot;SRCP&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                        <span class="c1"># print(&#39;\nprint updating ORPSS&#39;)</span>
                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=202, </span><span class="se">\</span>
<span class="s2">                                            SRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            NRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRS2N=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,</span><span class="se">\</span>
<span class="s2">                                            ORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, CORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORS2N=202,  </span><span class="se">\</span>
<span class="s2">                                            STOT=</span><span class="si">{</span><span class="n">srcp</span><span class="si">}</span><span class="s2">, STOTERR=</span><span class="si">{</span><span class="n">srcperr</span><span class="si">}</span><span class="se">\</span>
<span class="s2">                                        WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                        <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>

                                <span class="k">else</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No update algorithm setup yet</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="s1">&#39;D&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BEAMTYPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                            <span class="c1"># print(&quot;D in beamtype&quot;)1</span>
                            <span class="n">aslcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASLCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">bslcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BSLCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">asrcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASRCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">bsrcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BSRCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">aslcperr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASLCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">bslcperr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BSLCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">asrcperr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASRCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">bsrcperr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BSRCPERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                            <span class="k">if</span> <span class="s2">&quot;TSYS1&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;TSYS2&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                <span class="k">if</span> <span class="s1">&#39;TSYS1&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                        AOLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, AOLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  ACOLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ACOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                        ASLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLFLAG=200, ANLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ANLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39; </span><span class="se">\</span>
<span class="s2">                                        BSLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLFLAG=200, BNLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BNLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                        BOLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BOLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  BCOLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BCOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                        ASLCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASLCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,BSLCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSLCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                <span class="k">if</span> <span class="s1">&#39;TSYS2&#39;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                        AORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, AORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ACORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ACORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                        ASRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRFLAG=200, ANRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ANRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                        BSRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRFLAG=200, BNRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BNRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                        BORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BORFLAG=200, BORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BCORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BCORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                        ASRCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASRCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSRCP=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSRCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;ASLCP&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">bslcp</span><span class="p">,</span><span class="n">asrcp</span><span class="p">,</span><span class="n">bsrcp</span><span class="p">]</span>
                                <span class="n">er</span><span class="o">=</span><span class="p">[</span><span class="n">bslcperr</span><span class="p">,</span><span class="n">asrcperr</span><span class="p">,</span><span class="n">bsrcperr</span><span class="p">]</span>
                                <span class="n">ss</span><span class="o">=</span><span class="p">[]</span>
                                <span class="n">se</span><span class="o">=</span><span class="p">[]</span>
                                       
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
                                    <span class="k">if</span> <span class="s2">&quot;nan&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                        <span class="k">pass</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                        <span class="n">se</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">er</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                
                                <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
                                <span class="n">stoterr</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">se</span><span class="p">]))</span>

                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASLCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  OLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                    STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">,  STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                                    WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;BSLCP&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">aslcp</span><span class="p">,</span><span class="n">asrcp</span><span class="p">,</span><span class="n">bsrcp</span><span class="p">]</span>
                                <span class="n">er</span><span class="o">=</span><span class="p">[</span><span class="n">aslcperr</span><span class="p">,</span><span class="n">asrcperr</span><span class="p">,</span><span class="n">bsrcperr</span><span class="p">]</span>
                                <span class="n">ss</span><span class="o">=</span><span class="p">[]</span>
                                <span class="n">se</span><span class="o">=</span><span class="p">[]</span>
                                       
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
                                    <span class="k">if</span> <span class="s2">&quot;nan&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                        <span class="k">pass</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                        <span class="n">se</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">er</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                
                                <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
                                <span class="n">stoterr</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">se</span><span class="p">]))</span>

                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSLCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  OLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                    STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">,  STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                                    WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;ASRCP&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">bslcp</span><span class="p">,</span><span class="n">asrcp</span><span class="p">,</span><span class="n">bsrcp</span><span class="p">]</span>
                                <span class="n">er</span><span class="o">=</span><span class="p">[</span><span class="n">bslcperr</span><span class="p">,</span><span class="n">asrcperr</span><span class="p">,</span><span class="n">bsrcperr</span><span class="p">]</span>
                                <span class="n">ss</span><span class="o">=</span><span class="p">[]</span>
                                <span class="n">se</span><span class="o">=</span><span class="p">[]</span>
                                       
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
                                    <span class="k">if</span> <span class="s2">&quot;nan&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                        <span class="k">pass</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                        <span class="n">se</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">er</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                
                                <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
                                <span class="n">stoterr</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">se</span><span class="p">]))</span>

                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASRCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  ORFLAG=200, </span><span class="se">\</span>
<span class="s2">                                    STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">,  STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                                    WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;BSRCP&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">aslcp</span><span class="p">,</span><span class="n">asrcp</span><span class="p">,</span><span class="n">bsrcp</span><span class="p">]</span>
                                <span class="n">er</span><span class="o">=</span><span class="p">[</span><span class="n">aslcperr</span><span class="p">,</span><span class="n">asrcperr</span><span class="p">,</span><span class="n">bsrcperr</span><span class="p">]</span>
                                <span class="n">ss</span><span class="o">=</span><span class="p">[]</span>
                                <span class="n">se</span><span class="o">=</span><span class="p">[]</span>
                                       
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
                                    <span class="k">if</span> <span class="s2">&quot;nan&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                        <span class="k">pass</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                        <span class="n">se</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">er</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                
                                <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
                                <span class="n">stoterr</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">se</span><span class="p">]))</span>

                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSRCPERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  ORFLAG=200, </span><span class="se">\</span>
<span class="s2">                                    STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">,  STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                                    WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;AOLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  OLFLAG=200, AOLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  ACOLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ACOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                    ASLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                    ANLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ANLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLFLAG=200 </span><span class="se">\</span>
<span class="s2">                                    WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;AORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, AORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, AORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ACORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ACORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                    ASRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRFLAG=200, </span><span class="se">\</span>
<span class="s2">                                    ANRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ANRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRFLAG=200 </span><span class="se">\</span>
<span class="s2">                                    WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;BOLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, BOLPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  BCOLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BCOLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                    BSLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                    BNLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BNLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NLFLAG=200 </span><span class="se">\</span>
<span class="s2">                                    WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;BORTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ORFLAG=200, BORPC=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;,  BCORTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BCORTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                    BSRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, SRFLAG=200, </span><span class="se">\</span>
<span class="s2">                                    BNRTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BNRTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, NRFLAG=200 </span><span class="se">\</span>
<span class="s2">                                    WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;ASLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;BSLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                    <span class="k">if</span> <span class="s2">&quot;ASLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>

                                        <span class="c1"># recalculate tot flux</span>
                                        <span class="n">hpnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ANLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">errHpnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ANLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">onTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AOLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">errOnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AOLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">pss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ALCPPSS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">errpss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ALCPPSSERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="n">pc</span><span class="p">,</span><span class="n">corrta</span><span class="p">,</span><span class="n">errta</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hpnTa</span><span class="p">,</span> <span class="n">errHpnTa</span><span class="p">,</span> <span class="n">onTa</span><span class="p">,</span> <span class="n">errOnTa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                        <span class="n">slcp</span><span class="o">=</span><span class="n">corrta</span><span class="o">*</span><span class="n">pss</span>
                                        <span class="n">slcperr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">corrta</span><span class="o">/</span><span class="n">errta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">pss</span><span class="o">/</span><span class="n">errpss</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">slcp</span>

                                        <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">slcp</span><span class="p">,</span><span class="n">bslcp</span><span class="p">,</span><span class="n">asrcp</span><span class="p">,</span><span class="n">bsrcp</span><span class="p">]</span>
                                        <span class="n">er</span><span class="o">=</span><span class="p">[</span><span class="n">slcperr</span><span class="p">,</span><span class="n">bslcperr</span><span class="p">,</span><span class="n">asrcperr</span><span class="p">,</span><span class="n">bsrcperr</span><span class="p">]</span>
                                        <span class="n">ss</span><span class="o">=</span><span class="p">[]</span>
                                        <span class="n">se</span><span class="o">=</span><span class="p">[]</span>
                                       
                                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
                                            <span class="k">if</span> <span class="s2">&quot;nan&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                <span class="k">pass</span>
                                            <span class="k">else</span><span class="p">:</span>
                                                <span class="n">ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                <span class="n">se</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">er</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                
                                        <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
                                        <span class="n">stoterr</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">se</span><span class="p">]))</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual ASLTA&#39;</span><span class="p">)</span>

                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                            ASLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ASLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                            AOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, ACOLTA=</span><span class="si">{</span><span class="n">corrta</span><span class="si">}</span><span class="s2">,ACOLTAERR=</span><span class="si">{</span><span class="n">errta</span><span class="si">}</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">                                            ASLCP=</span><span class="si">{</span><span class="n">slcp</span><span class="si">}</span><span class="s2">, ASLCPERR=</span><span class="si">{</span><span class="n">slcperr</span><span class="si">}</span><span class="s2">, STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">, STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                                    <span class="k">elif</span> <span class="s2">&quot;BSLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="c1"># recalculate tot flux</span>
                                        <span class="n">hpnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BNLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">errHpnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BNLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">onTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BOLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">errOnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BOLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">pss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BLCPPSS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">errpss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BLCPPSSERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="n">pc</span><span class="p">,</span><span class="n">corrta</span><span class="p">,</span><span class="n">errta</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hpnTa</span><span class="p">,</span> <span class="n">errHpnTa</span><span class="p">,</span> <span class="n">onTa</span><span class="p">,</span> <span class="n">errOnTa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                        <span class="n">slcp</span><span class="o">=</span><span class="n">corrta</span><span class="o">*</span><span class="n">pss</span>
                                        <span class="n">slcperr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">corrta</span><span class="o">/</span><span class="n">errta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">pss</span><span class="o">/</span><span class="n">errpss</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">slcp</span>

                                        <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">aslcp</span><span class="p">,</span><span class="n">slcp</span><span class="p">,</span><span class="n">asrcp</span><span class="p">,</span><span class="n">bsrcp</span><span class="p">]</span>
                                        <span class="n">er</span><span class="o">=</span><span class="p">[</span><span class="n">aslcperr</span><span class="p">,</span><span class="n">slcperr</span><span class="p">,</span><span class="n">asrcperr</span><span class="p">,</span><span class="n">bsrcperr</span><span class="p">]</span>
                                        <span class="n">ss</span><span class="o">=</span><span class="p">[]</span>
                                        <span class="n">se</span><span class="o">=</span><span class="p">[]</span>
                                       
                                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
                                            <span class="k">if</span> <span class="s2">&quot;nan&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                <span class="k">pass</span>
                                            <span class="k">else</span><span class="p">:</span>
                                                <span class="n">ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                <span class="n">se</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">er</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                
                                        <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
                                        <span class="n">stoterr</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">se</span><span class="p">]))</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual ASLTA&#39;</span><span class="p">)</span>

                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                            BSLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, BSLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                            BOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, BCOLTA=</span><span class="si">{</span><span class="n">corrta</span><span class="si">}</span><span class="s2">,BCOLTAERR=</span><span class="si">{</span><span class="n">errta</span><span class="si">}</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">                                            BSLCP=</span><span class="si">{</span><span class="n">slcp</span><span class="si">}</span><span class="s2">, BSLCPERR=</span><span class="si">{</span><span class="n">slcperr</span><span class="si">}</span><span class="s2">, STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">, STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>

                            <span class="k">elif</span> <span class="s2">&quot;ANLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span> <span class="ow">or</span> <span class="s2">&quot;BNLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                    
                                    <span class="k">if</span> <span class="s2">&quot;ANLTA&quot;</span> <span class="ow">in</span> <span class="n">ycol</span><span class="p">:</span>
                                        <span class="c1"># recalculate tot flux</span>
                                        <span class="n">hpsTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">errHpsTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ASLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">onTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AOLTA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">errOnTa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AOLTAERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">pss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ALCPPSS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">errpss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ALCPPSSERR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                                        <span class="n">pc</span><span class="p">,</span><span class="n">corrta</span><span class="p">,</span><span class="n">errta</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">calc_pc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hpsTa</span><span class="p">,</span> <span class="n">errHpsTa</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">onTa</span><span class="p">,</span> <span class="n">errOnTa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

                                        <span class="n">slcp</span><span class="o">=</span><span class="n">corrta</span><span class="o">*</span><span class="n">pss</span>
                                        <span class="n">slcperr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">corrta</span><span class="o">/</span><span class="n">errta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">pss</span><span class="o">/</span><span class="n">errpss</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">slcp</span>

                                        <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">slcp</span><span class="p">,</span><span class="n">bslcp</span><span class="p">,</span><span class="n">asrcp</span><span class="p">,</span><span class="n">bsrcp</span><span class="p">]</span>
                                        <span class="n">er</span><span class="o">=</span><span class="p">[</span><span class="n">slcperr</span><span class="p">,</span><span class="n">bslcperr</span><span class="p">,</span><span class="n">asrcperr</span><span class="p">,</span><span class="n">bsrcperr</span><span class="p">]</span>
                                        <span class="n">ss</span><span class="o">=</span><span class="p">[]</span>
                                        <span class="n">se</span><span class="o">=</span><span class="p">[]</span>
                                       
                                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
                                            <span class="k">if</span> <span class="s2">&quot;nan&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                                                <span class="k">pass</span>
                                            <span class="k">else</span><span class="p">:</span>
                                                <span class="n">ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                <span class="n">se</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">er</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                
                                        <span class="n">stot</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
                                        <span class="n">stoterr</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">se</span><span class="p">]))</span>

                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updating dual ANLTA&#39;</span><span class="p">)</span>

                                        <span class="n">stmt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">tablename</span><span class="si">}</span><span class="s2"> SET </span><span class="si">{</span><span class="n">ycol</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, OLFLAG=200, </span><span class="se">\</span>
<span class="s2">                                            ANLTA=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, ANLTAERR=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, </span><span class="se">\</span>
<span class="s2">                                            AOLPC=</span><span class="si">{</span><span class="n">pc</span><span class="si">}</span><span class="s2">, ACOLTA=</span><span class="si">{</span><span class="n">corrta</span><span class="si">}</span><span class="s2">,ACOLTAERR=</span><span class="si">{</span><span class="n">errta</span><span class="si">}</span><span class="s2">, </span><span class="se">\</span>
<span class="s2">                                            ASLCP=</span><span class="si">{</span><span class="n">slcp</span><span class="si">}</span><span class="s2">, ASLCPERR=</span><span class="si">{</span><span class="n">slcperr</span><span class="si">}</span><span class="s2">, STOT=</span><span class="si">{</span><span class="n">stot</span><span class="si">}</span><span class="s2">, STOTERR=</span><span class="si">{</span><span class="n">stoterr</span><span class="si">}</span><span class="s2">  WHERE FILENAME = &#39;</span><span class="si">{</span><span class="n">FN</span><span class="si">}</span><span class="s2">&#39; ;&quot;</span>
                                    
                                    <span class="c1"># elif &quot;BNLTA&quot; in ycol:</span>
                                    <span class="c1">#     onta=self.df[&#39;BOLTA&#39;].iloc[i]</span>
                                    <span class="c1">#     ontaerr=self.df[&#39;BOLTAERR&#39;].iloc[i]</span>
                                    <span class="c1">#     sta=self.df[&#39;BSLTA&#39;].iloc[i]</span>
                                    <span class="c1">#     staerr=self.df[&#39;BSLTAERR&#39;].iloc[i]</span>

                                    <span class="c1">#     print(&#39;updating dual BNLTA&#39;)</span>
                                    <span class="c1">#     pc,ota,otaerr= cp.calc_pc(0,sta,staerr, 0.0,0.0,onta,ontaerr,self.df)</span>
                                    <span class="c1">#     stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, OLFLAG=200, BOLPC={pc}, BCOLTA={ota},BCOLTAERR={otaerr}  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                                    <span class="c1"># print(stmt)</span>

                            <span class="c1"># elif &quot;AOLTA&quot; in ycol or &quot;BOLTA&quot; in ycol:</span>
                                    
                            <span class="c1">#         if &quot;AOLTA&quot; in ycol:</span>

                            <span class="c1">#             print(&#39;updating dual AOLTA&#39;)</span>
                            <span class="c1">#             pc,ota,otaerr = np.nan,np.nan,np.nan</span>
                            <span class="c1">#             stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, OLFLAG=200, AOLPC={pc}, ACOLTA={ota},ACOLTAERR={otaerr}  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                            <span class="c1">#         elif &quot;BOLTA&quot; in ycol:</span>

                            <span class="c1">#             print(&#39;updating dual BOLTA&#39;)</span>
                            <span class="c1">#             pc,ota,otaerr=np.nan,np.nan,np.nan</span>
                            <span class="c1">#             stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, OLFLAG=200, BOLPC={pc}, BCOLTA={ota},BCOLTAERR={otaerr}  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                            <span class="c1">#         print(stmt)</span>

                            <span class="c1"># elif &quot;ASRTA&quot; in ycol or &quot;BSRTA&quot; in ycol:</span>
                                    
                            <span class="c1">#         if &quot;ASRTA&quot; in ycol:</span>
                            <span class="c1">#             onta=self.df[&#39;AORTA&#39;].iloc[i]</span>
                            <span class="c1">#             ontaerr=self.df[&#39;AORTAERR&#39;].iloc[i]</span>
                            <span class="c1">#             nta=self.df[&#39;ANRTA&#39;].iloc[i]</span>
                            <span class="c1">#             ntaerr=self.df[&#39;ANRTAERR&#39;].iloc[i]</span>

                            <span class="c1">#             print(&#39;updating dual ASRTA&#39;)</span>
                            <span class="c1">#             pc,ota,otaerr = cp.calc_pc(0,0.0,0.0, nta, ntaerr, onta, ontaerr,self.df)</span>
                            <span class="c1">#             stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, ORFLAG=200,  AORPC={pc},ACORTA={ota},ACORTAERR={otaerr}  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                            <span class="c1">#         elif &quot;BSRTA&quot; in ycol:</span>
                            <span class="c1">#             onta=self.df[&#39;BORTA&#39;].iloc[i]</span>
                            <span class="c1">#             ontaerr=self.df[&#39;BORTAERR&#39;].iloc[i]</span>
                            <span class="c1">#             nta=self.df[&#39;BNRTA&#39;].iloc[i]</span>
                            <span class="c1">#             ntaerr=self.df[&#39;BNRTAERR&#39;].iloc[i]</span>

                            <span class="c1">#             print(&#39;updating dual BSRTA&#39;)</span>
                            <span class="c1">#             pc,ota,otaerr = cp.calc_pc(0,0.0,0.0, nta,ntaerr,onta,ontaerr,self.df)</span>
                            <span class="c1">#             stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, ORFLAG=200, BORPC={pc}, BCORTA={ota},BCORTAERR={otaerr}  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                            <span class="c1">#         print(stmt)</span>

                            <span class="c1"># elif &quot;ANRTA&quot; in ycol or &quot;BNRTA&quot; in ycol:</span>
                                    
                            <span class="c1">#         if &quot;ANRTA&quot; in ycol:</span>
                            <span class="c1">#             onta=self.df[&#39;AORTA&#39;].iloc[i]</span>
                            <span class="c1">#             ontaerr=self.df[&#39;AORTAERR&#39;].iloc[i]</span>
                            <span class="c1">#             sta=self.df[&#39;ASRTA&#39;].iloc[i]</span>
                            <span class="c1">#             staerr=self.df[&#39;ASRTAERR&#39;].iloc[i]</span>

                            <span class="c1">#             print(&#39;updating dual ANRTA&#39;)</span>
                            <span class="c1">#             pc,ota,otaerr = cp.calc_pc(0,sta,staerr, 0.0,0.0,onta,ontaerr,self.df)</span>
                            <span class="c1">#             stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, ORFLAG=200, AORPC={pc},ACORTA={ota},ACORTAERR={otaerr}  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                            <span class="c1">#         elif &quot;BNRTA&quot; in ycol:</span>
                            <span class="c1">#             onta=self.df[&#39;BORTA&#39;].iloc[i]</span>
                            <span class="c1">#             ontaerr=self.df[&#39;BORTAERR&#39;].iloc[i]</span>
                            <span class="c1">#             sta=self.df[&#39;BSRTA&#39;].iloc[i]</span>
                            <span class="c1">#             staerr=self.df[&#39;BSRTAERR&#39;].iloc[i]</span>

                            <span class="c1">#             print(&#39;updating dual BNRTA&#39;)</span>
                            <span class="c1">#             pc,ota,otaerr = cp.calc_pc(0,sta,staerr, 0.0,0.0,onta,ontaerr,self.df)</span>
                            <span class="c1">#             stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, ORFLAG=200, BORPC={pc}, BCORTA={ota},BCORTAERR={otaerr}  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                            <span class="c1">#         print(stmt)</span>

                            <span class="c1"># elif &quot;AORTA&quot; in ycol or &quot;BORTA&quot; in ycol:</span>
                                    
                            <span class="c1">#         if &quot;AORTA&quot; in ycol:</span>

                            <span class="c1">#             print(&#39;updating dual AORTA&#39;)</span>
                            <span class="c1">#             pc,ota,otaerr = np.nan, np.nan, np.nan</span>
                            <span class="c1">#             stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, ORFLAG=200,  AORPC={pc}, ACORTA={ota},ACORTAERR={otaerr}  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                            <span class="c1">#         elif &quot;BORTA&quot; in ycol:</span>

                            <span class="c1">#             print(&#39;updating dual BORTA&#39;)</span>
                            <span class="c1">#             pc,ota,otaerr =np.nan, np.nan, np.nan</span>
                            <span class="c1">#             stmt = f&quot;UPDATE {tablename} SET {ycol}=&#39;{np.nan}&#39;, ORFLAG=200,  BORPC={pc}, BCORTA={ota},BCORTAERR={otaerr}  WHERE FILENAME = &#39;{FN}&#39; ;&quot;</span>

                            <span class="c1">#         </span>

                            <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                            <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                            <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                            <span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;updated CALDB&quot;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">)</span>
                    
                            <span class="c1"># complete the code here</span>
                            <span class="c1"># for the rest of them.</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After deleting: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">yCol</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_cols_df</span><span class="p">()</span></div>


<div class="viewcode-block" id="Main.reset_timeseries">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_timeseries">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_timeseries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orig_df</span>

        <span class="c1"># plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_figure</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_cols</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="Main.refresh_db">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.refresh_db">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;refresh the database entries. Check for updates.&quot;&quot;&quot;</span>
        
        <span class="c1"># open the database and get tables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="n">dbPath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
        <span class="c1"># self.db.close_db()</span>

        <span class="c1"># populate columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFile</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate_cols</span><span class="p">()</span>

        <span class="c1"># update plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_cols</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">close_db</span><span class="p">()</span></div>


<div class="viewcode-block" id="Main.save_time_db">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.save_time_db">[docs]</a>
    <span class="k">def</span> <span class="nf">save_time_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filen</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the analysis results of the time series to a csv file&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">filen</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analysis_of_table_</span><span class="si">{</span><span class="n">filen</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;saved results to </span><span class="si">{</span><span class="n">filen</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;Analysis_results.csv&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;saved results to Analysis_results.csv&#39;</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="Main.plot_cols_df">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.plot_cols_df">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_cols_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Plot database columns. &quot;&quot;&quot;</span>

        <span class="c1"># get col names</span>
        <span class="n">xCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsX</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">yCol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsY</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">xCol</span> <span class="o">==</span> <span class="n">yCol</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">You cannot plot the same column on X and Y</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">yErr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_ui</span><span class="o">.</span><span class="n">comboBoxColsYerr</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plotting </span><span class="si">{</span><span class="n">xCol</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">yCol</span><span class="si">}</span><span class="s2"> in table </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span><span class="c1">#.apply(self.f)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yErr</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yErr</span><span class="p">]</span><span class="c1">#.apply(self.f)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_fig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">],</span><span class="n">xCol</span><span class="p">,</span><span class="n">yCol</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yErr</span><span class="p">])</span> <span class="c1">#,title=f&quot;Plot of {self.df[&#39;SOURCEDIR&#39;]} obs. {self.df[&#39;FILENAME&#39;][:8]}&quot;)#,data=self.)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_fig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">xCol</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">yCol</span><span class="p">],</span><span class="n">xCol</span><span class="p">,</span><span class="n">yCol</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span><span class="c1">#,title=f&quot;Plot of {self.df[&#39;SOURCEDIR&#39;]} obs. {self.df[&#39;FILENAME&#39;][:8]}&quot;)#,data=self.)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

            
    <span class="c1"># PLOTVIEWER OPERATIONS</span>
<div class="viewcode-block" id="Main.open_db_path">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.open_db_path">[docs]</a>
    <span class="k">def</span> <span class="nf">open_db_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Open a database</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Opening DB&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_file_name_dialog</span><span class="p">(</span><span class="s2">&quot;*.db&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;You need to select a file to open&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Please select a file&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># free all else</span>
            <span class="n">free</span><span class="o">=</span><span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnDelete</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">free</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnRefreshPlotList</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">free</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">btnShow</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">free</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">free</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">free</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxOptions</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">free</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxEnd</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">free</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxStart</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">free</span><span class="p">)</span>

            <span class="c1"># open db and get tables</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tables</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span><span class="p">)))))</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T2 :&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>     
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>      
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span></div>

 
<div class="viewcode-block" id="Main.on_combo_changed">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.on_combo_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">on_combo_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Changed obs. to: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>

        <span class="c1"># get data from db</span>
        <span class="c1"># check folder name against table name</span>
        <span class="n">folderName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="c1"># get column names from db and put them in combobox</span>
        <span class="n">colInd</span><span class="p">,</span> <span class="n">colNames</span><span class="p">,</span> <span class="n">colType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_all_table_coloumns</span><span class="p">(</span><span class="n">folderName</span><span class="p">)</span>

        <span class="n">plotCols</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">colNames</span><span class="p">:</span>
            <span class="c1">#or &#39;OBS&#39; in name </span>
            <span class="c1"># if &#39;OBSTIME&#39; in name or &#39;SOURCE&#39; in name or &#39;CUR&#39; in name or &#39;NOM&#39; in name or &#39;TUDE&#39; in name \</span>
            <span class="c1">#     or &#39;BW&#39; in name or &#39;FREQ&#39; in name or &#39;FILE&#39; in name or &#39;OBJ&#39; in name or &#39;id&#39; == name or \</span>
            <span class="c1">#         &#39;RAD&#39; in name or &#39;TYPE&#39; in name or &#39;PRO&#39; in name or &#39;TELE&#39; in name or &#39;UPGR&#39; in name \</span>
            <span class="c1">#             or &#39;INST&#39; in name or &#39;SCAN&#39; in name:</span>
                
            <span class="k">if</span> <span class="s1">&#39;id&#39;</span> <span class="ow">in</span> <span class="n">name</span>  <span class="ow">or</span> <span class="s1">&#39;LOGFREQ&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;CURDATETIME&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> \
                <span class="s1">&#39;FILE&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;OBSD&#39;</span> <span class="ow">in</span> <span class="n">name</span> \
                    <span class="ow">or</span> <span class="s1">&#39;MJD&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;OBS&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;OBJ&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;id&#39;</span> <span class="o">==</span> <span class="n">name</span> \
                        <span class="ow">or</span> <span class="s1">&#39;RAD&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;TYPE&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;PRO&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;TELE&#39;</span> <span class="ow">in</span>\
                              <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;UPGR&#39;</span> <span class="ow">in</span> <span class="n">name</span>  <span class="ow">or</span> <span class="s1">&#39;INST&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> \
                                <span class="s1">&#39;SCANDIR&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;SRC&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;COORDSYS&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;LONGITUD&#39;</span> <span class="ow">in</span> <span class="n">name</span> \
                                    <span class="ow">or</span> <span class="s1">&#39;LATITUDE&#39;</span> <span class="ow">in</span> <span class="n">name</span>  <span class="ow">or</span> <span class="s1">&#39;POINTING&#39;</span> <span class="ow">in</span> <span class="n">name</span> \
                                       <span class="ow">or</span> <span class="s1">&#39;DICHROIC&#39;</span> <span class="ow">in</span> <span class="n">name</span> \
                                            <span class="ow">or</span> <span class="s1">&#39;PHASECAL&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;HPBW&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;FNBW&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;SNBW&#39;</span> <span class="ow">in</span> <span class="n">name</span>\
                                                <span class="ow">or</span> <span class="s1">&#39;FRONTEND&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;BASE&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span> 
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plotCols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># self.plot_ui.comboBoxOptions.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxOptions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxOptions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxOptions</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">plotCols</span><span class="p">)</span>

        <span class="c1"># self.plot_ui.comboBoxFilter.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">])</span></div>


<div class="viewcode-block" id="Main.on_filter_changed">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.on_filter_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">on_filter_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;between&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="c1">#Add second filter</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_range_filter</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxFilter</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="c1"># remove second filter</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_range_filter</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxFilter</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.toggle_range_filter">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.toggle_range_filter">[docs]</a>
    <span class="k">def</span> <span class="nf">toggle_range_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">filter</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="nb">filter</span><span class="o">==</span><span class="s1">&#39;off&#39;</span><span class="p">:</span>
            <span class="n">toggle</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">elif</span> <span class="nb">filter</span><span class="o">==</span><span class="s2">&quot;on&quot;</span><span class="p">:</span>
            <span class="n">toggle</span><span class="o">=</span><span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">LblRangeFilter</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">toggle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">LblStart</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">toggle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">LblStop</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">toggle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">LblFormat</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">toggle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxEnd</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">toggle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxStart</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">toggle</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.add_items_to_combobox">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.add_items_to_combobox">[docs]</a>
    <span class="k">def</span> <span class="nf">add_items_to_combobox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh the list of folders containing plots to be displayed. &quot;&quot;&quot;</span>
        
        <span class="c1"># self.db.close_db()</span>

        <span class="c1"># open db and get tables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
        <span class="n">tables</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxOptions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxOptions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># self.plot_ui.comboBox.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.get_data_from_db">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.get_data_from_db">[docs]</a>
    <span class="k">def</span> <span class="nf">get_data_from_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folderName</span><span class="p">):</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
        <span class="n">tableNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span><span class="p">))</span>
        <span class="n">colInd</span><span class="p">,</span> <span class="n">colNames</span><span class="p">,</span> <span class="n">colType</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_all_table_coloumns</span><span class="p">(</span><span class="n">folderName</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_rows_of_cols</span><span class="p">(</span><span class="n">folderName</span><span class="p">,</span><span class="n">colNames</span><span class="p">)</span>
                        
        <span class="c1"># create dataframe</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">colNames</span><span class="p">)</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span> <span class="p">,</span><span class="n">db</span></div>

    
<div class="viewcode-block" id="Main.checkKeysFound">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.checkKeysFound">[docs]</a>
    <span class="k">def</span> <span class="nf">checkKeysFound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pol</span><span class="p">,</span><span class="n">option</span><span class="p">,</span><span class="n">img</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">images</span><span class="p">,</span><span class="n">keys</span><span class="p">):</span>
        
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}{</span><span class="n">pol</span><span class="si">}</span><span class="s1">TA&#39;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}{</span><span class="n">pol</span><span class="si">}</span><span class="s1">MID&#39;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> \
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}{</span><span class="n">pol</span><span class="si">}</span><span class="s1">S2N&#39;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}{</span><span class="n">pol</span><span class="si">}</span><span class="s1">FLAG&#39;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> \
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}{</span><span class="n">pol</span><span class="si">}</span><span class="s1">RMS&#39;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}{</span><span class="n">pol</span><span class="si">}</span><span class="s1">SLOPE&#39;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> \
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}{</span><span class="n">pol</span><span class="si">}</span><span class="s1">BRMS&#39;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">key</span><span class="o">==</span><span class="s1">&#39;S&#39;</span><span class="ow">and</span> <span class="sa">f</span><span class="s2">&quot;HPS_</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">CP&quot;</span> <span class="ow">in</span> <span class="n">img</span><span class="p">:</span>
                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">key</span><span class="o">==</span><span class="s1">&#39;N&#39;</span> <span class="ow">and</span> <span class="sa">f</span><span class="s2">&quot;HPN_</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">CP&quot;</span> <span class="ow">in</span> <span class="n">img</span><span class="p">:</span>
                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">key</span><span class="o">==</span><span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="sa">f</span><span class="s2">&quot;ON_</span><span class="si">{</span><span class="n">pol</span><span class="si">}</span><span class="s2">CP&quot;</span> <span class="ow">in</span> <span class="n">img</span><span class="p">:</span>
                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">images</span></div>

    
<div class="viewcode-block" id="Main.show_plot_browser">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.show_plot_browser">[docs]</a>
    <span class="k">def</span> <span class="nf">show_plot_browser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Open a webrowser containg the plots to be displayed. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Run checks first</span>
        <span class="n">option</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxOptions</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="nb">filter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">filter</span> <span class="o">!=</span><span class="s2">&quot;between&quot;</span><span class="p">:</span>

            <span class="c1"># Get params</span>
            <span class="n">txt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxFilter</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Showing plots where </span><span class="si">{</span><span class="n">option</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">filter</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">txt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">txt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">option</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Need to choose an option&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">filter</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please make a valid selection&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">txt</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                            <span class="c1"># show everything</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no value added, should show all pics, but wont&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Get data from the database</span>
                            <span class="c1"># check folder name against table name</span>
                            <span class="n">folderName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                            
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Folder name: &#39;</span><span class="p">,</span><span class="n">folderName</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Path to file: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span><span class="p">)</span>

                            <span class="c1"># get data from database</span>
                            <span class="n">df</span><span class="p">,</span><span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data_from_db</span><span class="p">(</span><span class="n">folderName</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;OBSDATE&#39;</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Showing overall stats&#39;</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;min: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;max: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;std: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1"># print(df[option].apply(fx))</span>
                                <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="c1">#.apply(fx)</span>
                                <span class="c1"># df[option]=df[option].apply(fx)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Showing basic stats for selection&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DATE start: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DATE end: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MJD start: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;MJD&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MJD end: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;MJD&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;min: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;max: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;std: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;3sigma upper limit: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;3sigma lower limit: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="k">except</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Showing overall stats&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DATE start: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DATE end: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MJD start: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;MJD&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MJD end: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;MJD&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;min: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;max: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;std: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                            <span class="c1"># sys.exit()</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">txt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
                            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                                <span class="k">pass</span>

                            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
                                    
                                    <span class="n">txt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
                                    <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                                    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="c1"># print(len(ndf))</span>

                                    <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="c1"># print(len(ndf))</span>

                                    <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="c1"># print(len(ndf))</span>

                                    <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="c1"># print(len(ndf))</span>

                                    <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;=&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">==</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="c1"># print(len(ndf))</span>
                            
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">ndf</span><span class="o">=</span><span class="n">df</span>

                                    <span class="c1">#</span>
                                    <span class="c1"># print(len(df),len(ndf),option,txt)</span>

                                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                                        <span class="c1"># Show only what is requested</span>

                                        

                                        <span class="c1">#print(ndf[&#39;FILENAME&#39;])</span>
                                        <span class="n">ndf</span><span class="o">=</span><span class="n">ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">)</span>
                                        <span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;plot_tag&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[:</span><span class="mi">18</span><span class="p">])</span>

                                        <span class="n">plots</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;plot_tag&#39;</span><span class="p">])</span>

                                        <span class="c1"># print(plots)</span>

                                        <span class="c1"># sys.exit()</span>
                                        
                                        <span class="c1"># print stats</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Basic stats ---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Min: &quot;</span><span class="p">,</span> <span class="n">ndf</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max: &quot;</span><span class="p">,</span> <span class="n">ndf</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean: &quot;</span><span class="p">,</span> <span class="n">ndf</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Median: &quot;</span><span class="p">,</span> <span class="n">ndf</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                                        <span class="c1"># get plot folder and plot to browser</span>
                                        <span class="n">imgDir</span> <span class="o">=</span> <span class="s2">&quot;plots/&quot;</span>
                                        <span class="n">ls</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">imgDir</span><span class="p">)</span>
                                     
                                        <span class="c1"># fln=(folderName.split(&quot;_&quot;)[0]).upper()</span>
                                        <span class="c1"># print(sorted(ls))#,fln)</span>
                                        <span class="c1"># sys.exit()</span>
                                       
                                        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;Plotting folder &quot;</span><span class="o">+</span><span class="n">folderName</span><span class="p">)</span>

                                        <span class="k">try</span><span class="p">:</span>
                                            <span class="n">src</span><span class="o">=</span><span class="p">(</span><span class="n">ndf</span><span class="p">[</span><span class="s2">&quot;OBJECT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="c1">#.replace(&quot; &quot;,&quot;&quot;)</span>
                                        <span class="k">except</span><span class="p">:</span>
                                            <span class="n">src</span><span class="o">=</span><span class="p">(</span><span class="n">ndf</span><span class="p">[</span><span class="s2">&quot;OBJECT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1">#.replace(&quot; &quot;,&quot;&quot;)</span>

                                        <span class="c1"># src=s#src.replace(&quot;-&quot;,&quot;_&quot;)</span>
                                        <span class="k">if</span> <span class="n">folderName</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
                                            <span class="n">folderName</span><span class="o">=</span><span class="n">folderName</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                                
                                        <span class="n">fp</span><span class="o">=</span><span class="n">folderName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>

                                        <span class="k">try</span><span class="p">:</span>
                                            <span class="n">freq</span><span class="o">=</span><span class="nb">int</span><span class="p">((</span><span class="n">ndf</span><span class="p">[</span><span class="s2">&quot;CENTFREQ&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                                        <span class="k">except</span><span class="p">:</span>
                                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Struggling to find frequency - raise an issue on github &#39;</span><span class="p">)</span>
                                            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

                                        <span class="c1"># if src !=fp[0]: </span>
                                        <span class="c1">#     imgPath=f&#39;plots/{src}/{src}_{fp[1]}/&#39;</span>
                                        <span class="c1"># else:</span>
                                        <span class="n">imgPath</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;plots/</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1">/&#39;</span>
                                        
                                        <span class="c1"># imgPath=imgPath.strip()</span>
                                        <span class="n">imgPath</span><span class="o">=</span><span class="n">imgPath</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                                        <span class="n">imgPath</span><span class="o">=</span><span class="n">imgPath</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

                                        <span class="c1"># print(imgPath)</span>
                                        <span class="c1"># sys.exit()</span>

                                        <span class="c1"># imgPath=imgPath.replace(&#39;m&#39;,&#39;-&#39;)</span>
                                        <span class="n">imageNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">imgPath</span><span class="p">))</span>
                                        <span class="n">images</span><span class="o">=</span><span class="p">[]</span>

                                        <span class="k">if</span> <span class="s2">&quot;.DS_Store&quot;</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">:</span>
                                            <span class="n">imageNames</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;.DS_Store&quot;</span><span class="p">)</span>

                                        <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">]</span> <span class="c1"># south, north, on</span>

                                        <span class="c1"># # get images for current point</span>
                                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plots</span><span class="p">)):</span>

                                            <span class="c1"># print(&#39;&gt;&gt;&#39;,imgPath,imageNames[i])</span>
                                            <span class="c1"># found=0</span>

                                            <span class="c1"># TODO: FIX this mess, i only want to see relvant data</span>
                                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imageNames</span><span class="p">)):</span>
                                                <span class="k">if</span> <span class="n">plots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span> <span class="c1">#[:18]:</span>
                                                    <span class="c1"># print(imageNames[j],plots[i])</span>
                                                    <span class="n">path</span><span class="o">=</span><span class="n">imgPath</span><span class="o">+</span><span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                                                    <span class="n">images1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">checkKeysFound</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">option</span><span class="p">,</span><span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">path</span><span class="p">,</span><span class="n">images</span><span class="p">,</span><span class="n">keys</span><span class="p">)</span>
                                                    <span class="n">images2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">checkKeysFound</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="n">option</span><span class="p">,</span><span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">path</span><span class="p">,</span><span class="n">images</span><span class="p">,</span><span class="n">keys</span><span class="p">)</span>
                                                    <span class="c1"># checkKeysFound(pol,option,img,path,images,keys)</span>
                                                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">images1</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">images2</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                                                        <span class="c1"># no matches found</span>
                                                        <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imgPath</span><span class="o">+</span><span class="n">imageNames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                                    <span class="k">else</span><span class="p">:</span>
                                                        <span class="n">images</span> <span class="o">=</span> <span class="n">images</span> <span class="o">+</span> <span class="n">images1</span><span class="o">+</span><span class="n">images2</span>



                                                        <span class="c1">#         images.append(imgPath+imageNames[j])</span>

                                                    <span class="c1"># if &quot;SL&quot; in option and &quot;HPS_LCP&quot; in imageNames[j]:</span>
                                                    <span class="c1">#         #print(imageNames[i],plots[j])</span>
                                                    <span class="c1">#     images.append(imgPath+imageNames[j])</span>
                                                    <span class="c1"># elif &quot;SR&quot; in option and &quot;HPS_RCP&quot; in imageNames[j]:</span>
                                                    <span class="c1">#         #print(imageNames[i],plots[j])</span>
                                                    <span class="c1">#     images.append(imgPath+imageNames[j])</span>
                                                    <span class="c1"># elif &quot;NL&quot; in option and &quot;HPN_LCP&quot; in imageNames[j]:</span>
                                                    <span class="c1">#         #print(imageNames[i],plots[j])</span>
                                                    <span class="c1">#     images.append(imgPath+imageNames[j])</span>
                                                    <span class="c1"># elif &quot;NR&quot; in option and &quot;HPN_RCP&quot; in imageNames[j]:</span>
                                                    <span class="c1">#         #print(imageNames[i],plots[j])</span>
                                                    <span class="c1">#     images.append(imgPath+imageNames[j])</span>
                                                    <span class="c1"># elif  &quot;OL&quot; in option and &quot;ON_LCP&quot; in imageNames[j]:</span>
                                                    <span class="c1">#         #print(imageNames[i],plots[j])</span>
                                                    <span class="c1">#     images.append(imgPath+imageNames[j])</span>
                                                    <span class="c1"># elif &quot;OR&quot; in option and &quot;ON_RCP&quot; in imageNames[j]:</span>
                                                    <span class="c1">#         #print(imageNames[i],plots[j])</span>
                                                    <span class="c1">#     images.append(imgPath+imageNames[j])</span>
                                                    <span class="c1"># else:</span>
                                                    <span class="c1">#     images.append(imgPath+imageNames[i])</span>
                                                
                                        <span class="nb">print</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
                                        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                                        <span class="n">htmlstart</span> <span class="o">=</span> <span class="s1">&#39;&lt;html&gt; &lt;head&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;meta charset = &quot;utf-8&quot; &gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;meta name = &quot;viewport&quot; content = &quot;width=device-width, initial-scale=1&quot; &gt; &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; integrity=&quot;sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl&quot; crossorigin=&quot;anonymous&quot;&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js&quot; integrity=&quot;sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt; </span><span class="se">\</span>
<span class="s1">                                                    &lt;style&gt; </span><span class="se">\</span>
<span class="s1">                                                        img {border: 3px solid  # ddd; /* Gray border */border-radius: 5px;  /* Rounded border */padding: 5px; /* Some padding */width: 400px; /* Set a small width */}/* Add a hover effect (blue shadow) */</span><span class="se">\</span>
<span class="s1">                                                        img:hover {box-shadow: 0 0 2px 1px rgba(0, 140, 186, 0.5);}</span><span class="se">\</span>
<span class="s1">                                                    &lt;/style&gt; </span><span class="se">\</span>
<span class="s1">                                                &lt;title&gt;Driftscan plots&lt;/title&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;/head&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;div class=&quot;container-fluid&quot;&gt; </span><span class="se">\</span>
<span class="s1">                                                    &lt;div class=&quot;row&quot;&gt;</span><span class="se">\</span>
<span class="s1">                                                        &lt;hr&gt;</span><span class="se">\</span>
<span class="s1">                                                        &lt;h1&gt; Plotting folder &#39;</span><span class="o">+</span><span class="n">folderName</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&lt;/h1&gt; </span><span class="se">\</span>
<span class="s1">                                                        &lt;p&gt;&#39;</span>
                                                    
                                        <span class="n">htmlmid</span><span class="o">=</span><span class="s1">&#39;&#39;</span>

                                        <span class="n">imageOptions</span><span class="o">=</span><span class="p">[]</span>
                                        

                                        <span class="k">if</span> <span class="s2">&quot;OL&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="s2">&quot;SL&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="s2">&quot;NL&quot;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                            <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
                                                <span class="k">if</span> <span class="s2">&quot;LCP&quot;</span> <span class="ow">in</span> <span class="n">img</span><span class="p">:</span>
                                                    <span class="n">imageOptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
                                            <span class="n">images</span><span class="o">=</span><span class="n">imageOptions</span>

                                        <span class="k">elif</span> <span class="s2">&quot;OR&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="s2">&quot;SR&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="s2">&quot;NR&quot;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                            <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
                                                <span class="k">if</span> <span class="s2">&quot;RCP&quot;</span> <span class="ow">in</span> <span class="n">img</span><span class="p">:</span>
                                                    <span class="n">imageOptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
                                            <span class="n">images</span><span class="o">=</span><span class="n">imageOptions</span>

                                        <span class="k">else</span><span class="p">:</span>
                                            <span class="n">images</span><span class="o">=</span><span class="n">images</span>

                                        <span class="n">images</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">images</span><span class="p">))</span>
                                        <span class="n">images</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>

                                        <span class="nb">print</span><span class="p">()</span>
                                        <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
                                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Showing: </span><span class="si">{</span><span class="n">img</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                                        <span class="c1"># sys.exit()</span>
                                        <span class="c1"># add images to html page</span>
                                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)):</span>
                                            <span class="c1">#print(images.split(&quot;/&quot;)[1],images.split(&quot;/&quot;)[2])</span>
                                            <span class="n">pathtoimg</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                            <span class="n">img</span> <span class="o">=</span> <span class="s1">&#39;&lt;small class=&quot;card-title&quot;&gt;&#39;</span><span class="o">+</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;&lt;/small&gt;&lt;br/&gt;</span><span class="se">\</span>
<span class="s1">                                                    &lt;a target=&quot;_blank&quot; href=&quot;&#39;</span><span class="o">+</span><span class="n">pathtoimg</span> <span class="o">+</span> \
                                                    <span class="s1">&#39;&quot;&gt;&lt;img src=&quot;&#39;</span><span class="o">+</span><span class="n">pathtoimg</span> <span class="o">+</span> \
                                                    <span class="s1">&#39;&quot; class=&quot;card-img-top&quot; alt=&quot;image goes here&quot;&gt;&lt;/a&gt;&#39;</span>
                                            <span class="n">imglink</span> <span class="o">=</span><span class="s1">&#39;&lt;div class = &quot;card&quot; style = &quot;width: 13rem;&quot; &gt;</span><span class="se">\</span>
<span class="s1">                                                        &#39;</span><span class="o">+</span><span class="n">img</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">                                                            &lt;/div&gt;&#39;</span>
                                            <span class="n">htmlmid</span><span class="o">=</span><span class="n">htmlmid</span><span class="o">+</span><span class="n">imglink</span>

                                        <span class="n">htmlmid</span><span class="o">=</span><span class="n">htmlmid</span><span class="o">+</span><span class="s1">&#39;&lt;/p&gt;&lt;/div&gt;&#39;</span>
                                        <span class="n">htmlend</span> <span class="o">=</span> <span class="s1">&#39;&lt;/div&gt;&lt;/html&gt;&#39;</span>
                                        <span class="n">html</span> <span class="o">=</span> <span class="n">htmlstart</span><span class="o">+</span><span class="n">htmlmid</span><span class="o">+</span><span class="n">htmlend</span>

                                        <span class="c1"># create the html file</span>
                                        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;temp.html&#39;</span><span class="p">)</span>
                                        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span> <span class="o">+</span> <span class="n">path</span>

                                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
                                        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;html&gt; &lt;head&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;meta charset = &quot;utf-8&quot; &gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;meta name = &quot;viewport&quot; content = &quot;width=device-width, initial-scale=1&quot; &gt; &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; integrity=&quot;sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl&quot; crossorigin=&quot;anonymous&quot;&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js&quot; integrity=&quot;sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt; &lt;style&gt; img {border: 2px solid  # ddd; /* Gray border */border-radius: 4px;  /* Rounded border */padding: 5px; /* Some padding */width: 400px; /* Set a small width */}/* Add a hover effect (blue shadow) */img:hover {box-shadow: 0 0 2px 1px rgba(0, 140, 186, 0.5);}&lt;/style&gt; </span><span class="se">\</span>
<span class="s1">                                                &lt;title&gt;Plots&lt;/title&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;/head&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;div class=&quot;container-fluid&quot;&gt; </span><span class="se">\</span>
<span class="s1">                                                    &lt;div class=&quot;row&quot;&gt;</span><span class="se">\</span>
<span class="s1">                                                        &lt;hr&gt;</span><span class="se">\</span>
<span class="s1">                                                            &lt;h1&gt; Plotting folder &#39;</span><span class="o">+</span><span class="n">folderName</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&#39;&#39;&lt;/h1&gt; </span>
<span class="s1">                                                            &lt;p&gt; No data to show&lt;/p&gt;</span>
<span class="s1">                                                    &lt;/div&gt;</span>
<span class="s1">                                                &lt;/div&gt;</span>
<span class="s1">                                                &lt;/html&gt;</span>
<span class="s1">                                        &#39;&#39;&#39;</span>
                                        <span class="c1"># create the html file</span>
                                        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;temp.html&#39;</span><span class="p">)</span>
                                        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span> <span class="o">+</span> <span class="n">path</span>

                                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
                                        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
                                        
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data to show&quot;</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>

                                <span class="c1"># if txt==&quot;OBSDATE&quot;:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">txt</span><span class="si">}</span><span class="s2"> filter not implemented yet</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>                  
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Invalid entry for filter&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span><span class="s2">&quot;between&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Filter by: &quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Key: &#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
            <span class="c1"># get params</span>
            <span class="n">text1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxStart</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">text2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxEnd</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Values: </span><span class="si">{</span><span class="n">text1</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">text2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">option</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Need to choose an option&quot;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">filter</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plotting everything&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">text1</span><span class="o">==</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">text2</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="c1"># show everything</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no value added, showing all images&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># run filter</span>
                        <span class="c1">#print(&quot;All checked&quot;)</span>

                        <span class="c1"># get data from db</span>
                        <span class="c1"># check folder name against table name</span>
                        <span class="n">plotFolderName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                        <span class="n">folderName</span><span class="o">=</span><span class="n">plotFolderName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>

                        <span class="nb">print</span><span class="p">(</span><span class="n">folderName</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">folderName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">folderName</span><span class="p">,</span> <span class="s2">&quot; found&quot;</span><span class="p">)</span>
                            <span class="c1">#target=folderName</span>
                            <span class="n">db</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

                            <span class="c1"># get column names from db and put them in combobox</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">colInd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">colName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">colType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_all_table_coloumns</span><span class="p">(</span><span class="n">folderName</span><span class="p">)</span>

                            <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_rows</span><span class="p">(</span><span class="n">folderName</span><span class="p">)</span>

                            <span class="c1"># create dataframe</span>
                            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colName</span><span class="p">)</span>
                            <span class="c1"># df = df[(df[&#39;OBSDATE&#39;]&gt;=&quot;2008-01-01&quot;) &amp; (df[&#39;OBSDATE&#39;]&lt;=&quot;2018-12-31&quot;)]</span>
       

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">txt1</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">text1</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Only integers or floats accepted</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="n">txt1</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">txt2</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">text2</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Only integers or floats accepted</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="n">txt2</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;start: </span><span class="si">{</span><span class="n">txt1</span><span class="si">}</span><span class="s1">, end: </span><span class="si">{</span><span class="n">txt2</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;start: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">txt1</span><span class="p">)</span><span class="si">}</span><span class="s1">, end: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">txt2</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;start: </span><span class="si">{</span><span class="n">text1</span><span class="si">}</span><span class="s1">, end: </span><span class="si">{</span><span class="n">text2</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

                            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt1</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt2</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
                               
                                <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                                <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">txt1</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">txt2</span><span class="p">)]</span>
                                <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">))</span>

                            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt1</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt2</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
                               
                                <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                                <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">txt2</span><span class="p">)]</span>
                                <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">))</span>

                            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt1</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt2</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
                               
                                <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                                <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">txt1</span><span class="p">)]</span>
                                <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">))</span>

                            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt1</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt2</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;OBSDATE&#39;</span><span class="p">:</span>
                                    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;OBSDATE&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
                                    <span class="c1"># T2=datetime.strptime(text2, &#39;%Y-%m-%d&#39;)</span>
                                    <span class="c1"># print(T2)</span>

                                    <span class="c1"># print(txt1)</span>
                                    <span class="k">if</span> <span class="n">text1</span><span class="o">==</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">text2</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                                        <span class="k">try</span><span class="p">:</span>
                                            <span class="n">T2</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">text2</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                                        <span class="k">except</span><span class="p">:</span>
                                            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date format, please use &quot;yyyy-mm-dd&quot;&#39;</span><span class="p">)</span>
                                            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                                        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T2</span><span class="p">]</span>

                                    <span class="k">elif</span> <span class="n">text1</span><span class="o">!=</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">text2</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span> 
                                        <span class="k">try</span><span class="p">:</span>
                                            <span class="n">T1</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">text1</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                                        <span class="k">except</span><span class="p">:</span>
                                            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date format, please use &quot;yyyy-mm-dd&quot;&#39;</span><span class="p">)</span>
                                            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                                        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">T1</span><span class="p">]</span>

                                    <span class="k">elif</span> <span class="n">text1</span><span class="o">!=</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">text2</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                                        <span class="k">try</span><span class="p">:</span>
                                            <span class="n">T1</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">text1</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                                        <span class="k">except</span><span class="p">:</span>
                                            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date format, please use &quot;yyyy-mm-dd&quot;&#39;</span><span class="p">)</span>
                                            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                                        <span class="k">try</span><span class="p">:</span>
                                            <span class="n">T2</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">text2</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                                        <span class="k">except</span><span class="p">:</span>
                                            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date format, please use &quot;yyyy-mm-dd&quot;&#39;</span><span class="p">)</span>
                                            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

                                        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">T1</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T2</span><span class="p">)]</span>

                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">()</span>
                                        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date formats, please use &quot;yyyy-mm-dd&quot; for start and end dates&#39;</span><span class="p">)</span>
                                        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;showing everything may freeze yyour machine&#39;</span><span class="p">)</span>
                                    <span class="k">try</span><span class="p">:</span>
                                        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">txt1</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">txt2</span><span class="p">)]</span>
                                    <span class="k">except</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Invalid entry/entries, check values correspond to table entries&#39;</span><span class="p">)</span>
                                        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to find working solution&quot;</span><span class="p">)</span>
                                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                    <span class="c1"># ndf=df</span>
                                    <span class="c1">#print(ndf[&#39;FILENAME&#39;])</span>
                                    <span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;plot_tag&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[:</span><span class="mi">18</span><span class="p">])</span>

                                    <span class="n">plots</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ndf</span><span class="p">[</span><span class="s1">&#39;plot_tag&#39;</span><span class="p">])</span>
                                    <span class="c1">#print(ndf[[&#39;plot_tag&#39;,option]])</span>

                                    <span class="c1"># print stats</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Basic stats ---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Min: &quot;</span><span class="p">,</span> <span class="n">ndf</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max: &quot;</span><span class="p">,</span> <span class="n">ndf</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean: &quot;</span><span class="p">,</span> <span class="n">ndf</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Median: &quot;</span><span class="p">,</span> <span class="n">ndf</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                                    <span class="c1"># get plot folder and plot to browser</span>
                                    <span class="n">imgDir</span> <span class="o">=</span> <span class="s2">&quot;plots/&quot;</span>

                                    <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;Plotting folder &quot;</span><span class="o">+</span><span class="n">plotFolderName</span><span class="p">)</span>

                                    <span class="n">ls</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">imgDir</span><span class="p">)</span>

                                    <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">ls</span><span class="p">:</span>
                                        <span class="n">fn</span><span class="o">=</span><span class="n">fn</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                                            
                                        <span class="k">if</span> <span class="s2">&quot;.DS_Store&quot;</span> <span class="ow">in</span> <span class="n">fn</span><span class="p">:</span>
                                            <span class="k">pass</span>
                                        <span class="k">else</span><span class="p">:</span>
                                            <span class="n">f</span><span class="o">=</span><span class="n">fn</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                                                <span class="c1"># f=f.replace(&quot;-&quot;,&quot;_&quot;)</span>
                                                
                                                <span class="c1">#print(fn,type(f),f,folderName,len(fn),len(folderName))</span>
                                
                                            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span> <span class="n">folderName</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">folderName</span><span class="p">)</span>
                                                <span class="n">folderName</span><span class="o">=</span><span class="n">fn</span>
                                                <span class="k">break</span>

                                        <span class="c1"># fld=(folder.replace(&quot;.&quot;,&quot;_&quot;)).lower()</span>
                                        <span class="c1"># if fld==plotFolderName:</span>
                                        <span class="c1">#     plotFolderName=folder</span>
                                            <span class="c1"># print(f&#39;{folder} = {fld} = {plotFolderName}&#39;)</span>

                                    <span class="k">if</span> <span class="s2">&quot;_&quot;</span><span class="o">==</span><span class="n">folderName</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                                            <span class="n">foldName</span><span class="o">=</span><span class="n">folderName</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                                    <span class="k">else</span><span class="p">:</span>
                                            <span class="n">foldName</span><span class="o">=</span><span class="n">folderName</span>

                                    
                                    <span class="n">src</span><span class="o">=</span><span class="p">(</span><span class="n">ndf</span><span class="p">[</span><span class="s2">&quot;OBJECT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                                    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">foldName</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                                    <span class="n">imgPath</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;plots/</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s1">/&#39;</span>
                                    <span class="n">dr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">imgPath</span><span class="p">)</span>
                                    <span class="n">imageNames</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">dr</span><span class="p">)</span>
                                    <span class="n">images</span><span class="o">=</span><span class="p">[]</span>

                                    <span class="k">if</span> <span class="s2">&quot;.DS_Store&quot;</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">:</span>
                                        <span class="n">imageNames</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;.DS_Store&quot;</span><span class="p">)</span>

                                    <span class="nb">print</span><span class="p">(</span><span class="n">imageNames</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                    <span class="c1"># print(plots)</span>
                                    <span class="c1"># sys.exit()</span>

                                    <span class="c1"># # get images for current point</span>
                                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plots</span><span class="p">)):</span>
                                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imageNames</span><span class="p">)):</span>
                                            <span class="k">if</span> <span class="n">plots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span> <span class="c1">#[:18]:</span>
                                                <span class="k">if</span> <span class="s2">&quot;SL&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">and</span> <span class="s2">&quot;HPS_LCP&quot;</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                                                        <span class="c1">#print(imageNames[i],plots[j])</span>
                                                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imgPath</span><span class="o">+</span><span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                                                <span class="k">elif</span> <span class="s2">&quot;SR&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">and</span> <span class="s2">&quot;HPS_RCP&quot;</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                                                        <span class="c1">#print(imageNames[i],plots[j])</span>
                                                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imgPath</span><span class="o">+</span><span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                                                <span class="k">elif</span> <span class="s2">&quot;NL&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">and</span> <span class="s2">&quot;HPN_LCP&quot;</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                                                        <span class="c1">#print(imageNames[i],plots[j])</span>
                                                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imgPath</span><span class="o">+</span><span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                                                <span class="k">elif</span> <span class="s2">&quot;NR&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">and</span> <span class="s2">&quot;HPN_RCP&quot;</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                                                        <span class="c1">#print(imageNames[i],plots[j])</span>
                                                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imgPath</span><span class="o">+</span><span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                                                <span class="k">elif</span>  <span class="s2">&quot;OL&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">and</span> <span class="s2">&quot;ON_LCP&quot;</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                                                        <span class="c1">#print(imageNames[i],plots[j])</span>
                                                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imgPath</span><span class="o">+</span><span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                                                <span class="k">elif</span> <span class="s2">&quot;OR&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">and</span> <span class="s2">&quot;ON_RCP&quot;</span> <span class="ow">in</span> <span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                                                        <span class="c1">#print(imageNames[i],plots[j])</span>
                                                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imgPath</span><span class="o">+</span><span class="n">imageNames</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                                                <span class="k">else</span><span class="p">:</span>
                                                    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imgPath</span><span class="o">+</span><span class="n">imageNames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                            
                                    <span class="c1">#print(images)</span>

                                    <span class="c1"># html link</span>
                                    <span class="n">htmlstart</span> <span class="o">=</span> <span class="s1">&#39;&lt;html&gt; &lt;head&gt;</span><span class="se">\</span>
<span class="s1">                                            &lt;meta charset = &quot;utf-8&quot; &gt;</span><span class="se">\</span>
<span class="s1">                                            &lt;meta name = &quot;viewport&quot; content = &quot;width=device-width, initial-scale=1&quot; &gt; &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; integrity=&quot;sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl&quot; crossorigin=&quot;anonymous&quot;&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js&quot; integrity=&quot;sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt; &lt;style&gt; img {border: 2px solid  # ddd; /* Gray border */border-radius: 4px;  /* Rounded border */padding: 5px; /* Some padding */width: 400px; /* Set a small width */}/* Add a hover effect (blue shadow) */img:hover {box-shadow: 0 0 2px 1px rgba(0, 140, 186, 0.5);}&lt;/style&gt; </span><span class="se">\</span>
<span class="s1">                                            &lt;title&gt;Plots&lt;/title&gt;</span><span class="se">\</span>
<span class="s1">                                            &lt;/head&gt;</span><span class="se">\</span>
<span class="s1">                                            &lt;div class=&quot;container-fluid&quot;&gt; </span><span class="se">\</span>
<span class="s1">                                                &lt;div class=&quot;row&quot;&gt;</span><span class="se">\</span>
<span class="s1">                                                    &lt;hr&gt;</span><span class="se">\</span>
<span class="s1">                                                        &lt;h1&gt; Plotting folder &#39;</span><span class="o">+</span><span class="n">foldName</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>  <span class="o">+</span> <span class="s1">&#39;&lt;/h1&gt; &lt;p&gt;&#39;</span>
                                                
                                    <span class="n">htmlmid</span><span class="o">=</span><span class="s1">&#39;&#39;</span>

                                    <span class="n">imageOptions</span><span class="o">=</span><span class="p">[]</span>
                                        

                                    <span class="k">if</span> <span class="s2">&quot;OL&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="s2">&quot;SL&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="s2">&quot;NL&quot;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                            <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
                                                <span class="k">if</span> <span class="s2">&quot;LCP&quot;</span> <span class="ow">in</span> <span class="n">img</span><span class="p">:</span>
                                                    <span class="n">imageOptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
                                            <span class="n">images</span><span class="o">=</span><span class="n">imageOptions</span>

                                    <span class="k">elif</span> <span class="s2">&quot;OR&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="s2">&quot;SR&quot;</span> <span class="ow">in</span> <span class="n">option</span> <span class="ow">or</span> <span class="s2">&quot;NR&quot;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                            <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
                                                <span class="k">if</span> <span class="s2">&quot;RCP&quot;</span> <span class="ow">in</span> <span class="n">img</span><span class="p">:</span>
                                                    <span class="n">imageOptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
                                            <span class="n">images</span><span class="o">=</span><span class="n">imageOptions</span>

                                    <span class="k">else</span><span class="p">:</span>
                                            <span class="n">images</span><span class="o">=</span><span class="n">images</span>

                                    <span class="c1"># add images to html page</span>
                                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">)):</span>
                                        <span class="c1"># print(images.split(&quot;/&quot;)[1],images.split(&quot;/&quot;)[2])</span>
                                        <span class="c1"># print(images[i])</span>
                                        <span class="n">pathtoimg</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                        <span class="n">img</span> <span class="o">=</span> <span class="s1">&#39;&lt;small class=&quot;card-title&quot;&gt;&#39;</span><span class="o">+</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;&lt;/small&gt;&lt;br/&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;a target=&quot;_blank&quot; href=&quot;&#39;</span><span class="o">+</span><span class="n">pathtoimg</span> <span class="o">+</span> \
                                                <span class="s1">&#39;&quot;&gt;&lt;img src=&quot;&#39;</span><span class="o">+</span><span class="n">pathtoimg</span> <span class="o">+</span> \
                                                <span class="s1">&#39;&quot; class=&quot;card-img-top&quot; alt=&quot;image goes here&quot;&gt;&lt;/a&gt;&#39;</span>
                                        <span class="n">imglink</span> <span class="o">=</span><span class="s1">&#39;&lt;div class = &quot;card&quot; style = &quot;width: 10rem;&quot; &gt;</span><span class="se">\</span>
<span class="s1">                                                    &#39;</span><span class="o">+</span><span class="n">img</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\</span>
<span class="s1">                                                        &lt;/div&gt;&#39;</span>
                                        <span class="n">htmlmid</span><span class="o">=</span><span class="n">htmlmid</span><span class="o">+</span><span class="n">imglink</span>

                                    <span class="n">htmlmid</span><span class="o">=</span><span class="n">htmlmid</span><span class="o">+</span><span class="s1">&#39;&lt;/p&gt;&lt;/div&gt;&#39;</span>
                                    <span class="n">htmlend</span> <span class="o">=</span> <span class="s1">&#39;&lt;/div&gt;&lt;/html&gt;&#39;</span>
                                    <span class="n">html</span> <span class="o">=</span> <span class="n">htmlstart</span><span class="o">+</span><span class="n">htmlmid</span><span class="o">+</span><span class="n">htmlend</span>

                                    <span class="c1"># create the html file</span>
                                    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;temp.html&#39;</span><span class="p">)</span>
                                    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span> <span class="o">+</span> <span class="n">path</span>

                                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
                                    <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
                                
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;html&gt; &lt;head&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;meta charset = &quot;utf-8&quot; &gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;meta name = &quot;viewport&quot; content = &quot;width=device-width, initial-scale=1&quot; &gt; &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; integrity=&quot;sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl&quot; crossorigin=&quot;anonymous&quot;&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js&quot; integrity=&quot;sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt; &lt;style&gt; img {border: 2px solid  # ddd; /* Gray border */border-radius: 4px;  /* Rounded border */padding: 5px; /* Some padding */width: 400px; /* Set a small width */}/* Add a hover effect (blue shadow) */img:hover {box-shadow: 0 0 2px 1px rgba(0, 140, 186, 0.5);}&lt;/style&gt; </span><span class="se">\</span>
<span class="s1">                                                &lt;title&gt;Plots&lt;/title&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;/head&gt;</span><span class="se">\</span>
<span class="s1">                                                &lt;div class=&quot;container-fluid&quot;&gt; </span><span class="se">\</span>
<span class="s1">                                                    &lt;div class=&quot;row&quot;&gt;</span><span class="se">\</span>
<span class="s1">                                                        &lt;hr&gt;</span><span class="se">\</span>
<span class="s1">                                                            &lt;h1&gt; Plotting folder &#39;</span><span class="o">+</span><span class="n">folderName</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&#39;&#39;&lt;/h1&gt; </span>
<span class="s1">                                                            &lt;p&gt; No data to show&lt;/p&gt;</span>
<span class="s1">                                                    &lt;/div&gt;</span>
<span class="s1">                                                &lt;/div&gt;</span>
<span class="s1">                                                &lt;/html&gt;</span>
<span class="s1">                                        &#39;&#39;&#39;</span>
                                        <span class="c1"># create the html file</span>
                                <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;temp.html&#39;</span><span class="p">)</span>
                                <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span> <span class="o">+</span> <span class="n">path</span>

                                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
                                <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
                                        
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data to show&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">folderName</span><span class="si">}</span><span class="s2"> not found in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
 
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Filter by: &quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Key: &#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Min: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxStart</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxEnd</span><span class="o">.</span><span class="n">text</span><span class="p">())</span></div>


<div class="viewcode-block" id="Main.delete_obs">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.delete_obs">[docs]</a>
    <span class="k">def</span> <span class="nf">delete_obs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39; Delete an observation. &#39;&#39;&#39;</span>

        <span class="n">option</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxOptions</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="nb">filter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBoxFilter</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">txt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxFilter</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">option: </span><span class="si">{</span><span class="n">option</span><span class="si">}</span><span class="s1">, filter: </span><span class="si">{</span><span class="nb">filter</span><span class="si">}</span><span class="s1">, text: </span><span class="si">{</span><span class="n">txt</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">txt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># print(&#39;-&#39;* 5, txt)</span>
        
        <span class="k">if</span> <span class="n">txt</span><span class="o">!=</span><span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span><span class="s1">&#39;str&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;in txt&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Choose an option&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">filter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">txt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                        <span class="c1"># check folder name against table name</span>
                        <span class="n">folderName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> 

                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;opt: &#39;</span><span class="p">,</span><span class="n">option</span><span class="p">,</span><span class="s2">&quot;, filt: &quot;</span><span class="p">,</span><span class="nb">filter</span><span class="p">,</span><span class="s1">&#39;, table: &#39;</span><span class="p">,</span><span class="n">folderName</span><span class="p">)</span>

                        <span class="c1"># sys.exit()</span>
                        
                        <span class="n">df</span><span class="p">,</span><span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data_from_db</span><span class="p">(</span><span class="n">folderName</span><span class="p">)</span>
                        <span class="c1"># df = df[(df[&#39;OBSDATE&#39;]&gt;=&quot;2008-01-01&quot;) &amp; (df[&#39;OBSDATE&#39;]&lt;=&quot;2018-12-31&quot;)]</span>

                        <span class="n">txt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>

                                    <span class="c1">#txt=float(txt)</span>
                                    <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">))</span><span class="c1">#,option,txt ,df[option])</span>

                                    <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">))</span>

                                    <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">))</span>

                                    <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">))</span>

                                    <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;=&quot;</span><span class="p">:</span>
                                        <span class="n">ndf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">==</span> <span class="n">txt</span><span class="p">]</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ndf</span><span class="p">))</span>
                            
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">ndf</span><span class="o">=</span><span class="n">df</span>

                        <span class="n">ndf</span><span class="o">=</span><span class="n">ndf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">)</span>
                        <span class="n">cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ndf</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                        <span class="n">files</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ndf</span><span class="o">.</span><span class="n">FILENAME</span><span class="p">)</span>

                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cols: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="si">}</span><span class="s1">, files: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="c1"># print(cols)</span>
                        
                        <span class="c1"># sys.exit()</span>

                        <span class="k">if</span> <span class="s2">&quot;FLUXTOT&quot;</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;UPDATE &#39;</span><span class="si">{</span><span class="n">folderName</span><span class="si">}</span><span class="s2">&#39; SET &quot;</span>

                                <span class="k">if</span> <span class="s2">&quot;OL&quot;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                    <span class="n">ols</span><span class="o">=</span><span class="p">[]</span>
                                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                                        <span class="k">if</span> <span class="s1">&#39;OL&#39;</span> <span class="ow">in</span> <span class="n">i</span> <span class="ow">or</span> <span class="s1">&#39;NL&#39;</span> <span class="ow">in</span> <span class="n">i</span> <span class="ow">or</span> <span class="s1">&#39;SL&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                                            <span class="n">ols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                                            <span class="c1"># print(ols)</span>

                                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ols</span><span class="p">:</span>
                                        <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                                <span class="k">else</span><span class="p">:</span>

                                    <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">option</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                                <span class="nb">print</span><span class="p">()</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot; WHERE FILENAME=&#39;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&#39;; </span><span class="se">\n</span><span class="s2">&quot;</span>

                                <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
                            <span class="c1"># sys.exit()</span>
                        <span class="k">else</span><span class="p">:</span>

                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">processing_file : &#39;</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;UPDATE &#39;</span><span class="si">{</span><span class="n">folderName</span><span class="si">}</span><span class="s2">&#39; SET &quot;</span>

                                <span class="c1"># print(option)</span>
                                <span class="c1"># sys.exit()</span>

                                <span class="c1"># if &quot;DTA&quot; in option:</span>
                                <span class="c1">#     s = option.replace(&quot;D&quot;,&#39;&#39;)</span>
                                <span class="c1">#     print(s,option)</span>
                                <span class="c1">#     sys.exit()</span>
                                
                                <span class="k">if</span> <span class="s2">&quot;OL&quot;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                    <span class="n">ols</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="s1">&#39;OL&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">ols</span><span class="p">)</span>

                                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ols</span><span class="p">:</span>
                                        <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                            <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=200, TSYS1=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                                        <span class="k">else</span><span class="p">:</span>
                                            <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                                <span class="k">elif</span> <span class="s2">&quot;OR&quot;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                    <span class="c1">#if &quot;OL&quot; in option:</span>
                                    <span class="n">ors</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="s1">&#39;OR&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">ors</span><span class="p">)</span>

                                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ors</span><span class="p">:</span>
                                        <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                            <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=200,  TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                                        <span class="k">else</span><span class="p">:</span>
                                            <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                                <span class="k">elif</span> <span class="s1">&#39;NL&#39;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                        <span class="n">nl</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="s1">&#39;NL&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">nl</span><span class="p">)</span>
                                        <span class="c1"># sys.exit()</span>
                                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">nl</span><span class="p">:</span>
                                            <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=200,  TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                                            <span class="k">else</span><span class="p">:</span>
                                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                                <span class="k">elif</span> <span class="s1">&#39;SL&#39;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                        <span class="n">sl</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="s1">&#39;SL&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">sl</span><span class="p">)</span>
                                        <span class="c1"># sys.exit()</span>
                                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sl</span><span class="p">:</span>
                                            <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=200,  TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                                            <span class="k">else</span><span class="p">:</span>
                                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                                <span class="k">elif</span> <span class="s1">&#39;SR&#39;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                        <span class="n">sr</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="s1">&#39;SR&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="p">)</span>
                                        <span class="c1"># sys.exit()</span>
                                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sr</span><span class="p">:</span>
                                            <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=200,  TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                                            <span class="k">else</span><span class="p">:</span>
                                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                                <span class="k">elif</span> <span class="s1">&#39;NR&#39;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                                        <span class="n">nr</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="s1">&#39;NR&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
                                        <span class="c1"># sys.exit()</span>
                                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">nr</span><span class="p">:</span>
                                            <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=200,  TSYS2=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                                            <span class="k">else</span><span class="p">:</span>
                                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot; WHERE FILENAME=&#39;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&#39;; </span><span class="se">\n</span><span class="s2">&quot;</span>

                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;*** </span><span class="si">{</span><span class="n">stmt</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                <span class="c1"># sys.exit()</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                                <span class="n">db</span><span class="o">.</span><span class="n">commit_changes</span><span class="p">()</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
                
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>

        <span class="k">elif</span> <span class="nb">filter</span><span class="o">==</span><span class="s1">&#39;between&#39;</span><span class="p">:</span>

            <span class="n">text1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxStart</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">text2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">txtBoxEnd</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

            <span class="c1"># check folder name against table name</span>
            <span class="n">folderName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ui</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> 

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;opt: &#39;</span><span class="p">,</span><span class="n">option</span><span class="p">,</span><span class="s2">&quot;, filt: &quot;</span><span class="p">,</span><span class="nb">filter</span><span class="p">,</span><span class="s1">&#39;, table: &#39;</span><span class="p">,</span><span class="n">folderName</span><span class="p">)</span>

            <span class="c1"># db = SQLiteDB(databaseName=self.dbFilePath, log=self.log)</span>
            <span class="c1"># db.create_db()</span>
            <span class="n">tableNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbFilePath</span><span class="p">))</span>
            <span class="n">colInd</span><span class="p">,</span> <span class="n">colNames</span><span class="p">,</span> <span class="n">colType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_all_table_coloumns</span><span class="p">(</span><span class="n">folderName</span><span class="p">)</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_rows_of_cols</span><span class="p">(</span><span class="n">folderName</span><span class="p">,</span><span class="n">colNames</span><span class="p">)</span>
                        
            <span class="c1">#print(folderName,colNames)</span>

            <span class="c1"># create dataframe</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">colNames</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OBSDATE&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="s2">&quot;2008-01-01&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;OBSDATE&#39;</span><span class="p">]</span><span class="o">&lt;=</span><span class="s2">&quot;2018-12-31&quot;</span><span class="p">)]</span>

            <span class="k">if</span> <span class="n">folderName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span> 

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">txt1</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">text1</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="c1"># print(&quot;\nOnly integers or floats accepted\n&quot;)</span>
                    <span class="n">txt1</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">txt2</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">text2</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="c1"># print(&quot;\nOnly integers or floats accepted\n&quot;)</span>
                    <span class="n">txt2</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;start: </span><span class="si">{</span><span class="n">txt1</span><span class="si">}</span><span class="s1">, end: </span><span class="si">{</span><span class="n">txt2</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt1</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt2</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>      
                    <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">txt1</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">txt2</span><span class="p">)]</span>
                    <span class="c1"># print(len(df))</span>

                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt1</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt2</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>           
                    <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">txt2</span><span class="p">)]</span>
                    <span class="c1"># print(len(df))</span>

                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt1</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;str&quot;</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt2</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>         
                    <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">txt1</span><span class="p">)]</span>
                    <span class="c1"># print(len(df))</span>

                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt1</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt2</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
                    
                    <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;OBSDATE&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">text1</span><span class="o">==</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">text2</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">T2</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">text2</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date format, please use &quot;yyyy-mm-dd&quot;&#39;</span><span class="p">)</span>
                                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T2</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">text1</span><span class="o">!=</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">text2</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span> 
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">T1</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">text1</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date format, please use &quot;yyyy-mm-dd&quot;&#39;</span><span class="p">)</span>
                                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">T1</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">text1</span><span class="o">!=</span><span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">text2</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">T1</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">text1</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date format, please use &quot;yyyy-mm-dd&quot;&#39;</span><span class="p">)</span>
                                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">T2</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">text2</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date format, please use &quot;yyyy-mm-dd&quot;&#39;</span><span class="p">)</span>
                                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">T1</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">T2</span><span class="p">)]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Invalid date formats, please use &quot;yyyy-mm-dd&quot; for start and end dates&#39;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;showing everything may freeze yyour machine&#39;</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">text1</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">text2</span><span class="p">)]</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Invalid entry/entries, check values correspond to table entries&#39;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to find working solution&quot;</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

                <span class="n">cols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                <span class="n">files</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">FILENAME</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cols: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="si">}</span><span class="s1">, files: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                    <span class="n">stmt</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;UPDATE </span><span class="si">{</span><span class="n">folderName</span><span class="si">}</span><span class="s2"> SET &quot;</span>
                    <span class="k">if</span> <span class="s2">&quot;OL&quot;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                        <span class="n">ols</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="s1">&#39;OL&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">ols</span><span class="p">)</span>

                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ols</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=200, &quot;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>

                    <span class="k">elif</span> <span class="s2">&quot;OR&quot;</span> <span class="ow">in</span> <span class="n">option</span><span class="p">:</span>
                        <span class="c1">#if &quot;OL&quot; in option:</span>
                        <span class="n">ors</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="s1">&#39;OR&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">ors</span><span class="p">)</span>

                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ors</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=200, &quot;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s1">&#39;SL&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;SR&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span>  <span class="s1">&#39;OL&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span>  <span class="s1">&#39;OR&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span>  <span class="s1">&#39;NL&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span>  <span class="s1">&#39;NR&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="p">:</span>
                                <span class="k">if</span> <span class="s2">&quot;FLAG&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
                                    <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">=200, &quot;</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">pass</span>
                                    <span class="c1">#or  &#39;OBSTIME&#39; in col or &#39;MJD&#39; in col or  &#39;OBJECT&#39; in col or  &#39;OBJECTTYPE&#39; in col or  &#39;CENTFREQ&#39; in col or  &#39;LOGFREQ&#39; in col or  &#39;FOCUS&#39; in col or  &#39;TILT&#39; in col or  &#39;HA&#39; in col or  &#39;ZA&#39; in col or  &#39;RADIOMETER&#39; in col or  &#39;BANDWDTH&#39; in col or  &#39;TCAL1&#39; in col or &#39;TCAL2&#39; in col or  &#39;NOMTSYS&#39; in col or &#39;TSYS1&#39;, &#39;TSYSERR1&#39;, &#39;TSYS2&#39;, &#39;TSYSERR2&#39;, &#39;TAMBIENT&#39;, &#39;PRESSURE&#39;, &#39;HUMIDITY&#39;, &#39;WINDSPD&#39;, &#39;HPBW&#39;, &#39;FNBW&#39;, &#39;ELEVATION&#39;, &#39;LONGITUDE&#39;, &#39;LATITUDE&#39;, &#39;SCANTYPE&#39;, &#39;BEAMTYPE&#39;, &#39;OBSERVER&#39;, &#39;OBSLOCAL&#39;, &#39;PROJNAME&#39;, &#39;PROPOSAL&#39;, &#39;TELESCOPE&#39;, &#39;UPGRADE&#39;, &#39;INSTFLAG&#39;, &#39;SCANDIST&#39;, &#39;SCANTIME&#39;, &#39;PWV&#39;, &#39;SVP&#39;, &#39;AVP&#39;, &#39;DPT&#39;, &#39;WVD&#39;, &#39;MEAN_ATMOS_CORRECTION&#39;, &#39;TAU10&#39;, &#39;TAU15&#39;, &#39;TBATMOS10&#39;, &#39;TBATMOS15&#39;, &#39;SLTA&#39;, &#39;SLDTA&#39;, &#39;SLS2N&#39;, &#39;SLTAPEAKLOC&#39;, &#39;SLFLAG&#39;, &#39;SLRMSB&#39;, &#39;SLRMSA&#39;, &#39;SLBSLOPE&#39;, &#39;SLBSRMS&#39;, &#39;NLTA&#39;, &#39;NLDTA&#39;, &#39;NLS2N&#39;, &#39;NLTAPEAKLOC&#39;, &#39;NLFLAG&#39;, &#39;NLRMSB&#39;, &#39;NLRMSA&#39;, &#39;NLBSLOPE&#39;, &#39;NLBSRMS&#39;, &#39;OLTA&#39;, &#39;OLDTA&#39;, &#39;OLPC&#39;, &#39;COLTA&#39;, &#39;COLDTA&#39;, &#39;OLS2N&#39;, &#39;OLTAPEAKLOC&#39;, &#39;OLFLAG&#39;, &#39;OLRMSB&#39;, &#39;OLRMSA&#39;, &#39;OLBSLOPE&#39;, &#39;OLBSRMS&#39;, &#39;SRTA&#39;, &#39;SRDTA&#39;, &#39;SRS2N&#39;, &#39;SRTAPEAKLOC&#39;, &#39;SRFLAG&#39;, &#39;SRRMSB&#39;, &#39;SRRMSA&#39;, &#39;SRBSLOPE&#39;, &#39;SRBSRMS&#39;, &#39;NRTA&#39;, &#39;NRDTA&#39;, &#39;NRS2N&#39;, &#39;NRTAPEAKLOC&#39;, &#39;NRFLAG&#39;, &#39;NRRMSB&#39;, &#39;NRRMSA&#39;, &#39;NRBSLOPE&#39;, &#39;NRBSRMS&#39;, &#39;ORTA&#39;, &#39;ORDTA&#39;, &#39;ORPC&#39;, &#39;CORTA&#39;, &#39;CORDTA&#39;, &#39;ORS2N&#39;, &#39;ORTAPEAKLOC&#39;, &#39;ORFLAG&#39;, &#39;ORRMSB&#39;, &#39;ORRMSA&#39;, &#39;ORBSLOPE&#39;, &#39;ORBSRMS&#39;</span>

                    <span class="n">stmt</span><span class="o">=</span><span class="n">stmt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot; WHERE FILENAME=&#39;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&#39;; </span><span class="se">\n</span><span class="s2">&quot;</span>

                    <span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
                    <span class="c1"># db.c.execute(stmt)</span>
                    <span class="c1"># db.commit_changes()</span>

                    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">folderName</span><span class="si">}</span><span class="s2"> not found in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No valid entries detected for filter&quot;</span><span class="p">)</span></div>

            <span class="c1">#pass</span>

    




    <span class="c1"># checked end ----------</span>
    <span class="c1"># -----------------------------</span>

    <span class="c1"># == Widget connections</span>
<div class="viewcode-block" id="Main.connect_buttons">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.connect_buttons">[docs]</a>
    <span class="k">def</span> <span class="nf">connect_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Connect button key presses to widgets. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;Connecting buttons to main canvas&quot;</span><span class="p">)</span>

        <span class="c1"># Plot parameters buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnFilterData</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnViewFit</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_fit</span><span class="p">)</span>

        <span class="c1"># PSS values buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnCalc</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnCalc</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Calc PSS/Flux&quot;</span><span class="p">)</span>
        <span class="c1"># self.drift_ui.BtnCalc.clicked.connect(self.calc)</span>
        <span class="c1"># self.drift_ui.BtnPopulatePSS.clicked.connect(self.populate_pss_from_file)</span>

        <span class="c1"># beam fitting buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnFitData</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnClearSelection</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_selection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnSave</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_fit</span><span class="p">)</span>

        <span class="c1"># Current plot selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnChoosePlot</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choose_plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnOpenFile</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnResetPlot</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popup_msg_dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnSaveToDb</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_to_DB</span><span class="p">)</span>

        <span class="c1"># Current fit status buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnResetStatus</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">BtnViewStatus</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view_status</span><span class="p">)</span></div>


    
    
    
    


    
    
    

<div class="viewcode-block" id="Main.update_plot">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.update_plot">[docs]</a>
    <span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Update the current figure. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
                    <span class="s2">&quot;Update the current figure.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_figure</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_residual</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label2</span><span class="p">)</span></div>

    
    
    <span class="c1"># === connections for fit_data() ===</span>
<div class="viewcode-block" id="Main.get_fit_type">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.get_fit_type">[docs]</a>
    <span class="k">def</span> <span class="nf">get_fit_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get fit type from combobox.&quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Get fit type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitType</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="Main.get_fit_order">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.get_fit_order">[docs]</a>
    <span class="k">def</span> <span class="nf">get_fit_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get order for fitting polynomial.&quot;&quot;&quot;</span>
        
        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Get polynomial order&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span></div>

    
<div class="viewcode-block" id="Main.get_fit_loc">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.get_fit_loc">[docs]</a>
    <span class="k">def</span> <span class="nf">get_fit_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get fit location from combobox. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Get fit location&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitLoc</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span></div>


<div class="viewcode-block" id="Main.clear_selection">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.clear_selection">[docs]</a>
    <span class="k">def</span> <span class="nf">clear_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Clear selections made for current scan. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Clearing selections for current scan.&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="c1"># Get the plot index</span>
        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>

        <span class="c1"># Set plot title</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="s2">&quot;Cleared selection&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_residual</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_fit_parmeters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="Main.fit_data">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.fit_data">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Fit the drift scan. &quot;&quot;&quot;</span>

        <span class="c1"># Open plot manager</span>
        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>

        <span class="c1"># Get order to fit</span>
        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fit_order</span><span class="p">()</span>
        <span class="n">fit_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fit_type</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">fit_type</span> <span class="o">==</span> <span class="s2">&quot;Polynomial&quot;</span><span class="p">:</span>

            <span class="c1"># Get location we are fitting</span>
            <span class="n">fit_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fit_loc</span><span class="p">()</span>

            <span class="c1"># Check the selected fit type</span>
            <span class="k">if</span> <span class="n">fit_loc</span> <span class="o">==</span> <span class="s2">&quot;Base&quot;</span><span class="p">:</span>

                <span class="c1"># Get base locations</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;No points selected yet&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">clear_selection</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting the baseline&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

                    <span class="c1"># ensure we have a minimum of 4 points for the base fit</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Need a minimum of 4 points or an even set to fit a baseline.</span><span class="se">\n</span><span class="s2">Clicked points reset, pick new points&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">clear_selection</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;selected points: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="k">else</span><span class="p">:</span>

                        <span class="c1"># prep Canvas and perform fit</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_canvas</span><span class="p">()</span>        <span class="c1"># Update figures</span>

                        <span class="c1"># Perform baseline fit</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting &quot;</span><span class="o">+</span><span class="n">fit_loc</span><span class="o">+</span><span class="s2">&quot; with order &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">fit_type</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">reset_peak</span><span class="p">(</span><span class="n">plotIndex</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">fit_base</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_base_fit</span><span class="p">(</span><span class="n">plotIndex</span><span class="p">)</span>    <span class="c1"># Update plot</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">=</span> <span class="mi">0</span>
                        
            <span class="k">elif</span> <span class="n">fit_loc</span> <span class="o">==</span> <span class="s2">&quot;Peak&quot;</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting peak with poly&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

                    <span class="c1"># Get base locations</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;No points selected yet. &quot;</span><span class="p">,</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">clear_selection</span><span class="p">()</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># ensure we have a minimum of 2 points for the peak fit</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Need a minimum of 2 points or an even set to fit a peak.</span><span class="se">\n</span><span class="s2">Clicked points reset, pick new points&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

                            <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">clear_selection</span><span class="p">()</span>

                        <span class="k">else</span><span class="p">:</span>

                            <span class="c1"># Perform peak fit</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting &quot;</span><span class="o">+</span><span class="n">fit_loc</span><span class="o">+</span><span class="s2">&quot; with order &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">fit_type</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">)</span>

                            <span class="c1">#CHECK IF DUAL BEAM</span>
                            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataKeys</span><span class="p">)</span>
                            <span class="c1"># sys.exit()</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;INSTRUME&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Dicke Switched&quot;</span><span class="p">:</span>
                                
                                <span class="c1"># Update figures</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_dual_canvas</span><span class="p">()</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">fit_dual_peak</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">update_dual_peak_fit</span><span class="p">(</span><span class="n">plotIndex</span><span class="p">)</span>  
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1"># Update figures</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_canvas</span><span class="p">()</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">fit_peak</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">update_peak_fit</span><span class="p">(</span><span class="n">plotIndex</span><span class="p">)</span>    <span class="c1"># Update plot</span>
                            
                            <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">=</span> <span class="mi">1</span>
                            <span class="c1">#self.view_fit()</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="c1">#self.clear_selection()</span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;elif fit_type == &quot;Gaussian&quot;:</span>

<span class="sd">            msg_wrapper(&quot;info&quot;, self.log.info,</span>
<span class="sd">                        &quot;Fitting peak with gaussian\n&quot;)</span>

<span class="sd">            # Get base locations</span>
<span class="sd">            if len(self.Canvas.click_index) == 0:</span>
<span class="sd">                msg_wrapper(&quot;info&quot;, self.log.info,</span>
<span class="sd">                            &quot;No points selected yet. &quot;)</span>
<span class="sd">               </span>
<span class="sd">                self.peak_is_fit = 0</span>

<span class="sd">            else:</span>

<span class="sd">                # ensure we have a minimum of 2 points for the peak fit</span>
<span class="sd">                if len(self.Canvas.click_index) &lt; 2 or len(self.Canvas.click_index) % 2 != 0:</span>
<span class="sd">                    msg_wrapper(&quot;info&quot;, self.log.info,</span>
<span class="sd">                    &quot;We need a minimum of 2 points or an even set to fit a baseline&quot;)</span>
<span class="sd">                    msg_wrapper(&quot;info&quot;, self.log.info,</span>
<span class="sd">                                &quot;Clicked points reset, pick new points&quot;)</span>
<span class="sd">               </span>
<span class="sd">                    self.peak_is_fit = 0</span>
<span class="sd">                    self.Canvas.click_index = []</span>

<span class="sd">                else:</span>

<span class="sd">                    # Perform baseline fit</span>
<span class="sd">                    </span>
<span class="sd">                    self.fit_peak(order, plotIndex)</span>

<span class="sd">                    # Update figures</span>
<span class="sd">                    self.Canvas.clear_canvas()</span>
<span class="sd">                    self.update_peak_fit(plotIndex)    # Update plot</span>
<span class="sd">                    self.peak_is_fit = 1</span>
<span class="sd">                    self.view_fit()</span>
<span class="sd">                    self.Canvas.click_index = []</span>
<span class="sd">        &#39;&#39;&#39;</span></div>


<div class="viewcode-block" id="Main.update_dual_peak_fit">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.update_dual_peak_fit">[docs]</a>
    <span class="k">def</span> <span class="nf">update_dual_peak_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates figure on Canvas</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Update peak fit&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="n">plotTitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_dual_residuals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peakResA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakResB</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Peak residual&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xpA</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xpB</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_dual_peaks</span><span class="p">([],</span> <span class="p">[],</span> 
                <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xpB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakModelB</span><span class="p">,</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">peakFitB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">plotTitle</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xpA</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xpB</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_dual_peaks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xpA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakModelA</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">peakFitA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsA</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span>
                                        <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">plotTitle</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xpA</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xpB</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_dual_peaks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xpA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakModelA</span><span class="p">,</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">peakFitA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xpB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakModelB</span><span class="p">,</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">peakFitB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">plotTitle</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.update_peak_fit">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.update_peak_fit">[docs]</a>
    <span class="k">def</span> <span class="nf">update_peak_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates figure on Canvas</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Update peak fit &quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="n">plotTitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_residual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peakRes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Peak residual&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_peak</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakModel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakFit</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">peakRms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>  <span class="n">plotTitle</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.fit_base">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.fit_base">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_base</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Fit the baseline. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting baseline @ &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fit points: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">]))</span>

        <span class="c1"># Create tags for the plot file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_tag</span><span class="p">(</span><span class="n">plotIndex</span><span class="p">)</span>

        <span class="c1"># Get baseline fitting locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yb</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">get_base_pts</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">)</span>

        <span class="c1"># Fit the baseline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataModel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">driftModel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">driftRes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_rms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">driftCoeffs</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">correct_drift</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span><span class="n">order</span><span class="p">)</span>

        <span class="c1"># Set the slope,rms,x and y values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseSlope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driftCoeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s2">&quot;y = </span><span class="si">{:.3f}</span><span class="s2">x + </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSlope</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">driftCoeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataModel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># update fit parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="Main.create_tag">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.create_tag">[docs]</a>
    <span class="k">def</span> <span class="nf">create_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Create a tag for the plots according to the current scan being processed. e.g. ONRCP</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Setting up naming tags&quot;</span><span class="p">)</span>
        <span class="c1">#print(f&#39;index: {ind}&#39;)</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_file_tag_nb</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_file_tag_wb</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">tag</span></div>


    <span class="k">def</span> <span class="nf">_set_file_tag_wb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            A naming tag for wide beam data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Setting tag for wide beam data&quot;</span><span class="p">)</span>

        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>
        <span class="n">tagId</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">plotIndex</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tagId</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Processing: ONLCP</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;ON_LCP&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;rocessing: ONRCP</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;ON_RCP&quot;</span>
        
<div class="viewcode-block" id="Main.update_base_fit">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.update_base_fit">[docs]</a>
    <span class="k">def</span> <span class="nf">update_base_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Updates figure on Canvas &quot;&quot;&quot;</span>

        <span class="c1"># Update plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Figure updated with fit&quot;</span><span class="p">)</span>

        <span class="n">plotTitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_title</span><span class="p">()</span>
        <span class="n">pi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">plotTitle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">driftRes</span><span class="p">,</span>
                         <span class="s2">&quot;Data: baseline corrected&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">pi</span> <span class="o">=</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="Main.fit_peak">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.fit_peak">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Fit peak &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting the Peak&quot;</span><span class="p">,</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>
      
        <span class="bp">self</span><span class="o">.</span><span class="n">xp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yp</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">get_base_pts</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;locs: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span><span class="p">]),</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitType</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Polynomial&quot;</span><span class="p">:</span>

            <span class="c1"># poly fit</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting a polynomial&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

            <span class="n">degree</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>

            <span class="n">peak_res</span><span class="p">,</span> <span class="n">peakRms</span><span class="p">,</span> <span class="n">peakModel</span>  <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">fit_poly_peak</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yp</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">degree</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>  <span class="c1"># Fit the peak</span>

            <span class="n">peakLoc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xp</span><span class="p">[((</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">peakModel</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">peakModel</span><span class="p">))[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">])]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">peakFit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">peakModel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakRms</span> <span class="o">=</span> <span class="n">peakRms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakRes</span> <span class="o">=</span> <span class="n">peak_res</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakModel</span> <span class="o">=</span> <span class="n">peakModel</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">peakLoc</span> <span class="o">=</span> <span class="n">peakLoc</span>

            <span class="c1"># Calculate s2n</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># calculate s2n using drift residual</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">s2n</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">sig_to_noise</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peakFit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">driftRes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># else calculate s2n using peak fit residual</span>
                <span class="c1"># if base is not corrected first</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">s2n</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">sig_to_noise</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peakFit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakRes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;elif self.drift_ui.ComboBoxFitType.currentText() == &quot;Gaussian&quot;:</span>

<span class="sd">            # gauss fit</span>
<span class="sd">            msg_wrapper(&quot;info&quot;, self.log.info,</span>
<span class="sd">                        &quot;Fitting a gaussian&quot;)</span>

<span class="sd">            p0 = [max(self.yp), self.xp[np.argmax(self.yp)],</span>
<span class="sd">                  self.data[&quot;HPBW&quot;]/2]</span>
<span class="sd">            gaus_coeff, var_matrix, gauss_fit, err_gauss_fit, res = fit.fit_gauss(self.xp, self.yp, p0)  # Fit the peak</span>

<span class="sd">            peakLoc = self.x[((np.where(peakModel == max(peakModel))[0])[0])]</span>

<span class="sd">            self.peakFit = max(gauss_fit)</span>
<span class="sd">            self.peakRms = err_gauss_fit</span>
<span class="sd">            self.peakRes = res</span>
<span class="sd">            self.peakModel = gauss_fit</span>
<span class="sd">            self.peakLoc = peakLoc</span>

<span class="sd">            # Calculate s2n</span>
<span class="sd">            try:</span>
<span class="sd">                # calculate s2n using drift residual</span>
<span class="sd">                self.s2n = fit.sig_to_noise(self.peakFit, self.driftRes)</span>
<span class="sd">            except Exception:</span>
<span class="sd">                # else calculate s2n using peak fit residual</span>
<span class="sd">                # if base is not corrected first</span>
<span class="sd">                self.s2n = fit.sig_to_noise(self.peakFit, self.peakRes)</span>

<span class="sd">         &#39;&#39;&#39;</span>

        <span class="c1"># Calculate PSS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Ta = </span><span class="si">{:.3f}</span><span class="s2"> +- </span><span class="si">{:.3f}</span><span class="s2"> [K]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peakFit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakRms</span><span class="p">),</span><span class="s1">&#39;info&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.fit_dual_peak">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.fit_dual_peak">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_dual_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Fit dual peaks. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting the Peaks&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="c1"># get values of both peak click indeces</span>
        <span class="n">p1ClickIndex</span><span class="p">,</span> <span class="n">p2ClickIndex</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">scan_mid</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">[</span><span class="n">p1ClickIndex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="n">scan_mid</span><span class="p">]</span>
        <span class="p">[</span><span class="n">p2ClickIndex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">scan_mid</span><span class="p">]</span>

        <span class="c1"># fit the peaks</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p1ClickIndex</span><span class="p">)</span> <span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">p2ClickIndex</span><span class="p">)</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_p1</span><span class="p">(</span><span class="n">p1ClickIndex</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_p2</span><span class="p">(</span><span class="n">p2ClickIndex</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p1ClickIndex</span><span class="p">)</span> <span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">p2ClickIndex</span><span class="p">)</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_p1</span><span class="p">(</span><span class="n">p1ClickIndex</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_p2</span><span class="p">([])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p1ClickIndex</span><span class="p">)</span> <span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">p2ClickIndex</span><span class="p">)</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_p1</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_p2</span><span class="p">(</span><span class="n">p2ClickIndex</span><span class="p">)</span>


        <span class="c1"># Calculate PSS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span></div>


<div class="viewcode-block" id="Main.fit_p1">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.fit_p1">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_p1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">locs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Fitting peak 1. &quot;&quot;&quot;</span>

        <span class="c1"># Fit peak with selected points</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># no data, skip fit</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Peak 1 not fit&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakFitA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakResA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakModelA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakLocA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s2nA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xpA</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ypA</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Need a minimum of 2 points or an even set on peakA in order to fit the peak.</span><span class="se">\n</span><span class="s2">Clicked points reset, pick new points&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clear_selection</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xpA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ypA</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">get_base_pts</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">locs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;locs: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">locs</span><span class="p">]),</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
        
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitType</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Polynomial&quot;</span><span class="p">:</span>

                    <span class="c1"># poly fit</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting a polynomial&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

                    <span class="n">degree</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>

                    <span class="n">peak_resA</span><span class="p">,</span> <span class="n">peakRmsA</span><span class="p">,</span> <span class="n">peakModelA</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">fit_poly_peak</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">xpA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ypA</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">degree</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>  <span class="c1"># Fit the peak</span>

                    <span class="n">peakLocA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[((</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">peakModelA</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">peakModelA</span><span class="p">))[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">])]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">peakFitA</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">peakModelA</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsA</span> <span class="o">=</span> <span class="n">peakRmsA</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">peakResA</span> <span class="o">=</span> <span class="n">peak_resA</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">peakModelA</span> <span class="o">=</span> <span class="n">peakModelA</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">peakLocA</span> <span class="o">=</span> <span class="n">peakLocA</span>

                    <span class="c1"># Calculate s2n</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># calculate s2n using drift residual</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">s2nA</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">sig_to_noise</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">peakFitA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">driftResA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="c1"># else calculate s2n using peak fit residual</span>
                        <span class="c1"># if base is not corrected first</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">s2nA</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">sig_to_noise</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">peakFitA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakResA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.fit_p2">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.fit_p2">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_p2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Fitting peak 2. &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># no data, skip fit</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Peak 2 not fit&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakFitB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakResB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakModelB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">peakLocB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s2nB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xpB</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ypB</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Fit peak with selected points</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s2">&quot;Need a minimum of 2 points or an even set on peakA in order to fit the peak.</span><span class="se">\n</span><span class="s2">Clicked points reset, pick new points&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">click_index</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clear_selection</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xpB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ypB</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">get_base_pts</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">locs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;locs: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">locs</span><span class="p">]),</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitType</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Polynomial&quot;</span><span class="p">:</span>

                    <span class="c1"># poly fit</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Fitting a polynomial&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

                    <span class="n">degree</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitOrder</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>

                    <span class="n">peak_resB</span><span class="p">,</span> <span class="n">peakRmsB</span><span class="p">,</span> <span class="n">peakModelB</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">fit_poly_peak</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">xpB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ypB</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">degree</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>  <span class="c1"># Fit the peak</span>

                    <span class="n">peakLocB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[(</span>
                        <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">peakModelB</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">peakModelB</span><span class="p">))[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">])]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">peakFitB</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">peakModelB</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsB</span> <span class="o">=</span> <span class="n">peakRmsB</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">peakResB</span> <span class="o">=</span> <span class="n">peak_resB</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">peakModelB</span> <span class="o">=</span> <span class="n">peakModelB</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">peakLocB</span> <span class="o">=</span> <span class="n">peakLocB</span>

                    <span class="c1"># Calculate s2n</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># calculate s2n using drift residual</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">s2nB</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">sig_to_noise</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">peakFitB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">driftResB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="c1"># else calculate s2n using peak fit residual</span>
                        <span class="c1"># if base is not corrected first</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">s2nB</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">sig_to_noise</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">peakFitB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakResB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.update_fit_parmeters">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.update_fit_parmeters">[docs]</a>
    <span class="k">def</span> <span class="nf">update_fit_parmeters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Update fit parameters. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Update fit parameters.&quot;</span><span class="p">)</span>

        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

            <span class="k">if</span> <span class="s2">&quot;13.0S&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONLCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;OLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;OLS2N&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;OLRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;OLRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;OLBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;OLBSRMS&quot;</span><span class="p">,</span> <span class="s2">&quot;OLTAPEAKLOC&quot;</span><span class="p">,</span> <span class="s2">&quot;OLAPPEFF&quot;</span><span class="p">,</span> <span class="s2">&quot;OLPSS&quot;</span><span class="p">,</span> <span class="s2">&quot;OLDPSS&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;ORS2N&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;ORRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;ORRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;ORBSRMS&quot;</span><span class="p">,</span> <span class="s2">&quot;ORTAPEAKLOC&quot;</span><span class="p">,</span> <span class="s2">&quot;ORAPPEFF&quot;</span><span class="p">,</span> <span class="s2">&quot;ORPSS&quot;</span><span class="p">,</span> <span class="s2">&quot;ORDPSS&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>

                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">)</span>
                <span class="c1"># sys.exit()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPSLCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;SLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;SLS2N&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;SLRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;SLRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;SLBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;SLBSRMS&quot;</span><span class="p">,</span> <span class="s2">&quot;SLTAPEAKLOC&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_nb_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPNLCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;NLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;NLS2N&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;NLRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;NLRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;NLBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;NLBSRMS&quot;</span><span class="p">,</span> <span class="s2">&quot;NLTAPEAKLOC&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_nb_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONLCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;OLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;OLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;OLS2N&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;OLRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;OLRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;OLBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;OLBSRMS&quot;</span><span class="p">,</span> <span class="s2">&quot;OLTAPEAKLOC&quot;</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">set_nb_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>
                    <span class="c1"># if self.data[&quot;OBJECTTYPE&quot;] == &quot;CAL&quot;:</span>
                    <span class="c1">#     self.calc_pss_()</span>
                    <span class="c1"># else:</span>
                    <span class="c1">#     pass</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPSRCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;SRTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;SRS2N&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;SRRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;SRRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;SRBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;SRBSRMS&quot;</span><span class="p">,</span> <span class="s2">&quot;SRTAPEAKLOC&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_nb_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPNRCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;NRTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;NRS2N&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;NRRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;NRRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;NRBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;NRBSRMS&quot;</span><span class="p">,</span> <span class="s2">&quot;NRTAPEAKLOC&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_nb_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;ORS2N&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;ORRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;ORRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;ORBSRMS&quot;</span><span class="p">,</span> <span class="s2">&quot;ORTAPEAKLOC&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_nb_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>
                    <span class="c1"># if self.data[&quot;OBJECTTYPE&quot;] == &quot;CAL&quot;:</span>
                    <span class="c1">#     self.calc_pss_()</span>
                    <span class="c1"># else:</span>
                    <span class="c1">#     pass</span>

            <span class="k">if</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FRONTEND&quot;</span><span class="p">]:</span>
                

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPSLCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ASLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ASLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;ASLS2N&quot;</span><span class="p">,</span><span class="s2">&quot;ASLTAPEAKLOC&quot;</span><span class="p">,</span> <span class="s2">&quot;BSLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BSLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;BSLS2N&quot;</span><span class="p">,</span><span class="s2">&quot;BSLTAPEAKLOC&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;SLRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;SLRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;SLBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;SLBSRMS&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_dual_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPNLCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ANLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ANLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;ANLS2N&quot;</span><span class="p">,</span> <span class="s2">&quot;ANLTAPEAKLOC&quot;</span><span class="p">,</span> <span class="s2">&quot;BNLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BNLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;BNLS2N&quot;</span><span class="p">,</span> <span class="s2">&quot;BNLTAPEAKLOC&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;NLRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;NLRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;NLBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;NLBSRMS&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_dual_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ONLCP&quot;</span><span class="p">:</span>

                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AOLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;AOLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;AOLS2N&quot;</span><span class="p">,</span><span class="s2">&quot;AOLTAPEAKLOC&quot;</span><span class="p">,</span> <span class="s2">&quot;BOLTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BOLTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;BOLS2N&quot;</span><span class="p">,</span><span class="s2">&quot;BOLTAPEAKLOC&quot;</span><span class="p">,</span> 
                                   <span class="s2">&quot;OLRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;OLRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;OLBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;OLBSRMS&quot;</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">set_dual_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                    <span class="c1"># if self.data[&quot;OBJECTTYPE&quot;] == &quot;CAL&quot;:</span>
                    <span class="c1">#     self.set_db_pss()</span>
                    <span class="c1"># else:</span>
                    <span class="c1">#     pass </span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPSRCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ASRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ASRTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;ASRS2N&quot;</span><span class="p">,</span> <span class="s2">&quot;ASRTAPEAKLOC&quot;</span><span class="p">,</span> <span class="s2">&quot;BSRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BSRTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;BSRS2N&quot;</span><span class="p">,</span> <span class="s2">&quot;BSRTAPEAKLOC&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;SRRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;SRRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;SRBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;SRBSRMS&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_dual_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HPNRCP&quot;</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ANRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;ANRTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;ANRS2N&quot;</span><span class="p">,</span> <span class="s2">&quot;ANRTAPEAKLOC&quot;</span><span class="p">,</span> <span class="s2">&quot;BNRTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BNRTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;BNRS2N&quot;</span><span class="p">,</span> <span class="s2">&quot;BNRTAPEAKLOC&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;NRRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;NRRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;NRBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;NRBSRMS&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_dual_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data_update</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;AORTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;AORS2N&quot;</span><span class="p">,</span> <span class="s2">&quot;AORTAPEAKLOC&quot;</span><span class="p">,</span> <span class="s2">&quot;BORTA&quot;</span><span class="p">,</span> <span class="s2">&quot;BORTAERR&quot;</span><span class="p">,</span> <span class="s2">&quot;BORS2N&quot;</span><span class="p">,</span> <span class="s2">&quot;BORTAPEAKLOC&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;ORRMSB&quot;</span><span class="p">,</span> <span class="s2">&quot;ORRMSA&quot;</span><span class="p">,</span> <span class="s2">&quot;ORBSLOPE&quot;</span><span class="p">,</span> <span class="s2">&quot;ORBSRMS&quot;</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">set_dual_data</span><span class="p">(</span><span class="n">data_update</span><span class="p">)</span></div>


                    <span class="c1"># if self.data[&quot;OBJECTTYPE&quot;] == &quot;CAL&quot;:</span>
                    <span class="c1">#     self.set_db_pss()</span>
                    <span class="c1"># else:</span>
                    <span class="c1">#     pass </span>

<div class="viewcode-block" id="Main.set_dual_data">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.set_dual_data">[docs]</a>
    <span class="k">def</span> <span class="nf">set_dual_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_update</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the estimated values in the data dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakFitA</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsA</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2nA</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakLocA</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakFitB</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakRmsB</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">6</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2nB</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakLocB</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">8</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">9</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">10</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSlope</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">11</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_rms</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>


<div class="viewcode-block" id="Main.set_nb_data">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.set_nb_data">[docs]</a>
    <span class="k">def</span> <span class="nf">set_nb_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_update</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the estimated values in the data dictionary. &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakFit</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakRms</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2n</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsb</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsa</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSlope</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">6</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_rms</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data_update</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakLoc</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>


<div class="viewcode-block" id="Main.plot_new_fig">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.plot_new_fig">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_new_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a new figure from the recently fit data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;plotting New Fig&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>

        <span class="n">plot_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_tag</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotBeamName</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;plot tag: </span><span class="si">{</span><span class="n">plot_tag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fig_name</span> <span class="o">=</span> <span class="s2">&quot;plots/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SOURCEDIR&quot;</span><span class="p">]</span> <span class="o">+</span> \
            <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">][:</span><span class="mi">18</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">plot_tag</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">create_folder</span><span class="p">(</span><span class="s2">&quot;plots/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SOURCEDIR&quot;</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span></div>


    

<div class="viewcode-block" id="Main.choose_plot">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.choose_plot">[docs]</a>
    <span class="k">def</span> <span class="nf">choose_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Select the plot to work with. &quot;&quot;&quot;</span>

        <span class="n">msg_wrapper</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="s2">&quot;Choose plot&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fit_done</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plot Index: &quot;</span><span class="p">,</span> <span class="n">plotIndex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_previous_fits</span><span class="p">(</span><span class="n">plotIndex</span><span class="p">)</span>

        <span class="c1"># Set default to base fit type</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitLoc</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;Base&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxFitLoc</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

            <span class="c1"># Clear the Canvas</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_canvas</span><span class="p">()</span>

            <span class="c1"># Plot figure</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="s2">&quot;OFFSET&quot;</span><span class="p">]</span>
            <span class="n">scanName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="n">scanName</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_residual</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_fit_parmeters</span><span class="p">()</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>

            <span class="c1"># Clear the Canvas</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">clear_canvas</span><span class="p">()</span>

            <span class="c1"># Plot figure</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Plotting: &quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">drift_ui</span><span class="o">.</span><span class="n">ComboBoxPlotType</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="s2">&quot;OFFSET&quot;</span><span class="p">]</span>
            <span class="n">scanName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanKeys</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">scanName</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">),</span> <span class="n">plotIndex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="n">scanName</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Canvas</span><span class="o">.</span><span class="n">plot_residual</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_fit_parmeters</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># plot 1,2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotOnCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># plot 0,2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotOnCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># plot 0,1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotOnCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="c1"># plot 4,5</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotOnCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="c1"># plot 3,5</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotOnCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">plotIndex</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="c1"># plot 3,4</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotOnCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;There are no scans provided. &quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.popup_msg_dict">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.popup_msg_dict">[docs]</a>
    <span class="k">def</span> <span class="nf">popup_msg_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Message dictionary for popups.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">popup_msg</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;noBase&quot;</span><span class="p">:</span> <span class="s2">&quot;Are you sure you want to save data without fitting the baseline ?&quot;</span><span class="p">,</span>
            <span class="s2">&quot;noPeak&quot;</span><span class="p">:</span> <span class="s2">&quot;Are you sure you want to save data without fitting the peak ?&quot;</span><span class="p">,</span>
            <span class="s2">&quot;noFit&quot;</span><span class="p">:</span> <span class="s2">&quot;Are you sure you want to save data without fitting the plot ?&quot;</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="Main.save_fit">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.save_fit">[docs]</a>
    <span class="k">def</span> <span class="nf">save_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the fit. If the data has been previously saved</span>
<span class="sd">        overwrite the previous fit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Update plot settings</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;OBJECTTYPE&#39;</span><span class="p">]</span>
        <span class="n">beam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FRONTEND&#39;</span><span class="p">]</span>

        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="n">beam</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                
                <span class="c1"># Set flag</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">()</span>

                <span class="c1"># No fit done on figure</span>
                <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popUp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">popup_msg</span><span class="p">[</span><span class="s2">&quot;noFit&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;No fit done&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Saving fit&gt; Fit status: </span><span class="si">%d%d%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_is_smoothed</span><span class="p">),</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

                <span class="c1"># Set flag</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

                <span class="c1"># Only peak fit done on figure</span>
                <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popUp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">popup_msg</span><span class="p">[</span><span class="s2">&quot;noBase&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Saving fit&gt; Fit status: </span><span class="si">%d%d%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_is_smoothed</span><span class="p">),</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Only base fit done on figure</span>
                <span class="c1"># Create a popup window to ask if user if sure about saving this</span>

                <span class="c1"># Set flag</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="mi">110</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;OLFLAG&#39;</span><span class="p">])</span>
                <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popUp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">popup_msg</span><span class="p">[</span><span class="s2">&quot;noPeak&quot;</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">0</span>
                    <span class="c1">#print(self.status, plotIndex)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Saving fit&gt; Fit status: </span><span class="si">%d%d%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_is_smoothed</span><span class="p">),</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Both base and peak were fitted</span>

                <span class="c1"># Set flag</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view_fit</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Saving fit&gt; Fit status: </span><span class="si">%d%d%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_is_smoothed</span><span class="p">),</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="s2">&quot;D&quot;</span> <span class="ow">in</span> <span class="n">beam</span><span class="p">:</span>
            <span class="c1"># Save dual beam fits</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                <span class="c1"># Set flag</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">()</span>

                <span class="c1"># No fit done on figure</span>
                <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popUp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">popup_msg</span><span class="p">[</span><span class="s2">&quot;noFit&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;No fit done&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

                <span class="c1"># Set flag</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>

                <span class="c1"># Only peak fit done on figure</span>
                <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popUp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">popup_msg</span><span class="p">[</span><span class="s2">&quot;noBase&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Only base fit done on figure</span>
                <span class="c1"># Create a popup window to ask if user if sure about saving this</span>

                <span class="c1"># Set flag</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="mi">110</span><span class="p">)</span>
                <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popUp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">popup_msg</span><span class="p">[</span><span class="s2">&quot;noPeak&quot;</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_is_fit</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_is_fit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Both base and peak were fitted</span>

                <span class="c1"># Set flag</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_parmeters</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">view_fit</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">plotIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Cant&#39; save data, basefit not done&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span></div>

        <span class="c1">#sys.exit()</span>

<div class="viewcode-block" id="Main.save_to_DB">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.save_to_DB">[docs]</a>
    <span class="k">def</span> <span class="nf">save_to_DB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Save fit to database. &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Saving data to database.&quot;</span><span class="p">)</span>

        <span class="n">plotIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_index</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;OBJECTTYPE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CAL&#39;</span><span class="p">:</span>

            <span class="c1"># make a copy of the current working db</span>
            <span class="n">analDb</span> <span class="o">=</span> <span class="s2">&quot;CALDB.db&quot;</span>
            
            <span class="c1"># GET TABLE FROM DATABASE</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="n">databaseName</span><span class="o">=</span><span class="n">analDb</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># make a copy of the current working db</span>
            <span class="n">analDb</span> <span class="o">=</span> <span class="s2">&quot;TARDB.db&quot;</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="n">databaseName</span><span class="o">=</span><span class="n">analDb</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">create_db</span><span class="p">()</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SOURCEDIR&#39;</span><span class="p">])</span>
        <span class="n">db</span><span class="o">.</span><span class="n">set_table_name</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Updating table: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table</span><span class="p">),</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="c1"># Check if file has been processed</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read_data_from_database</span><span class="p">(</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">db</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># File in DB</span>
        <span class="c1"># print(&quot;File in db: &quot;, self.data[&#39;FILENAME&#39;] in files, self.data[&#39;FILENAME&#39;])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;already processed: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]),</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

            <span class="n">question</span> <span class="o">=</span> <span class="s2">&quot;Are you sure you want to overwrite the database entry for this source ?&quot;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popUp</span><span class="p">(</span><span class="n">question</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Status: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">),</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="c1">#print(self.beamName)</span>
                <span class="c1">#sys.exit()</span>
                      
                <span class="c1"># Update db entry</span>
                <span class="n">db</span><span class="o">.</span><span class="n">update_row_in_db</span><span class="p">(</span>
                    <span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beamName</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Updated row in table&#39;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

                <span class="c1"># Save the figure</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>

                <span class="k">if</span> <span class="mi">1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="ow">or</span> <span class="mi">2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>

                    <span class="c1"># update corresponding plots</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beamName</span><span class="p">)):</span>
                        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="c1"># Data</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="c1">#scans[i]</span>

                        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span> <span class="p">:</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;raw data&quot;</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
                                <span class="s2">&quot;Plot &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">][:</span><span class="mi">18</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; of &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBJECT&quot;</span><span class="p">])</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">beamName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; scan at &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;CENTFREQ&quot;</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; MHz&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Scandist [deg]&quot;</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Ta [K]&quot;</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                                <span class="s2">&quot;plots/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SOURCEDIR&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">][:</span><span class="mi">18</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">plotBeamName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.png&quot;</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                            
                        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="p">:</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;raw data&quot;</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
                                <span class="s2">&quot;Plot &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">][:</span><span class="mi">18</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; of &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBJECT&quot;</span><span class="p">])</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">beamName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; scan at &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;CENTFREQ&quot;</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; MHz&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Scandist [deg]&quot;</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Ta [K]&quot;</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                                <span class="s2">&quot;plots/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SOURCEDIR&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">][:</span><span class="mi">18</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">plotBeamName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.png&quot;</span><span class="p">)</span>
                            <span class="n">pl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">pass</span>
                    
  

                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># In the case where drift scans were fit but the</span>
                    <span class="c1"># fit for all the scans are unsatisfactory.</span>
                    <span class="c1"># If there is no data to fit and you want to save</span>
                    <span class="c1"># the raw data to the database, plot raw fits for all</span>
                    <span class="c1"># data and save data as nan in the database</span>

                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
                    <span class="c1"># sys.exit()</span>
                    
                    <span class="c1"># update corresponding plots</span>
                    <span class="c1">#print(self.scans)</span>
                    
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beamName</span><span class="p">)):</span>
                        
                        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="c1">#Data</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">beamName</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>

                        <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;raw data&quot;</span><span class="p">)</span>
                        <span class="n">pl</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
                            <span class="s2">&quot;Plot &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">][:</span><span class="mi">18</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; of &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBJECT&quot;</span><span class="p">])</span>
                        <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">beamName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; scan at &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;CENTFREQ&quot;</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; MHz&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
                        <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Scandist [deg]&quot;</span><span class="p">)</span>
                        <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Ta [K]&quot;</span><span class="p">)</span>
                        <span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                        <span class="n">pl</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
                            <span class="s2">&quot;plots/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SOURCEDIR&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">][:</span><span class="mi">18</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">plotBeamName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.png&quot;</span><span class="p">)</span>
                        <span class="n">pl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Entry not updated in database&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;SELECT POINTS TO FIT&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Processing new source: &quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">],</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>

            <span class="n">question</span> <span class="o">=</span> <span class="s2">&quot;Are you sure you want create a new entry for this source in the database ?&quot;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popUp</span><span class="p">(</span><span class="n">question</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s2">&quot;Saving new entry to database&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="c1"># Update db</span>

                <span class="c1"># If source is a calibrator and is 2280-MHz</span>
                <span class="c1"># and int(self.data[&quot;CENTFREQ&quot;]) == 2280:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBJECTTYPE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CAL&quot;</span><span class="p">:</span>

                    <span class="c1"># Save the figure</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>

                    <span class="n">db</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
                    <span class="n">tbname</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">validate_table_name</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">populate_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">tbname</span><span class="p">)</span>

                <span class="c1"># and int(self.data[&quot;CENTFREQ&quot;]) == 2280:</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;OBJECTTYPE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;TAR&quot;</span><span class="p">:</span>

                    <span class="c1"># Save the figure</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot_new_fig</span><span class="p">()</span>
                
                    <span class="n">db</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
                    <span class="n">tbname</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">validate_table_name</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
                    <span class="n">db</span><span class="o">.</span><span class="n">populate_table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">tbname</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s2">&quot;Added new row to table&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s2">&quot;Entry not added to database&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s2">&quot;SELECT POINTS TO FIT&quot;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Main.reset_status">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.reset_status">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>     </div>


<div class="viewcode-block" id="Main.view_status">
<a class="viewcode-back" href="../../../docs/src.gui.html#src.gui.mainGuiLogic.Main.view_status">[docs]</a>
    <span class="k">def</span> <span class="nf">view_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# Status: &quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span></div>
</div>



<span class="c1"># # plottinf funcs</span>
<span class="c1"># def plot_delete_filter(self,key,option,cols):</span>
<span class="c1">#     # e.g(&#39;OL&#39;,option,cols)</span>
<span class="c1">#     if key in option:</span>
<span class="c1">#         ls=[]</span>
<span class="c1">#         for i in cols:</span>
<span class="c1">#             if key</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Pfesesani van Zyl.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>